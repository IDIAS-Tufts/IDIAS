if (self.CavalryLogger) { CavalryLogger.start_js(["Mt6NP"]); }

__d("MComposerStoreToInputMap",[],(function(a,b,c,d,e,f){e.exports={CONFIG:{csid:"csid"},SHARE:{ID:"sid",SHARE_URI:"linkUrl",FEEDBACK_SOURCE:"fs",APP_ID:"appid",INTERNAL_EXTRA:"internal_extra",LINK_NO_CHANGE:"link_no_change"}}}),null);
__d("MCompositionFormatFields",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({FORMAT_ID:"format_id",PREVIOUS_FORMAT_ID:"prev_format_id"})}),null);
__d("MCompositionFormatID",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({PHOTO:"photo",SLIDESHOW:"slideshow"})}),null);
__d("MCompositionFormatStore",["invariant","MCompositionConstants","MCompositionFormatFields","MCompositionFormatID","MCompositionStore","emptyFunction"],(function(a,b,c,d,e,f,g){__p&&__p();c=b("MCompositionConstants").ActionTypes;function a(a){if(a){var c=a.format_id;Object.values(b("MCompositionFormatID")).indexOf(c)!==-1||g(0,183);c=h.get("format_id",null);a.prev_format_id=c}return a}var h=new(b("MCompositionStore"))("FORMAT",b("MCompositionFormatFields")).setRequiredFields("format_id").setHandlerFor(c.COMPOSITION_FINALIZE,b("emptyFunction").thatReturnsNull).setHandlerFor(c.COMPOSITION_INITIALIZE,a).setHandlerFor(c.FORMAT_CHANGE,a).register();e.exports=h}),null);
__d("MCompositionPageRecommendationsFields",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({ENTRY_POINT:"entry_point",PAGE_ID:"page_id",PAGE_NAME:"page_name",RECOMMENDATION_TYPE:"recommendation_type",SURFACE:"surface"})}),null);
__d("MCompositionPageRecommendationsStore",["MCompositionConstants","MCompositionPageRecommendationsFields","MCompositionStore","emptyFunction"],(function(a,b,c,d,e,f){c=b("MCompositionConstants").ActionTypes;function a(a){a=a||{};return a}d=new(b("MCompositionStore"))("PAGE_RECOMMENDATIONS",b("MCompositionPageRecommendationsFields")).setHandlerFor(c.COMPOSITION_FINALIZE,b("emptyFunction").thatReturnsNull).setHandlerFor(c.COMPOSITION_INITIALIZE,a).register();e.exports=d}),null);
__d("MCompositionSlideshowFields",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({IS_VALID:"is_valid"})}),null);
__d("MCompositionSlideshowStore",["MCompositionConstants","MCompositionDispatcher","MCompositionPhotoStore","MCompositionSlideshowFields","MCompositionStore","MMultiPhotoUploaderAttachmentState","SlideshowConstants","emptyFunction"],(function(a,b,c,d,e,f){__p&&__p();c=b("MCompositionConstants").ActionTypes;function a(a){b("MCompositionDispatcher").waitFor([b("MCompositionPhotoStore").toUpdate()]);a=b("MCompositionPhotoStore").get("photo_info_list",null);var c=g.getAll(),d={};d.is_valid=Boolean(a&&a.length>=b("SlideshowConstants").min_photo_num&&a.length<=b("SlideshowConstants").max_photo_num&&a.filter(function(a){return a.state!==b("MMultiPhotoUploaderAttachmentState").UPLOADED}).length===0);return babelHelpers["extends"]({},c,d)}var g=new(b("MCompositionStore"))("SLIDESHOW",b("MCompositionSlideshowFields")).setRequiredFields("is_valid").setHandlerFor(c.COMPOSITION_FINALIZE,b("emptyFunction").thatReturnsNull).setHandlerFor(c.COMPOSITION_INITIALIZE,a).setHandlerFor(c.PHOTO_CHANGE,a).register();e.exports=g}),null);
__d("MTaggableActivityPreviewTemplate",["invariant"],(function(a,b,c,d,e,f,g){__p&&__p();a=function(){"use strict";__p&&__p();function a(a,b){this.$1=a,this.$2=b}var b=a.prototype;b.getTemplateArray=function(){var a=0,b=this.$2.length,c,d=[];for(var e=0;e<=this.$2.length;e++)c=e!==b?this.$2[e].position:this.$1.length,d.push(this.$1.slice(a,c)),a=c;return d};b.getTokens=function(){return this.$2};b.renderArray=function(a){this.$2.length===a.length||g(0,4693,this.$2.length,a.length);var b=this.getTemplateArray().concat();for(var c=a.length;c>0;c--)b.splice(c,0,a[c-1]);return b};return a}();e.exports=a}),null);
__d("XTaggableActivityPreviewTemplateQueryController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/composer/intl/preview_template/",{action_type_id:{type:"Int",required:!0}})}),null);
__d("MTaggableActivityPreviewTemplateQuery",["invariant","Promise","ErrorUtils","MCache","MRequest","MTaggableActivityPreviewTemplate","MTaggableActivityPreviewTemplateConstants","XTaggableActivityPreviewTemplateQueryController"],(function(a,b,c,d,e,f,g){__p&&__p();var h,i=b("MTaggableActivityPreviewTemplateConstants").TOKEN_TYPES,j=12096e5,k="__created_at";function l(a){return(h||(h=b("ErrorUtils"))).applyWithGuard(a,null,null,null,"MTaggableActivityPreviewTemplate")}a=function(){"use strict";__p&&__p();function a(a){this.$1=a,this.$2={has_place_type:"",has_users_type:""}}var c=a.prototype;c.$3=function(a){var c=this;a[k]=Date.now();l(function(){return b("MCache").setItem(c.getCacheKey(),a)});return this.$4(a)};c.$4=function(a){a=a[this.$5()];a||g(0,2619,this.$5());return new(b("MTaggableActivityPreviewTemplate"))(a.string,a.tokens)};c.getCacheKey=function(){var a;return[(a=b("MTaggableActivityPreviewTemplateConstants")).CACHE_PREFIX,a.VERSION,this.$1,a.LOCALE,a.GENDER].join("_")};c.$6=function(){__p&&__p();var a=this.getCacheKey(),c=l(function(){return b("MCache").getItem(a)});if(!c)return null;if(Date.now()-c[k]>j){l(function(){return b("MCache").removeItem(a)});return null}return this.$4(c)};c.$5=function(){var a=this;return b("MTaggableActivityPreviewTemplateConstants").KEY_PREFIX+"_"+Object.keys(this.$2).sort().map(function(b){return a.$2[b]}).join("_")};c.getURI=function(){return b("XTaggableActivityPreviewTemplateQueryController").getURIBuilder().setInt("action_type_id",this.$1).getURI()};c.fetch=function(){var a=this.$6();return a?b("Promise").resolve(a):this.$7()};c.$7=function(){var a=this;return new(b("Promise"))(function(c){var d=new(b("MRequest"))(a.getURI()).setMethod("GET");d.listen("done",function(b){c(a.$3(b.payload.templates))});d.send()})};c.setHasPeople=function(){this.$2.has_users_type=i.PEOPLE.MULTIPLE;return this};c.setHasPerson=function(){this.$2.has_users_type=i.PEOPLE.SINGLE;return this};c.setHasPlace=function(){this.$2.has_place_type=i.PLACE.SPECIFIC;return this};return a}();e.exports=a}),null);
__d("MComposerLoggerPublishingListeners",["MComposerLogger"],(function(a,b,c,d,e,f){a=function(a,c){"use strict";this.error=this.fail=function(){b("MComposerLogger").logWithSessionID("composer_post_failure",a,c)},this.done=function(){b("MComposerLogger").logWithSessionID("composer_post_success",a,c)}};e.exports=a}),null);
__d("SlideshowCreationWaterfallLogger",["MarauderLogger"],(function(a,b,c,d,e,f){a={logEvent:function(c,d,a){d=d||{},b("MarauderLogger").log(c,a,d,void 0,void 0,void 0)}};e.exports=a}),null);
__d("MComposerSlideshowLogger",["MCompositionConfigStore","MCompositionPhotoStore","SlideshowCreationWaterfallLogger"],(function(a,b,c,d,e,f){a={log:function(a){var c=b("MCompositionConfigStore").get("csid",null),d=b("MCompositionPhotoStore").get("photo_info_list",[]).length;b("SlideshowCreationWaterfallLogger").logEvent(a,{photo_count:d,composer_session_id:c},"composer_slideshow")}};e.exports=a}),null);
__d("MComposerNavigationMixin",["invariant","MComposerNavigation"],(function(a,b,c,d,e,f,g){__p&&__p();a={__navigationPolicy:null,currentNavigationPolicy:function(){this.hasNavigationPolicy()||g(0,6080);return this.__navigationPolicy},hasNavigationPolicy:function(){return!!this.__navigationPolicy},newNavigationPolicy:function(){var a=this;this.hasNavigationPolicy()&&g(0,6081);this.__navigationPolicy=b("MComposerNavigation").newPolicy().addOnClose(function(){return a.__navigationPolicy=null});return this.__navigationPolicy},cleanupSoftState:function(){b("MComposerNavigation").cleanupSoftState()}};e.exports=a}),null);
__d("MAlbumPicker",["CSS","DOM","MComposerNavigationMixin","MLegacyDataStore","Stratcom","$","eventsMixinDeprecated","mixin"],(function(a,b,c,d,e,f){__p&&__p();a=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(c){__p&&__p();var d;d=a.call(this)||this;d._root=c;d._albumList=b("DOM").scry(d._root,"div","album-list")[0];d._createAlbumRoot=b("DOM").scry(d._root,"div","create-album")[0];d._albumListInputs=d._getAlbumListInputs();for(var c=0;c<d._albumListInputs.length;c++){var e=d._albumListInputs[c];if(e.checked){e=b("MLegacyDataStore").get(e);d._currentSelectedAlbumID=e.album_id;break}}d._listeners=[b("Stratcom").listen("click","cancel_album_picker",function(){d._navigateAwayAndCancel()}),b("Stratcom").listen("click","album-input",d._onAlbumSelected.bind(babelHelpers.assertThisInitialized(d)))];d._albumList&&d._createAlbumRoot&&(d._listeners.push(b("Stratcom").listen("click","create-album-item",d._openCreateAlbum.bind(babelHelpers.assertThisInitialized(d)))),d._listeners.push(b("Stratcom").listen("click","cancel_create_album",d._cancelCreateAlbum.bind(babelHelpers.assertThisInitialized(d)))),d._listeners.push(b("Stratcom").listen("MPhotosCreateAlbum:created",null,d._onCreateAlbum.bind(babelHelpers.assertThisInitialized(d)))));return d}var d=c.prototype;d._getAlbumListInputs=function(){return b("DOM").scry(this._albumList,"input").filter(function(a){return a.type==="radio"})};d._navigateAway=function(){var a=this;if(!this.hasNavigationPolicy())return;this.currentNavigationPolicy().addOnClose(function(){return b("DOM").hide(a._root)}).close()};d._navigateAwayAndCancel=function(){var a=this;if(!this.hasNavigationPolicy())return;this.currentNavigationPolicy().addOnClose(function(){return a._cancel()}).close()};d.hide=function(){this._navigateAway()};d.show=function(){var a=this;this.newNavigationPolicy().addOnCloseByBrowser(function(){return a._cancel()}).addOnOpen(function(){return b("DOM").show(a._root)}).open();this._albumListInputs.length===0&&(this._albumListInputs=this._getAlbumListInputs())};d.resetAlbumSelection=function(){this._currentSelectedAlbumID=null;for(var a=0;a<this._albumListInputs.length;a++){var c=this._albumListInputs[a],d=b("MLegacyDataStore").get(c);d.is_mobile_uploads_album?(c.checked=!0,this._currentSelectedAlbumID=d.album_id):c.checked=!1}};d._openCreateAlbum=function(a){b("Stratcom").invoke("MAlbumPicker:createalbum:open"),b("DOM").hide(this._albumList),b("DOM").show(this._createAlbumRoot)};d._closeCreateAlbum=function(){b("Stratcom").invoke("MAlbumPicker:createalbum:close"),b("DOM").hide(this._createAlbumRoot),b("DOM").show(this._albumList)};d._cancelCreateAlbum=function(){var a=this;this._albumListInputs.forEach(function(c){var d=b("MLegacyDataStore").get(c);d.album_id===a._currentSelectedAlbumID&&(c.checked=!0)});this._closeCreateAlbum()};d._onCreateAlbum=function(a){a=a.getData();this._closeCreateAlbum();this._chooseAlbum(!1,a.album_id,a.privacy_id)};d._onAlbumSelected=function(a){a=a.getNode("album-input");a=b("MLegacyDataStore").get(a);var c=a.is_mobile_uploads_album,d=a.album_id;a=a.privacy_id;this._currentSelectedAlbumID=d;this._chooseAlbum(c,d,a)};d._chooseAlbum=function(a,c,d){b("CSS").conditionClass(b("$")("album-button"),"active",!a),this._navigateAway(),this.invoke("choose-album",{is_mobile_uploads_album:a,album_id:c,privacy_id:d})};d._cancel=function(){b("DOM").hide(this._root),this.invoke("cancel")};c.fromID=function(a){a=b("$")(a);var d=b("MLegacyDataStore").get(a);d._albumPicker||(d._albumPicker=new c(a));return d._albumPicker};return c}(b("mixin")(b("MComposerNavigationMixin")));b("eventsMixinDeprecated")(a,["cancel","choose-album"]);Object.assign(a.prototype,{_root:null,_listeners:null});e.exports=a}),null);
__d("GroupSellUserActionsTypedLogger",["Banzai","GeneratedLoggerUtils","nullthrows"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(){__p&&__p();function a(){this.$1={}}var c=a.prototype;c.log=function(){b("GeneratedLoggerUtils").log("logger:GroupSellUserActionsLoggerConfig",this.$1,b("Banzai").BASIC)};c.logVital=function(){b("GeneratedLoggerUtils").log("logger:GroupSellUserActionsLoggerConfig",this.$1,b("Banzai").VITAL)};c.logImmediately=function(){b("GeneratedLoggerUtils").log("logger:GroupSellUserActionsLoggerConfig",this.$1,{signal:!0})};c.clear=function(){this.$1={};return this};c.getData=function(){return babelHelpers["extends"]({},this.$1)};c.updateData=function(a){this.$1=babelHelpers["extends"]({},this.$1,a);return this};c.setAccountstatus=function(a){this.$1.accountstatus=a;return this};c.setAppID=function(a){this.$1.appid=a;return this};c.setAppversion=function(a){this.$1.appversion=a;return this};c.setCategoryID=function(a){this.$1.category_id=a;return this};c.setClassifierWords=function(a){this.$1.classifier_words=b("GeneratedLoggerUtils").serializeVector(a);return this};c.setClientCarrier=function(a){this.$1.client_carrier=a;return this};c.setClientUserID=function(a){this.$1.client_userid=a;return this};c.setClienttime=function(a){this.$1.clienttime=a;return this};c.setContainermodule=function(a){this.$1.containermodule=a;return this};c.setCountry=function(a){this.$1.country=a;return this};c.setCrossPostTargets=function(a){this.$1.cross_post_targets=b("GeneratedLoggerUtils").serializeVector(a);return this};c.setDescription=function(a){this.$1.description=a;return this};c.setDeviceid=function(a){this.$1.deviceid=a;return this};c.setDuplicateHash=function(a){this.$1.duplicate_hash=a;return this};c.setEntityID=function(a){this.$1.entity_id=a;return this};c.setEntityType=function(a){this.$1.entity_type=a;return this};c.setEvent=function(a){this.$1.event=a;return this};c.setForSaleItemFbType=function(a){this.$1.for_sale_item_fb_type=a;return this};c.setGroupID=function(a){this.$1.group_id=a;return this};c.setGroupMembersCountBucket=function(a){this.$1.group_members_count_bucket=a;return this};c.setGroupMessageID=function(a){this.$1.group_message_id=a;return this};c.setGroupPostHash=function(a){this.$1.group_post_hash=a;return this};c.setHashid=function(a){this.$1.hashid=a;return this};c.setInterceptWords=function(a){this.$1.intercept_words=a;return this};c.setInterestCommentBucket=function(a){this.$1.interest_comment_bucket=a;return this};c.setInterestLikeBucket=function(a){this.$1.interest_like_bucket=a;return this};c.setInterestMessageBucket=function(a){this.$1.interest_message_bucket=a;return this};c.setIsAdmin=function(a){this.$1.is_admin=a;return this};c.setIsEdit=function(a){this.$1.is_edit=a;return this};c.setIsFsGroup=function(a){this.$1.is_fs_group=a;return this};c.setIsMarketplace=function(a){this.$1.is_marketplace=a;return this};c.setIsemployee=function(a){this.$1.isemployee=a;return this};c.setLatitude=function(a){this.$1.latitude=a;return this};c.setLocationID=function(a){this.$1.location_id=a;return this};c.setLongitude=function(a){this.$1.longitude=a;return this};c.setMarketplaceXpostCheckboxShown=function(a){this.$1.marketplace_xpost_checkbox_shown=a;return this};c.setMarketplaceXpostCheckedOnComposerLoad=function(a){this.$1.marketplace_xpost_checked_on_composer_load=a;return this};c.setMarketplaceXpostCheckedOnPost=function(a){this.$1.marketplace_xpost_checked_on_post=a;return this};c.setMarketplaceXpostExperimentQeMode=function(a){this.$1.marketplace_xpost_experiment_qe_mode=a;return this};c.setMarketplaceXpostFirstTimeCheckboxSeen=function(a){this.$1.marketplace_xpost_first_time_checkbox_seen=a;return this};c.setMarketplaceXpostSplitQeMode=function(a){this.$1.marketplace_xpost_split_qe_mode=a;return this};c.setName=function(a){this.$1.name=a;return this};c.setNumPhotos=function(a){this.$1.num_photos=a;return this};c.setOriginatedGroupID=function(a){this.$1.originated_group_id=a;return this};c.setPickupNote=function(a){this.$1.pickup_note=a;return this};c.setPriceAmount=function(a){this.$1.price_amount=a;return this};c.setPriceCurrency=function(a){this.$1.price_currency=a;return this};c.setPriceType=function(a){this.$1.price_type=a;return this};c.setProductAvailability=function(a){this.$1.product_availability=a;return this};c.setProductItemID=function(a){this.$1.product_item_id=a;return this};c.setReferralSurface=function(a){this.$1.referral_surface=a;return this};c.setSavedSearchID=function(a){this.$1.saved_search_id=a;return this};c.setSavedSearchResultCount=function(a){this.$1.saved_search_result_count=a;return this};c.setSavedSearchText=function(a){this.$1.saved_search_text=a;return this};c.setSellOptionsID=function(a){this.$1.sell_options_id=a;return this};c.setSeq=function(a){this.$1.seq=a;return this};c.setSessionid=function(a){this.$1.sessionid=a;return this};c.setSurface=function(a){this.$1.surface=a;return this};c.setSyncMetadataID=function(a){this.$1.sync_metadata_id=a;return this};c.setTaxonCategoryPath=function(a){this.$1.taxon_category_path=a;return this};c.setTime=function(a){this.$1.time=a;return this};c.setTitle=function(a){this.$1.title=a;return this};c.setUuid=function(a){this.$1.uuid=a;return this};c.setVC=function(a){this.$1.vc=a;return this};c.setWeight=function(a){this.$1.weight=a;return this};c.updateExtraData=function(a){a=b("nullthrows")(b("GeneratedLoggerUtils").serializeMap(a));b("GeneratedLoggerUtils").checkExtraDataFieldNames(a,g);this.$1=babelHelpers["extends"]({},this.$1,a);return this};c.addToExtraData=function(a,b){var c={};c[a]=b;return this.updateExtraData(c)};return a}();var g={accountstatus:!0,appid:!0,appversion:!0,category_id:!0,classifier_words:!0,client_carrier:!0,client_userid:!0,clienttime:!0,containermodule:!0,country:!0,cross_post_targets:!0,description:!0,deviceid:!0,duplicate_hash:!0,entity_id:!0,entity_type:!0,event:!0,for_sale_item_fb_type:!0,group_id:!0,group_members_count_bucket:!0,group_message_id:!0,group_post_hash:!0,hashid:!0,intercept_words:!0,interest_comment_bucket:!0,interest_like_bucket:!0,interest_message_bucket:!0,is_admin:!0,is_edit:!0,is_fs_group:!0,is_marketplace:!0,isemployee:!0,latitude:!0,location_id:!0,longitude:!0,marketplace_xpost_checkbox_shown:!0,marketplace_xpost_checked_on_composer_load:!0,marketplace_xpost_checked_on_post:!0,marketplace_xpost_experiment_qe_mode:!0,marketplace_xpost_first_time_checkbox_seen:!0,marketplace_xpost_split_qe_mode:!0,name:!0,num_photos:!0,originated_group_id:!0,pickup_note:!0,price_amount:!0,price_currency:!0,price_type:!0,product_availability:!0,product_item_id:!0,referral_surface:!0,saved_search_id:!0,saved_search_result_count:!0,saved_search_text:!0,sell_options_id:!0,seq:!0,sessionid:!0,surface:!0,sync_metadata_id:!0,taxon_category_path:!0,time:!0,title:!0,uuid:!0,vc:!0,weight:!0};e.exports=a}),null);
__d("GroupSellLogger",["GroupSellUserActionsTypedLogger"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g={logComposerTooltipNUXSeen:function(a){new(b("GroupSellUserActionsTypedLogger"))().setEvent("composer_tooltip_nux_seen").setGroupID(a).log()},_formatComposerInterceptWords:function(a,b){var c=[];b&&(c=b.slice());a&&a>0&&c.push(a.toString()+" prices count");return c.join(",")},logComposerInterceptAttempted:function(a){new(b("GroupSellUserActionsTypedLogger"))().setEvent("group_non_for_sale_post_intercept_attempted").setGroupID(a).log()},logComposerInterceptDetected:function(a,c,d){new(b("GroupSellUserActionsTypedLogger"))().setEvent("group_non_for_sale_post_intercept_detected").setGroupID(a).setInterceptWords(g._formatComposerInterceptWords(c,d)).log()},logComposerInterceptCreated:function(a,c,d){new(b("GroupSellUserActionsTypedLogger"))().setEvent("group_non_for_sale_post_intercept_created").setGroupID(a).setInterceptWords(g._formatComposerInterceptWords(c,d)).log()},logComposerInterceptAccepted:function(a,c,d){new(b("GroupSellUserActionsTypedLogger"))().setEvent("group_non_for_sale_post_intercept_accepted").setGroupID(a).setInterceptWords(g._formatComposerInterceptWords(c,d)).log()},logComposerInterceptDeclined:function(a,c,d){new(b("GroupSellUserActionsTypedLogger"))().setEvent("group_non_for_sale_post_intercept_declined").setGroupID(a).setInterceptWords(g._formatComposerInterceptWords(c,d)).log()},logHScrollViewPermalink:function(a,c){new(b("GroupSellUserActionsTypedLogger"))().setEvent("h_scroll_story_clicked").setGroupID(a).setGroupMessageID(c).log()},logNLUTimeout:function(a){new(b("GroupSellUserActionsTypedLogger"))().setEvent("group_non_for_sale_post_nlu_timeout").setGroupID(a).log()},logNLUError:function(a){new(b("GroupSellUserActionsTypedLogger"))().setEvent("group_non_for_sale_post_nlu_error").setGroupID(a).log()},logNonForSaleMarkAsSold:function(a,c,d){new(b("GroupSellUserActionsTypedLogger"))().setEvent("non_for_sale_mark_as_sold").setGroupID(a).setGroupMessageID(c).setDescription(d).setSurface("delete_intercept").log()},logClearCrossPostMenu:function(a){new(b("GroupSellUserActionsTypedLogger"))().setEvent("composer_clear_cross_post_menu").setGroupID(a).log()},logOpenCrossPostMenu:function(a,c){new(b("GroupSellUserActionsTypedLogger"))().setEvent("composer_open_cross_post_menu").setGroupID(a).addToExtraData("has_recent_places",c.toString()).log()},logSelectRecentPlaces:function(a){new(b("GroupSellUserActionsTypedLogger"))().setEvent("composer_select_recent_cross_post_places").setGroupID(a).log()}};e.exports=g}),null);
__d("MGroupSellInterceptUtil",["escapeRegex"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a={parseInterceptedPrices:function(a,c){__p&&__p();var d=[];if(!c)return d;var e=new RegExp("\\d+","ig"),f=new RegExp(b("escapeRegex")(c)+"\\s*\\d+","ig");c=new RegExp("\\d+(?=\\s*"+b("escapeRegex")(c)+")","ig");f=a.match(f);f&&f.forEach(function(a){return d=d.concat(a.match(e))});f=a.match(c);f&&(d=d.concat(f));return d}};e.exports=a}),null);
__d("MStructuredComposerOGInput",["cx","CSS","DOM","MAjaxify","MarauderLogger","MComposerLogger","MComposerNavigationMixin","MComposerOGStrings","MCompositionMinutiaeFields","MCompositionMinutiaeStore","MCompositionUserActions","MRequest","MSubscriptionsHandlerMixin","MUnifiedTaggerConstants","MViewport","Stratcom","mixin","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f,g){__p&&__p();var h=b("MUnifiedTaggerConstants").SHOW_UNIFIED_TAGGER,i=55;a=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(c,d,e,f,g){__p&&__p();var i;i=a.call(this)||this;i.$MStructuredComposerOGInput1=c;i.$MStructuredComposerOGInput2=!0;i.$MStructuredComposerOGInput3=!0;i.$MStructuredComposerOGInput4=null;i.$MStructuredComposerOGInput5=d;i.$MStructuredComposerOGInput6=e;i.$MStructuredComposerOGInput7=e.parentNode;i.$MStructuredComposerOGInput8=g;i.$MStructuredComposerOGInput9=b("DOM").find(i.$MStructuredComposerOGInput1,"input","og-action-input");i.$MStructuredComposerOGInput10=b("DOM").find(i.$MStructuredComposerOGInput1,"input","og-object-input");i.$MStructuredComposerOGInput11=b("DOM").find(i.$MStructuredComposerOGInput1,"input","og-phrase-input");i.$MStructuredComposerOGInput12=b("DOM").find(i.$MStructuredComposerOGInput1,"input","og-icon-input");i.$MStructuredComposerOGInput13=b("DOM").find(i.$MStructuredComposerOGInput1,"input","og-suggestion-mechanism");i.$MStructuredComposerOGInput14=b("DOM").find(i.$MStructuredComposerOGInput1,"input","og-hide-attachment");i.$MStructuredComposerOGInput15=!1;i.$MStructuredComposerOGInput16=null;i.$MStructuredComposerOGInput17=b("DOM").find(i.$MStructuredComposerOGInput1,"ul","og-tag");i.$MStructuredComposerOGInput18=f;i.$MStructuredComposerOGInput8&&i.addSubscriptions(i.$MStructuredComposerOGInput18.listen("clear",function(){i.$MStructuredComposerOGInput8.clear(),i.$MStructuredComposerOGInput19()}),i.$MStructuredComposerOGInput8.addListener("clear",function(){return i.$MStructuredComposerOGInput19()}));i.addSubscriptions(i.$MStructuredComposerOGInput18.listen("submit",i.$MStructuredComposerOGInput20.bind(babelHelpers.assertThisInitialized(i))),b("MCompositionMinutiaeStore").addChangeListener(function(){return i.$MStructuredComposerOGInput21()}),i.$MStructuredComposerOGInput18.listen("iconChanged",function(a){__p&&__p();if(h)b("Stratcom").invoke("MComposer:tagger:update:og-icon",null,{icon:a.icon_src});else{var c=b("DOM").find(i.$MStructuredComposerOGInput17,"li","token");c=b("DOM").find(c,"i");b("DOM").replace(c,a.icon)}i.$MStructuredComposerOGInput12.value=a.custom_icon_id;i.$MStructuredComposerOGInput22();i.$MStructuredComposerOGInput8&&(i.$MStructuredComposerOGInput4["{icon}"]=b("DOM").create("i",{className:a.icon.className,style:a.icon.style}),i.$MStructuredComposerOGInput8.setValue(i.$MStructuredComposerOGInput4));b("Stratcom").invoke("MStructuredComposerOGInput-done",null,{icon_changed:!0});b("MComposerLogger").log("change_icon_minutiae",{action_type_id:a.action_type_id,query:a.query})}),i.$MStructuredComposerOGInput18.listen("cancel",function(){b("Stratcom").invoke("MStructuredComposerOGInput-done",null,{cancel:!0}),b("MComposerLogger").log("cancel_minutiae"),i.$MStructuredComposerOGInput22()}),i.$MStructuredComposerOGInput18.listen("cancelIconSelection",function(a){b("MComposerLogger").log("change_icon_cancel_minutiae",{action_type_id:a.action_type_id,query:a.query})}));i.addSubscriptions(b("Stratcom").listen("click","inline-og-button",function(){b("setTimeoutAcrossTransitions")(function(){i.$MStructuredComposerOGInput23()},10)}));h?i.addSubscriptions(b("Stratcom").listen("MComposer:tagger:click",b("MUnifiedTaggerConstants").TOKEN_TYPES.OBJECT,i.$MStructuredComposerOGInput24.bind(babelHelpers.assertThisInitialized(i))),b("Stratcom").listen("MComposer:tagger:click",b("MUnifiedTaggerConstants").TOKEN_TYPES.ICON,function(){return i.$MStructuredComposerOGInput25()})):i.addSubscriptions(b("DOM").listen(i.$MStructuredComposerOGInput1,"click","og-tags",i.$MStructuredComposerOGInput26.bind(babelHelpers.assertThisInitialized(i))),b("DOM").listen(i.$MStructuredComposerOGInput1,"click","remove-token",i.$MStructuredComposerOGInput27.bind(babelHelpers.assertThisInitialized(i))));i.addSubscriptions(b("Stratcom").listen("MComposer:open:activity",null,function(){i.$MStructuredComposerOGInput3=!1,i.$MStructuredComposerOGInput28()}),b("Stratcom").listen("click","og_included_place_checkin",i.$MStructuredComposerOGInput29.bind(babelHelpers.assertThisInitialized(i))),b("DOM").listen(i.$MStructuredComposerOGInput5,"click",null,i.$MStructuredComposerOGInput24.bind(babelHelpers.assertThisInitialized(i))),b("DOM").listen(i.$MStructuredComposerOGInput7,"click","close-composer-attachment",i.$MStructuredComposerOGInput30.bind(babelHelpers.assertThisInitialized(i))));return i}var d=c.prototype;d.$MStructuredComposerOGInput19=function(){this.reset(),this.$MStructuredComposerOGInput31(),b("Stratcom").invoke("MStructuredComposerOGInput-done",null,{remove:!0}),b("MComposerLogger").log("remove_minutiae")};d.$MStructuredComposerOGInput30=function(){var a={};a.show_attachment=!1;b("MCompositionUserActions").minutiaeSet(babelHelpers["extends"]({},b("MCompositionMinutiaeStore").getAll(),a))};d.$MStructuredComposerOGInput20=function(a){var c={};for(var d in b("MCompositionMinutiaeFields")){var e=b("MCompositionMinutiaeFields")[d];c[e]=a[e]}b("MCompositionUserActions").minutiaeSet(c)};d.$MStructuredComposerOGInput21=function(){__p&&__p();var a=b("DOM").find(this.$MStructuredComposerOGInput17,"li","token");this.$MStructuredComposerOGInput32();var c=b("MCompositionMinutiaeStore").get("action_type");if(!c)return;var d=b("MCompositionMinutiaeStore").get("custom_icon"),e=b("MCompositionMinutiaeStore").get("icon"),f=b("MCompositionMinutiaeStore").get("icon_src"),g=b("MCompositionMinutiaeStore").get("object_str"),j=b("MCompositionMinutiaeStore").get("object"),k=!this.$MStructuredComposerOGInput15&&b("MCompositionMinutiaeStore").get("show_attachment"),l=b("MCompositionMinutiaeStore").get("suggestion_mechanism"),m=b("MCompositionMinutiaeStore").get("use_default_icon",!1),n=b("MCompositionMinutiaeStore").get("fbt_phrase");this.$MStructuredComposerOGInput16=b("MCompositionMinutiaeStore").get("triggers_event_tag_expansion")?String(j):null;n||(n=b("MComposerOGStrings").getFBTPhrase(c,e,g,j));g&&!j?this.$MStructuredComposerOGInput11.value=g:(this.$MStructuredComposerOGInput11.value="",k?(this.$MStructuredComposerOGInput33(j,g),this.$MStructuredComposerOGInput14.value=!1):(this.$MStructuredComposerOGInput32(),this.$MStructuredComposerOGInput14.value=!0));if(h)b("Stratcom").invoke("MComposer:tagger:update",null,{ogActivity:{id:c,icon:f,object:g}});else{b("DOM").remove(a.firstChild);k={"max-width":b("MViewport").getUseableWidth()-i+"px"};f=b("DOM").create("span",{className:"_52x0",style:k},n);b("DOM").prependContent(a,f)}this.$MStructuredComposerOGInput8&&(this.$MStructuredComposerOGInput4=n,this.$MStructuredComposerOGInput8.setValue(this.$MStructuredComposerOGInput4));this.$MStructuredComposerOGInput10.value=j;this.$MStructuredComposerOGInput9.value=c;this.$MStructuredComposerOGInput12.value=d;this.$MStructuredComposerOGInput18.hide();this.$MStructuredComposerOGInput34();this.$MStructuredComposerOGInput13.value=l;!j&&!m?(this.$MStructuredComposerOGInput8&&this.$MStructuredComposerOGInput8.hide(),this.$MStructuredComposerOGInput18.showIconSelector(c,j,g,e)):(this.$MStructuredComposerOGInput22(),b("Stratcom").invoke("MStructuredComposerOGInput-done",null,{add:!0}),b("MComposerLogger").log("add_minutiae"));b("Stratcom").invoke("MStructuredComposerOGInput:update")};d.$MStructuredComposerOGInput22=function(){this.$MStructuredComposerOGInput3&&this.hasNavigationPolicy()?this.$MStructuredComposerOGInput31():(this.$MStructuredComposerOGInput29(),b("Stratcom").invoke("MComposer:close:activity","og-tagger"))};d.reset=function(){this.$MStructuredComposerOGInput4=null,this.$MStructuredComposerOGInput9.value="",this.$MStructuredComposerOGInput10.value="",this.$MStructuredComposerOGInput11.value="",this.$MStructuredComposerOGInput12.value="",this.$MStructuredComposerOGInput14.value=!1,this.$MStructuredComposerOGInput15=!1,this.$MStructuredComposerOGInput16=null,h&&b("Stratcom").invoke("MComposer:tagger:update",null,{ogActivity:null}),this.$MStructuredComposerOGInput32(),this.$MStructuredComposerOGInput8&&this.$MStructuredComposerOGInput8.clear(),this.$MStructuredComposerOGInput34(),b("Stratcom").invoke("MStructuredComposerOGInput:update")};d.getEventIDForExpansion=function(){return this.$MStructuredComposerOGInput16};d.setVisible=function(a){this.$MStructuredComposerOGInput2=a,this.$MStructuredComposerOGInput34()};d.setDisableOgTagPreview=function(a){this.$MStructuredComposerOGInput15=a};d.hasValue=function(){return!!this.$MStructuredComposerOGInput9.value};d.getLoggingData=function(){return this.$MStructuredComposerOGInput9.value?{action_type:this.$MStructuredComposerOGInput9.value,object:this.$MStructuredComposerOGInput10.value,object_str:this.$MStructuredComposerOGInput11.value}:null};d.$MStructuredComposerOGInput34=function(){var a=!!this.$MStructuredComposerOGInput9.value;h||(a&&this.$MStructuredComposerOGInput2?b("DOM").show:b("DOM").hide)(this.$MStructuredComposerOGInput1);(this.$MStructuredComposerOGInput2?b("DOM").show:b("DOM").hide)(this.$MStructuredComposerOGInput5);b("CSS").conditionClass(this.$MStructuredComposerOGInput5,"active",a)};d.$MStructuredComposerOGInput33=function(a,c){this.$MStructuredComposerOGInput32();b("DOM").show(this.$MStructuredComposerOGInput6);c="/platform/og/composer/attachment";c=new(b("MRequest"))(c).setData({object_id:a});b("MAjaxify").ajaxify(null,null,c,null)};d.$MStructuredComposerOGInput32=function(){b("DOM").replace(b("DOM").find(this.$MStructuredComposerOGInput7,"div","og-object-attachment"),this.$MStructuredComposerOGInput6),b("DOM").hide(this.$MStructuredComposerOGInput6)};d.$MStructuredComposerOGInput26=function(){b("MComposerLogger").log("change_icon_intent_minutiae"),this.$MStructuredComposerOGInput8&&this.$MStructuredComposerOGInput8.hide(),this.$MStructuredComposerOGInput25()};d.$MStructuredComposerOGInput24=function(){b("MComposerLogger").log("intent_minutiae"),b("MarauderLogger").log("og_composer_icon_clicked"),this.$MStructuredComposerOGInput23()};d.$MStructuredComposerOGInput27=function(a){a.kill(),this.reset(),b("MCompositionUserActions").minutiaeRemove(),b("Stratcom").invoke("MStructuredComposerOGInput-done",null,{remove:!0}),b("MComposerLogger").log("remove_minutiae")};d.$MStructuredComposerOGInput35=function(){this.$MStructuredComposerOGInput3=!1,this.$MStructuredComposerOGInput18.cancel()};d.$MStructuredComposerOGInput29=function(){this.$MStructuredComposerOGInput3||(this.$MStructuredComposerOGInput3=!0),this.$MStructuredComposerOGInput18.hide()};d.$MStructuredComposerOGInput28=function(){this.$MStructuredComposerOGInput8&&this.$MStructuredComposerOGInput8.showIfHasValue(),this.$MStructuredComposerOGInput18.show()};d.$MStructuredComposerOGInput36=function(){this.$MStructuredComposerOGInput8&&this.$MStructuredComposerOGInput8.hide(),b("MComposerLogger").log("change_icon_intent_minutiae"),this.$MStructuredComposerOGInput18.showIconSelector(this.$MStructuredComposerOGInput9.value,this.$MStructuredComposerOGInput10.value,this.$MStructuredComposerOGInput11.value,this.$MStructuredComposerOGInput12.value)};d.$MStructuredComposerOGInput31=function(){var a=this;this.currentNavigationPolicy().addOnClose(function(){return a.$MStructuredComposerOGInput18.hide()}).close()};d.$MStructuredComposerOGInput37=function(){var a=this;this.currentNavigationPolicy().addOnClose(function(){return a.$MStructuredComposerOGInput35()}).close()};d.$MStructuredComposerOGInput23=function(){var a=this;this.newNavigationPolicy().addOnCloseByBrowser(function(){return a.$MStructuredComposerOGInput35()}).addOnOpen(function(){return a.$MStructuredComposerOGInput28()}).open()};d.$MStructuredComposerOGInput25=function(){var a=this;this.newNavigationPolicy().addOnCloseByBrowser(function(){return a.$MStructuredComposerOGInput35()}).addOnOpen(function(){return a.$MStructuredComposerOGInput36()}).open()};return c}(b("mixin")(b("MComposerNavigationMixin"),b("MSubscriptionsHandlerMixin")));e.exports=a}),null);
__d("MStructuredComposerPhotoPreviewBootloader",["cx","fbt","BootloadedComponent.react","DOM","JSResource","MComposerNavigationMixin","MLoadingSpinner.react","PhotosUploadWaterfallXMixin","React","ReactDOM","mixin","performanceNow"],(function(a,b,c,d,e,f,g,h){__p&&__p();var i;a=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(c){var d;d=a.call(this)||this;d.$MStructuredComposerPhotoPreviewBootloader1=c.root;d.$MStructuredComposerPhotoPreviewBootloader2=c.typeaheadConfig;d.$MStructuredComposerPhotoPreviewBootloader3=c.suggestions;d.$MStructuredComposerPhotoPreviewBootloader4=null;d.$MStructuredComposerPhotoPreviewBootloader5=null;d.$MStructuredComposerPhotoPreviewBootloader6=b("DOM").find(d.$MStructuredComposerPhotoPreviewBootloader1,"div","structured-composer-photo-preview-card");return d}var d=c.prototype;d.$MStructuredComposerPhotoPreviewBootloader7=function(a,c){var d=b("DOM").find(this.$MStructuredComposerPhotoPreviewBootloader1,"div","photo-preview-title");c&&Object.keys(c).length>0&&d?b("DOM").setContent(d,h._("Tag photo")):d&&b("DOM").setContent(d,h._("Photo preview"));b("ReactDOM").render(b("React").createElement(b("BootloadedComponent.react"),babelHelpers["extends"]({},this.props,{bootloadLoader:b("JSResource")("MStructuredComposerPhotoPreviewBootloadable.react").__setRef("MStructuredComposerPhotoPreviewBootloader"),bootloadPlaceholder:b("React").createElement("div",{className:"_4ldw"},b("React").createElement(b("MLoadingSpinner.react"),null),h._("Loading...")),imageSrc:a,initialFaceboxes:c,onTagAdd:this.$MStructuredComposerPhotoPreviewBootloader4,onTagDelete:this.$MStructuredComposerPhotoPreviewBootloader5,typeaheadConfig:this.$MStructuredComposerPhotoPreviewBootloader2,typeaheadSuggestions:this.$MStructuredComposerPhotoPreviewBootloader3})),this.$MStructuredComposerPhotoPreviewBootloader6);b("DOM").show(this.$MStructuredComposerPhotoPreviewBootloader1)};d.$MStructuredComposerPhotoPreviewBootloader8=function(){b("DOM").hide(this.$MStructuredComposerPhotoPreviewBootloader1),b("ReactDOM").unmountComponentAtNode(this.$MStructuredComposerPhotoPreviewBootloader6)};d.show=function(a,c){var d=this;if(this.hasNavigationPolicy())return;this.newNavigationPolicy().addOnOpen(function(){d.$MStructuredComposerPhotoPreviewBootloader7(a,c),d.$MStructuredComposerPhotoPreviewBootloader9=(i||(i=b("performanceNow")))(),d.logStep("client_photo_preview_open",{})}).addOnClose(function(){b("DOM").hide(d.$MStructuredComposerPhotoPreviewBootloader1),d.logStep("client_photo_preview_close",{elapsed_time:(i||(i=b("performanceNow")))()-d.$MStructuredComposerPhotoPreviewBootloader9})}).open()};d.setOnDeleteXYTag=function(a){this.$MStructuredComposerPhotoPreviewBootloader5=a};d.setOnAddXYTag=function(a){this.$MStructuredComposerPhotoPreviewBootloader4=a};d.hide=function(){if(!this.hasNavigationPolicy())return;this.currentNavigationPolicy().close()};d.setWaterfall=function(a,b,c){this.$MStructuredComposerPhotoPreviewBootloader10=a;this.$MStructuredComposerPhotoPreviewBootloader11=b;this.$MStructuredComposerPhotoPreviewBootloader12=c;return this};d.getWaterfallID=function(){return this.$MStructuredComposerPhotoPreviewBootloader10};d.getWaterfallAppName=function(){return this.$MStructuredComposerPhotoPreviewBootloader11};d.getWaterfallSource=function(){return this.$MStructuredComposerPhotoPreviewBootloader12};return c}(b("mixin")(b("PhotosUploadWaterfallXMixin"),b("MComposerNavigationMixin")));e.exports=a}),null);
__d("SlideshowImageUtil",["invariant","SlideshowConstants","immutable"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=b("SlideshowConstants").formats,i="-",j=24,k=1.3,l=10,m=460,n=32,o=.8,p={getCroppingSpec:function(a,c,d,e){if(e&&a){e=Object.keys(a)[0];a=a[e];return{format:b("SlideshowConstants").formats.Original,topLeft:a[0],bottomRight:a[1]}}return this.getFullSizeImageBoxCroppingSpec({width:d.width?d.width:0,height:d.height?d.height:0},{width:c.width,height:c.height})},shouldCropImages:function(a){__p&&__p();var b=a[0].width,c=a[0].height;for(var a=a,d=Array.isArray(a),e=0,a=d?a:a[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var f;if(d){if(e>=a.length)break;f=a[e++]}else{e=a.next();if(e.done)break;f=e.value}f=f;if(f.width!==b||f.height!==c)return!0}return!1},getCrops:function(a,b,c){a=this.calculateDefaultCoordinates(a,c);return c={},c[b]=a,c},calculateCropsForFormat:function(a,c,d){__p&&__p();var e=this;if(!a.size)return b("immutable").Map();var f=b("immutable").Map();switch(c){case h.Original:var g=a.first();g=d.get(g.key);var i=g.height,j=g.width;a.forEach(function(a){f=f.set(a.key,e.getCrops(d.get(a.key),j+b("SlideshowConstants").SIZE_DELIMITER+i,j/i))});break;case h.Wide:a.forEach(function(a){f=f.set(a.key,e.getCrops(d.get(a.key),c,b("SlideshowConstants").LANDSCAPE_ASPECT_RATIO))});break;case h.Square:a.forEach(function(a){f=f.set(a.key,e.getCrops(d.get(a.key),c,b("SlideshowConstants").SQUARE_ASPECT_RATIO))});break;case h.Vertical:a.forEach(function(a){f=f.set(a.key,e.getCrops(d.get(a.key),c,b("SlideshowConstants").VERTICAL_ASPECT_RATIO))});break;default:}return f},calculateDefaultCoordinates:function(a,b){var c,d;a.width/b>a.height?(c=a.height,d=a.height*b):(d=a.width,c=a.width/b);b=(a.width-d)/2;a=(a.height-c)/2;var e=Math.floor(b)-b,f=Math.floor(a)-a;return[[b+e,a+f],[Math.round(b+d+e),Math.round(a+c+f)]]},getPreviewBoxDimensions:function(a,c){__p&&__p();var d=c,e=c;if(a.length>0){a=a[0];a=Object.keys(a)[0];switch(a){case b("SlideshowConstants").formats.Wide:d=c/b("SlideshowConstants").LANDSCAPE_ASPECT_RATIO;break;case b("SlideshowConstants").formats.Vertical:e=c*b("SlideshowConstants").VERTICAL_ASPECT_RATIO;break;case b("SlideshowConstants").formats.Square:break;default:c=a.split(b("SlideshowConstants").SIZE_DELIMITER);a=Number(c[0]);c=Number(c[1]);a>c?d=Math.floor(e*c/a):e=Math.floor(d*a/c);break}}return{width:e,height:d}},getFullSizeImageBoxCroppingSpec:function(a,c){c=c.width/c.height;a=this.calculateDefaultCoordinates(a,c);a.length===2||g(0,1043);return{format:b("SlideshowConstants").formats.Original,topLeft:a[0],bottomRight:a[1]}},getDefaultCroppingSpec:function(a){a=this.calculateDefaultCoordinates(a,1);a.length===2||g(0,1043);return{format:b("SlideshowConstants").formats.Square,topLeft:a[0],bottomRight:a[1]}},getHorizontalAlignmentForAPI:function(a){a=a.split(i);return a[1]},getFontSize:function(a){return Math.floor(j*a)},getFontWeight:function(a){return a?"bold":"normal"},getLineHeight:function(){return k},getOpacity:function(){return o},getTextoverlayMaxEdge:function(a,b){return a-n*b*2-l*b*2},getTextoverlayPadding:function(a){return l*a},getTextoverlayMargin:function(a){return n*a},getScaleMultiplierFromCrops:function(a){a=Object.keys(a)[0];a=a.split(b("SlideshowConstants").SIZE_DELIMITER);var c=Number(a[0]);a=Number(a[1]);return p.getScaleMultiplier(c,a)},getScaleMultiplier:function(a,b){return Math.max(a/m,b/m)},getOuterTextboxCoordinatesForAPI:function(a,c,d){a=Object.keys(a)[0];a=a.split(b("SlideshowConstants").SIZE_DELIMITER);var e=Number(a[0]);a=Number(a[1]);e=p.calculateTextboxCoordinates(a,e,c,d);return[Math.floor(e.marginLeft),Math.floor(a-e.marginTop-e.textHeight),Math.ceil(e.marginLeft+e.textWidth),Math.ceil(a-e.marginTop)]},getInnerTextboxCoordinatesForAPI:function(a,c,d){a=Object.keys(a)[0];a=a.split(b("SlideshowConstants").SIZE_DELIMITER);var e=Number(a[0]);a=Number(a[1]);e=p.calculateTextboxCoordinates(a,e,c,d);return[Math.floor(e.marginLeft),Math.floor(a-e.marginTop-e.textHeight),Math.ceil(e.marginLeft+e.textWidth),Math.ceil(a-e.marginTop)]},convertHexToRGBA:function(a){if(!a)return null;a=a.replace("#","");var b=parseInt(a.substring(0,2),16),c=parseInt(a.substring(2,4),16);a=parseInt(a.substring(4,6),16);return"rgba("+b+","+c+","+a+","+p.getOpacity()+")"},calculateTextboxCoordinates:function(a,b,c,d){__p&&__p();var e=c.text_alignment.split(i),f=e[1];e=e[0];var g=p.getFontSize(d),h=p.getTextoverlayMaxEdge(b,d),j=p.getTextoverlayMaxEdge(a,d),k=document.createElement("div");k.textContent=c.textoverlay_content?c.textoverlay_content:"";k.style.visibility="hidden";k.style.display="inline-block";k.style.wordWrap="break-word";k.style.whiteSpace="pre-wrap";k.style.fontFamily=c.font;k.style.fontWeight=p.getFontWeight(c.bold);k.style.fontSize=g+"px";k.style.textAlign=f;k.style.maxWidth=h+"px";k.style.maxHeight=j+"px";k.style.lineHeight=p.getLineHeight()*g+"px";k.style.padding=p.getTextoverlayPadding(d)+"px";k.style.letterSpacing="0.2px";document.body.appendChild(k);c=k.clientWidth;h=k.clientHeight;document.body.removeChild(k);j=n*d;g=n*d;k=b-n*d;var l=a-n*d;f=="center"?j=Math.min((b-c)/2,k):f=="right"&&(j=Math.min(b-n*d-c,k));e=="center"?g=Math.min((a-h)/2,l):e=="bottom"&&(g=Math.min(a-n*d-h,l));return{marginLeft:j,marginTop:g,textHeight:h,textWidth:c}}};e.exports=p}),null);
__d("SlideshowFrameImage.react",["Image.react","React","SlideshowImageUtil"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a=function(a){__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.$5=function(){__p&&__p();this.props.croppingSpec?(this.$3={width:this.props.imageWidth,height:this.props.imageHeight},this.$4={x:-this.props.croppingSpec.topLeft[0],y:-this.props.croppingSpec.topLeft[1]},this.$1={width:this.props.croppingSpec.bottomRight[0]+this.$4.x,height:this.props.croppingSpec.bottomRight[1]+this.$4.y}):(this.$3={width:this.props.imageWidth,height:this.props.imageHeight},this.$4={x:0,y:0},this.$1={width:this.props.imageWidth,height:this.props.imageHeight});if(this.props.fitToMaxHeightAndWidth){var a=this.props.maxWidth/this.$1.width;this.$3.width*=a;this.$4.x*=a;this.$1.width*=a;a=this.props.maxHeight/this.$1.height;this.$3.height*=a;this.$4.y*=a;this.$1.height*=a}else{a=Math.min(this.props.maxWidth/this.$1.width,this.props.maxHeight/this.$1.height);this.$3.width*=a;this.$3.height*=a;this.$4.x*=a;this.$4.y*=a;this.$1.width*=a;this.$1.height*=a}this.$2={x:(this.props.maxWidth-this.$1.width)/2,y:(this.props.maxHeight-this.$1.height)/2}};d.$6=function(){var a=this.props.textoverlay,c=b("SlideshowImageUtil").getScaleMultiplier(this.props.maxWidth,this.props.maxHeight);if(!a||!a.textoverlay_content)return null;var d=b("SlideshowImageUtil").calculateTextboxCoordinates(this.props.maxHeight,this.props.maxWidth,a,c),e=a.text_alignment.split("-")[1];return b("React").createElement("div",{style:{backgroundColor:b("SlideshowImageUtil").convertHexToRGBA(a.background_color),color:a.font_color,position:"absolute",fontFamily:a.font,fontSize:b("SlideshowImageUtil").getFontSize(c),fontWeight:b("SlideshowImageUtil").getFontWeight(a.bold),letterSpacing:"0.2px",lineHeight:b("SlideshowImageUtil").getLineHeight(),marginLeft:d.marginLeft,marginTop:d.marginTop,maxHeight:b("SlideshowImageUtil").getTextoverlayMaxEdge(this.props.maxHeight,c),maxWidth:b("SlideshowImageUtil").getTextoverlayMaxEdge(this.props.maxWidth,c),overflow:"hidden",overflowWrap:"break-word",padding:b("SlideshowImageUtil").getTextoverlayPadding(c),textAlign:e,whiteSpace:"pre-wrap"}},a.textoverlay_content)};d.render=function(){this.$5();return b("React").createElement("div",{className:this.props.className,style:{position:this.props.positionStyle,width:this.$1.width,height:this.$1.height,left:this.$2.x,top:this.$2.y,overflow:"hidden"}},b("React").createElement(b("Image.react"),{src:this.props.imageSrc,width:this.$3.width,height:this.$3.height,style:{position:"absolute",left:this.$4.x,top:this.$4.y}}),this.$6())};return c}(b("React").Component);a.defaultProps={className:null,croppingSpec:null,fitToMaxHeightAndWidth:!1,positionStyle:"absolute",textoverlay:null};e.exports=a}),null);
__d("MSlideshowPlayer.react",["cx","DOM","MImageFetchNotifier","React","ReactDOM","ShimButton.react","SlideshowFrameImage.react","SlideshowImageUtil","Style","SubscriptionsHandler","cancelAnimationFrame","requestAnimationFrame"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();a=b("React").PropTypes;var h=300,i=1.7143;c=b("React").createClass({displayName:"MSlideshowPlayer",_animationID:null,_timeout:null,_currIndex:0,_subscriptions:null,propTypes:{durationInMS:a.number.isRequired,transitionInMS:a.number.isRequired},getInitialState:function(){return{imagesAllLoaded:!1,playing:!1}},UNSAFE_componentWillMount:function(){var a=this,c=new(b("SubscriptionsHandler"))(),d=b("React").Children.count(this.props.children);b("React").Children.forEach(this.props.children,function(e){e=e.props.src;c.addSubscriptions(b("MImageFetchNotifier").notifyWhenFetched(e,function(){d--,d===0&&a.setState({imagesAllLoaded:!0})}))});this._subscriptions=c},componentDidMount:function(){this._timeout=null},componentWillUnmount:function(){this._clearTimeout(),this._subscriptions&&this._subscriptions.release()},shouldComponentUpdate:function(a,b){return b.imagesAllLoaded!==this.state.imagesAllLoaded||b.playing!==this.state.playing},_clearTimeout:function(){this._timeout&&(clearTimeout(this._timeout),this._timeout=null),this._animationID&&(b("cancelAnimationFrame")(this._animationID),this._animationID=null)},_getItemCount:function(){return b("React").Children.count(this.props.children)},_moveNext:function(){this._currIndex++,this._currIndex>=this._getItemCount()?this._stopPlaying():this._fadeImage()},_setTimeout:function(){this._timeout=setTimeout(this._moveNext,this.props.durationInMS)},_fadeImage:function(){var a=this,c=b("ReactDOM").findDOMNode(this.refs[this._currIndex-1]),d=0,e=function e(f){d=d===0?f:d;f=Math.max(1-(f-d)/a.props.transitionInMS,0);b("Style").set(c,"opacity",f);f===0?a._setTimeout():a._animationID=b("requestAnimationFrame")(e)};this._animationID=b("requestAnimationFrame")(e)},_resetImages:function(){this._currIndex=0;for(var a=0;a<this._getItemCount();a++)b("Style").set(b("ReactDOM").findDOMNode(this.refs[a]),"opacity",1)},_startPlaying:function(){if(this._timeout)return;this.setState({playing:!0},this._setTimeout)},_stopPlaying:function(){this._timeout&&(this.setState({playing:!1}),this._clearTimeout(),this._resetImages())},_getImageDimensions:function(a){if(this.refs[a]){a=b("DOM").find(b("ReactDOM").findDOMNode(this.refs[a]),"img");return{width:a.naturalWidth,height:a.naturalHeight}}return{width:0,height:0}},_getCurrentImages:function(a,c,d){var e=this;return b("React").Children.map(this.props.children,function(f,g){var h=e._getImageDimensions(g),i=d?b("SlideshowImageUtil").getDefaultCroppingSpec(h):null;return b("React").createElement(b("SlideshowFrameImage.react"),{imageSrc:f.props.src,imageWidth:h.width,imageHeight:h.height,croppingSpec:i,maxWidth:a,maxHeight:c,ref:g,key:g})}).reverse()},render:function(){var a=this;if(this._getItemCount()===0)return b("React").createElement("div",null);var c=b("React").Children.map(this.props.children,function(b,c){return a._getImageDimensions(c)}),d=b("SlideshowImageUtil").shouldCropImages(c);c=d||!this.state.imagesAllLoaded?1:c[0].width/c[0].height;c=h/Math.max(c,i);return b("React").createElement("div",{className:"_1k7"},b("React").createElement("div",{className:"_1k8",style:{width:h,height:c}},this._getCurrentImages(h,c,d)),b("React").createElement("div",{className:"_1k9"+(this.state.playing||!this.state.imagesAllLoaded?" _1ka":"")},b("React").createElement(b("ShimButton.react"),{className:"_1o0y",onClick:this._startPlaying})))}});e.exports=c}),null);
__d("MStructuredComposerSlideshowPreview",["CSS","DOM","Image.react","MComposerNavigationMixin","MComposerSlideshowLogger","MCompositionPhotoStore","MSlideshowPlayer.react","MSubscriptionsHandlerMixin","React","ReactDOM","SlideshowConstants","Stratcom","mixin"],(function(a,b,c,d,e,f){__p&&__p();var g="cancel_slideshow_preview",h="show_slideshow_preview",i="submit_slideshow";a=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(c,d){var e;e=a.call(this)||this;e.$MStructuredComposerSlideshowPreview1=c;e.$MStructuredComposerSlideshowPreview2=d;e.$MStructuredComposerSlideshowPreview3=null;e.addSubscriptions(b("DOM").listen(e.$MStructuredComposerSlideshowPreview2,"click",h,e.$MStructuredComposerSlideshowPreview4.bind(babelHelpers.assertThisInitialized(e))),b("DOM").listen(e.$MStructuredComposerSlideshowPreview1,"click",g,e.$MStructuredComposerSlideshowPreview5.bind(babelHelpers.assertThisInitialized(e))),b("DOM").listen(e.$MStructuredComposerSlideshowPreview1,"click",i,e.$MStructuredComposerSlideshowPreview6.bind(babelHelpers.assertThisInitialized(e))));return e}var d=c.prototype;d.$MStructuredComposerSlideshowPreview7=function(a){var c=b("MCompositionPhotoStore").get("photo_info_list",[]).map(function(a,c){return b("React").createElement(b("Image.react"),{src:a.previewURI,key:c})});return b("ReactDOM").render(b("React").createElement(b("MSlideshowPlayer.react"),{durationInMS:b("SlideshowConstants").photo_duration,transitionInMS:b("SlideshowConstants").photo_transition_duration},c),a)};d.$MStructuredComposerSlideshowPreview4=function(){var a=this;this.newNavigationPolicy().addOnOpen(function(){a.$MStructuredComposerSlideshowPreview3=a.$MStructuredComposerSlideshowPreview7(b("DOM").find(a.$MStructuredComposerSlideshowPreview1,"div","slideshow_preview_placeholder")),b("CSS").show(a.$MStructuredComposerSlideshowPreview1),b("MComposerSlideshowLogger").log("intent_slideshow_preview")}).addOnClose(function(){b("ReactDOM").unmountComponentAtNode(b("DOM").find(a.$MStructuredComposerSlideshowPreview1,"div","slideshow_preview_placeholder")),b("CSS").hide(a.$MStructuredComposerSlideshowPreview1),b("MComposerSlideshowLogger").log("cancel_slideshow_preview")}).addOnCloseByBrowser(function(){return b("CSS").hide(a.$MStructuredComposerSlideshowPreview1)}).open()};d.$MStructuredComposerSlideshowPreview5=function(){if(!this.hasNavigationPolicy())return;this.currentNavigationPolicy().close()};d.$MStructuredComposerSlideshowPreview6=function(){[b("DOM").find(this.$MStructuredComposerSlideshowPreview1,"button",i),b("DOM").find(this.$MStructuredComposerSlideshowPreview1,"button",g)].forEach(function(a){a.disabled=!0}),b("Stratcom").invoke("MStructuredComposerSlideshowPreview-submit")};d.setSubmitButtonText=function(a){b("DOM").setContent(b("DOM").find(this.$MStructuredComposerSlideshowPreview1,"button",i),a)};return c}(b("mixin")(b("MComposerNavigationMixin"),b("MSubscriptionsHandlerMixin")));e.exports=a}),null);
__d("UnpublishedContentTypeJSConstants",[],(function(a,b,c,d,e,f){e.exports=Object.freeze({PUBLISHED:0,SCHEDULED:1,DRAFT:2,ADS_POST:3,GLOBAL_CONTENT:4,PREVIEW:5,INLINE_CREATED:6,VALIDATION:7,LOCATION:8,INSTANT_ARTICLE:9,TAROT_DIGEST:10,BOOST_CANDIDATE:11,REVIEWABLE_BRANDED_CONTENT:12,WOODHENGE:13,AD_BREAK_PREREVIEW:14,BCMP_DEAL_DRAFT_POST:15})}),null);
__d("XPhotosIncrementThumbnailPreviewNUXImpressionsController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/photos/tagging/increment_thumbnail_preview_nux_impressions/",{})}),null);
__d("XPrivacyRemindersImpressionLoggingController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/privacy/reminders/log_imp/",{type:{type:"String",required:!0}})}),null);
__d("whitelistObjectKeys",[],(function(a,b,c,d,e,f){function a(a,b){var c={};b=Array.isArray(b)?b:Object.keys(b);for(var d=0;d<b.length;d++)typeof a[b[d]]!=="undefined"&&(c[b[d]]=a[b[d]]);return c}e.exports=a}),null);
__d("MStructuredComposer",["cx","fbt","ActorURI","BanzaiLogger","CSS","CurrentUser","DateTime","DOM","GroupSellLogger","LoadingIndicator","MAjaxify","MAjaxifyFormTypes","MarauderLogger","MComposerBackgroundUploadProgress","MComposerDestinationPickerConfig","MComposerEligibility","MComposerEntry","MComposerLogger","MComposerLoggerPublishingListeners","MComposerNavigationConstants","MComposerNavigationMixin","MComposerPresence","MComposerSlideshowLogger","MComposition","MCompositionConfigFields","MCompositionConfigStore","MCompositionFormatStore","MCompositionMinutiaeFields","MCompositionMinutiaeStore","MCompositionPageRecommendationsStore","MCompositionPhotoStore","MCompositionPlaceStore","MCompositionPrivacyStore","MCompositionShareStore","MCompositionSlideshowStore","MCompositionStatusStore","MCompositionUserActions","MCompositionWithStore","MGroupSellInterceptUtil","MInputFocus","MJSEnvironment","MLegacyDataStore","MMultiPhotoUploaderAttachmentState","MPrivacyComposerSelector","MRequest","MRequestTypes","MStoriesProductionTrayAsync","MStoriesToast","MStoriesUIConstants","MStructuredComposerOGInput","MStructuredComposerPhotoPreviewBootloader","MStructuredComposerSlideshowPreview","MTagSuggestionsController","MTouchClick","MViewport","PageRecommendationsMinChar","PrivacyConst","SlideshowConstants","Stratcom","Timezone","UnpublishedContentTypeJSConstants","URI","URLMatcher","UserAgent","Vector","WebGraphQLLegacyHelper","WildeLoader","XAsyncRequest","XInlineComposerAudienceEducationController","XPhotosIncrementThumbnailPreviewNUXImpressionsController","XPrivacyRemindersImpressionLoggingController","XWebGraphQLMutationController","$","areEqual","createDeprecatedProperties","ge","getActiveElement","getObjectValues","gkx","mixin","setTimeoutAcrossTransitions","uuid","whitelistObjectKeys"],(function(a,b,c,d,e,f,g,h){__p&&__p();var i,j,k=b("WildeLoader").MWildeTimelinePublisherBar,l=5,m=6*3600*1e3,n=100;d=function(d){"use strict";__p&&__p();babelHelpers.inheritsLoose(e,d);function e(a,e,f,g,i,j,k,l,m,n,o,p,q,r,s,t,u,v){__p&&__p();var w;w=d.call(this)||this;w._resetComposer=function(){__p&&__p();w._onComposerCancel=null;w._onComposerSubmit=null;w._isPageCheckin&&(w._isPageCheckin=!1,w._changeConfig(w._defaultConfig));w._submitted=!1;w._updateSubmitButtonState();b("DOM").hide(w._error_btn);w._hasMentions=!1;w._numMentions=0;w._friendsInputController.reset();w._ogTagger&&(w._ogInputController.reset(),b("Stratcom").invoke("composerReset"),w._ogTagger.hide());b("DOM").empty(w._xyTagsInput);w._photoAction&&(b("DOM").find(w._attachPhoto,"input","photo-input").value="",w._hasPhoto=!1,!w._getIsAlbumDisabled()?(w._removeAlbumAndPhoto(),w._albumPicker.hide()):(b("DOM").hide(w._attachPhoto),w._photoOpen=!1),b("CSS").conditionClass(w._photoButton,"active",!1),b("DOM").show(w._photoButton));w._slideshowToggle&&b("CSS").hide(w._slideshowToggle);w._slideshowNUX&&w._slideshowNUX.hasShown()&&(w._slideshowNUX.dismiss(),w._slideshowNUX=null);w._pageInfo&&b("DOM").hide(w._pageInfo);w._longReviewTips&&b("DOM").hide(w._longReviewTips);w._starsRatableInput&&b("DOM").hide(w._starsRatableInput);w._audienceAlignmentFlyout=null;w._showStickyGuardrailFlyout=!1;w._photoButton&&b("DOM").show(w._photoButton);var a=w._getPrivacySelector();a&&a.isOpen()&&a.hideMenu();w._privacySelector&&b("DOM").show(w._privacySelector);w._updateTagExpansion();w._onlyMeFlyoutShown=!1;w._mentionsEnabled=!0;b("Stratcom").invoke("MComposer:tagger:clear");w._resetPosition();w._determineFormAction();b("Stratcom").invoke("MMentions:clearHiddenInput");b("Stratcom").invoke("MCustomPrivacy::removeListener");w._closeComposer();w._cleanupLogWritten();b("Stratcom").invoke("MMentions:enable");b("Stratcom").invoke("MStructuredComposer:reset");w._multiPhotoUploader&&w._multiPhotoUploader.resetState();b("MCompositionUserActions").finalize();w._bgUploadWaitForMediaListener&&(w._bgUploadWaitForMediaListener.remove(),w._bgUploadWaitForMediaListener=null)};w._composerHasContent=function(){if(b("MComposerEligibility").isComposerEmpty()){w._showError(h._("Please add content to your status before posting"));return!1}return!0};w._handleEditChange=function(){w._hasEditChanges=!0};c=p;w._isInMSitePagesSharingHoldout=!1;w._ogClearablePreview=r;w._albumPicker=g;w._ogTagger=i;w._multiPhotoUploader=j;w._pageInfo=k;w._createLabel=l;w._updateLabel=m;w._photosPreviewConfig=u;w._photoPreview=null;w._photosPreviewNux=v;w._numMentions=0;w._hasMentions=!!w._numMentions;w._defaultHideConfig={};w._previewedAttachmentId=-1;w._targetType=n;w._entryPointRef=o;w._stayHiddenUntilOGTaggerCloses=!1;w._logWrittenListener=null;w._onComposerCancel=null;w._onComposerSubmit=null;w._root=a;w._isCreateAlbumDialogOpen=!1;w._mentionsEnabled=!0;w._albumID=b("$")("album_fbid").value;f=b("$")("attach_photo");q=b("MCompositionConfigStore").get("disable_album",w._defaultHideConfig.disable_album);!q&&(w._albumPicker||w._multiPhotoUploader)?b("CSS").conditionClass(f,"_6-k",!0):b("DOM").hide(f);w._mainPage=b("$")("viewport");w._composer=b("DOM").find(w._root,"div","composer-main-view");w._composerTitle=b("DOM").find(w._composer,"div","composer-title");w._submitButtonNodes=b("DOM").scry(w._composer,"button","submit_composer");w._staticTemplates=b("$")("static_templates");w._error_btn=b("DOM").find(w._composer,"div","m-status-empty-error");w._forsaleIntercept=b("DOM").scry(w._composer,"div","m-forsale-intercept")[0];w._forsaleIntercept&&(w._forsaleInterceptForsale=b("DOM").find(w._forsaleIntercept,"button","forsale_intercept_forsale"),w._forsaleInterceptNonForsale=b("DOM").find(w._forsaleIntercept,"button","forsale_intercept_nonforsale"),w._groupID=b("DOM").find(w._forsaleIntercept,"input","sell-composer-group-id").value);w._forsaleInterceptShown=!1;w._forsaleInterceptDeclinedTimestamp=0;w._form=b("DOM").find(w._composer,"form");w._starsRatableInput=b("DOM").find(w._form,"div","composer-stars-ratable-input");w._ratingTextContainer=b("DOM").scry(w._form,"div","composer-stars-rating-text")[0];w._xyTagsInput=b("DOM").find(w._form,"div","xy-tags-input");w._friendsInputController=new c(e,b("DOM").find(w._form,"div","with-tags"),b("DOM").find(w._form,"button","with-button"));w._multiPhotoUploader&&s&&(w._tagSuggestionsController=new(b("MTagSuggestionsController"))(e,w._multiPhotoUploader,w._targetType,w._form.target.value,w._friendsInputController,t),w._photosPreviewConfig&&w._multiPhotoUploader.getUploader().setProps({onUploadStarted:w._initPhotoPreview.bind(babelHelpers.assertThisInitialized(w))}));w._multiPhotoUploader.getUploader().setProps({onUploadSuccess:w._onUploadSuccess.bind(babelHelpers.assertThisInitialized(w))});w._slideshowToggle=b("DOM").scry(w._form,"div","slideshow-toggle")[0];w._slideshowToggleOptions=w._slideshowToggle?b("DOM").scry(w._slideshowToggle,"input","slideshow-option"):null;w._slideshowInput=b("DOM").scry(w._form,"input","slideshow-input")[0];w._slideshowNoticePhotoMin=b("DOM").scry(w._composer,"div","slideshow-photo-min-msg")[0];w._slideshowNoticePhotoMax=b("DOM").scry(w._composer,"div","slideshow-photo-max-msg")[0];w._contextualMessage=b("DOM").scry(w._form,"div","contextual_message")[0];p=b("DOM").scry(w._form,"div","js_placeholder");w._placeholder=p.length>0?p[0]:null;w._textarea=b("DOM").find(w._form,"textarea","composer-textarea");w._postTypeInput=b("DOM").scry(w._form,"input","unpublished_content_type_input")[0];w._defaultAction=w._form.action;i&&(w._ogInputController=new(b("MStructuredComposerOGInput"))(b("DOM").find(w._form,"div","og-tags"),b("DOM").find(w._form,"button","og-button"),b("DOM").find(w._form,"div","og-object-attachment"),i,w._ogClearablePreview));w._buttonbar=b("DOM").find(w._root,"div","composer-buttons");w._listeners=[];w._editChangesProducers=[b("MCompositionMinutiaeStore"),b("MCompositionPlaceStore"),b("MCompositionPrivacyStore"),b("MCompositionStatusStore"),b("MCompositionWithStore")];w._postToStoryEnabled=b("MComposerDestinationPickerConfig").default_select_stories;w._postToFeedEnabled=b("MComposerDestinationPickerConfig").default_select_newsfeed;w._textFormatPresetId=null;w._isExternalLinkPreview=!1;w._waitForPollingTagSuggestions=!1;w._saveConfig();return w}var f=e.prototype;f._getNavigationPolicy=function(a,c){var d=this,e=this.newNavigationPolicy().addOnOpen(function(){return d._showComposer(a,c||{})}).addOnOpenChild(function(){return d._hideForInterstitial()}).addOnReturnFromChild(function(){b("CSS").conditionShow(d._composer,!d._stayHiddenUntilOGTaggerCloses),d._focusOnTextarea()}).addCloseByBrowserApprover(function(){return d._confirmClose()}).addOnCloseByBrowser(function(){return d._cancelComposer()});this._onComposerCancel&&e.addOnCloseByBrowser(this._onComposerCancel);return e};f._getDefaultCancelConfirmMessage=function(){if(this._composerType==="edit")return h._("Are you sure you want to discard your changes?");else return h._("Are you sure you want to discard this post?")};f._confirmClose=function(){__p&&__p();this._composerType==="recommendation"&&b("BanzaiLogger").log("ReviewProductionLoggerConfig",{event:"composer_discard_dialog_shown",page_id:this._recommendationData.pageid,surface:this._getRecommendationSurface()});b("MComposerLogger").log("intent_composer_cancel");var c;this._composerType==="edit"?c=this._shouldEditStatus():this._composerType==="group_sell"?c=this._isValidForSalePost():c=this._shouldPostStatus();c=b("UserAgent").isBrowser("Mobile Safari 9")?!1:c;if(c){c=b("MCompositionConfigStore").get("cancel_confirm_message")||this._getDefaultCancelConfirmMessage();if(!a.confirm(c)){this._composerType==="recommendation"&&b("BanzaiLogger").log("ReviewProductionLoggerConfig",{event:"composer_discard_dialog_cancel",page_id:this._recommendationData.pageid,surface:this._getRecommendationSurface()});return!1}this._composerType==="recommendation"&&b("BanzaiLogger").log("ReviewProductionLoggerConfig",{event:"composer_discard_dialog_confirm",page_id:this._recommendationData.pageid,surface:this._getRecommendationSurface()})}this._composerType==="recommendation"&&b("BanzaiLogger").log("ReviewProductionLoggerConfig",{event:"composer_cancel",page_id:this._recommendationData.page_id,surface:this._getRecommendationSurface()});return!0};f._navigateAwayFromComposerAndCancel=function(){var a=this;if(!this.hasNavigationPolicy())return;if(!this._confirmClose())return;var b=this.currentNavigationPolicy().addOnClose(function(){return a._cancelComposer()});this._onComposerCancel&&b.addOnClose(this._onComposerCancel);b.close()};f._navigateAwayFromComposer=function(a){var b=this;if(!this.hasNavigationPolicy())return;var c=this.currentNavigationPolicy().addOnClose(function(){return b._resetComposer()});c.setIsOnSubmit();this._onComposerSubmit&&c.addOnClose(this._onComposerSubmit.bind(null,a));c.close()};f._navigateToComposer=function(a,c){if(b("MComposerEntry").blockNavigateToComposer())return;this._getNavigationPolicy(a,c).open()};f._navigateToComposerAndCheckin=function(){var a=this;if(b("MComposerEntry").blockNavigateToComposer())return;this._getNavigationPolicy("checkin").addOnOpen(function(){b("DOM").hide(a._composer),a._startCheckin()}).addOnCloseByBrowser(function(){b("Stratcom").invoke("back","MComposer:dialog:place")}).open()};f._focusOnTextarea=function(){this._skipFocus()||this._textarea.focus()};f._initializeComposition=function(a){a.CONFIG=babelHelpers["extends"]({},this._defaultConfig,a.CONFIG),b("MCompositionUserActions").initialize(a)};f._setPlaceholder=function(a){this._placeholder?(this._textarea.placeholder="",b("DOM").setContent(this._placeholder,a)):this._textarea.placeholder=a};f._showComposer=function(a,c){__p&&__p();var d=this;c.targetid&&(this._form.target.value=c.targetid);b("Stratcom").invoke("MPrivacyDeferredSelector::init");b("Stratcom").listen("MPrivacyDeferredSelector-loaded",null,function(){this._privacyDeferredSelectorHasLoaded=!0}.bind(this));var e=c.COMPOSITION||{};Object.prototype.hasOwnProperty.call(e,"CONFIG")||(e.CONFIG=b("whitelistObjectKeys")(c,b("getObjectValues")(b("MCompositionConfigFields"))));var f=this._getFormInput();this._wasLoadedWithAsyncPlaceholderComposer?this.copyPlaceholderComposerFormTextAndFocus(e):f.value&&f.value.length>0&&this._setCompositionDataStatusText(e,f.value);this._initializeComposition(e);b("Stratcom").invoke("MMentions:reset");this._composerType=b("MCompositionConfigStore").get("composer_type",a);if(c&&c.og_activity){f={};for(var g in b("MCompositionMinutiaeFields")){e=b("MCompositionMinutiaeFields")[g];f[e]=c.og_activity[e]}b("MCompositionUserActions").minutiaeSet(f)}this._logWrittenListener=b("DOM").listen(this._textarea,"keyup",null,function(){return d._logWritten()});e=b("MCompositionConfigStore").get("placeholder");e&&this._setPlaceholder(e);c=b("MCompositionConfigStore").get("contextualmessage");this._syncSubmit=b("MCompositionConfigStore").get("syncsubmit");this._contextualMessage&&(this._contextualMessage.textContent=c||"",b("CSS").conditionShow(this._contextualMessage,!!c));if(this._ogTagger){b("MarauderLogger").log("og_composer_show_composer");if(!this._ogTaggerLoaded){f="/platform/og/composer/tagger";e=new(b("MRequest"))(f).setData({entry_ref:this._entryPointRef}).setType(b("MRequestTypes").DEPENDENT);e.listen("postprocess",function(){this._composerType==="activity"&&this._ogTagger.toggleIncludedPlaceSelector(!0),b("MarauderLogger").log("og_composer_async_loaded")}.bind(this));b("MAjaxify").ajaxify(null,null,e,null);this._ogTaggerLoaded=!0}}this._multiPhotoUploader&&a==="photo"?this._showMultiPhotoUploader():this._ogTagger&&a==="activity"&&this._ogTagger.toggleIncludedPlaceSelector(!0);this._composerType==="edit"&&this._observeEditChanges();b("DOM").hide(this._mainPage);b("DOM").show(this._composer);b("MViewport").scrollTo(0,0);this._forsaleInterceptShown&&(b("DOM").hide(this._forsaleIntercept),this._forsaleInterceptShown=!1);b("Stratcom").invoke("MStructuredComposer-opened",null,{session_id:this._getSessionID(),composer_type:a,target_type:this._targetType,entry_point_ref:this._entryPointRef,opened_time:b("MCompositionConfigStore").get("opened_at")});b("MComposerLogger").log("composer_entry",{composer_type:a,ref:this._entryPointRef,target_type:this._targetType});c=b("MCompositionConfigStore").get("disable_voice_selector");f=b("DOM").scry(this._form,"div","composer-actor-selector")[0];f&&(c?b("DOM").hide(f):b("DOM").show(f));e=b("MCompositionShareStore").get("LINK_NO_CHANGE");this._sharePreview&&this._shouldShowLinkPreview()&&this._composerType==="edit"&&e&&this._sharePreview.init();this._hasPageRecommendations()&&this._toggleSubmitButtonState(!1);this._backgroundUploadProgress=b("MComposerBackgroundUploadProgress").init();this._backgroundUploadProgress&&(this._waitForPollingTagSuggestions=this._backgroundUploadProgress.isWaitingForTagSuggestions());return!0};f._setCompositionDataStatusText=function(a,b){Object.prototype.hasOwnProperty.call(a,"STATUS")||(a.STATUS={}),a.STATUS.TEXT=b};f._observeEditChanges=function(){var a=this;this._hasEditChanges=!1;this._editChangesProducers.forEach(function(b){a._listeners.push(b.once("change",a._handleEditChange,a))})};f._navigateToComposerAndOpenFriendTagger=function(a){var c=this;if(b("MComposerEntry").blockNavigateToComposer())return;this._getNavigationPolicy("tag_friend",a).addOnOpen(function(){b("DOM").hide(c._composer),b("Stratcom").invoke("MComposer:tagger:open")}).open()};f._navigateToComposerAndShowActivitySelector=function(a){var c=this;if(b("MComposerEntry").blockNavigateToComposer())return;this._getNavigationPolicy("activity",a).addOnOpen(function(){b("DOM").hide(c._composer),b("Stratcom").invoke("MComposer:open:activity")}).open()};f._navigateToComposerAndShowFileDialog=function(a,c){var d=this;if(b("MComposerEntry").blockNavigateToComposer())return;this._getNavigationPolicy("photo",a).addOnOpen(function(){b("MJSEnvironment").IS_ANDROID&&d._form.offsetHeight,b("MTouchClick").click(b("$")("photo_input"),c)}).open()};f._navigateToComposerAndFocus=function(a,c){__p&&__p();var d=this;if(b("MComposerEntry").blockNavigateToComposer())return;this._getNavigationPolicy(a,c).addOnOpen(function(){var a=b("MJSEnvironment").IS_APPLE_WEBKIT_IOS&&b("MJSEnvironment").OS_VERSION>=7;if(!d._skipFocus()&&a&&!d._audienceAlignmentFlyout&&!d._showStickyGuardrailFlyout){d._textarea.focus();a=d._getStatusText().length;d._textarea.setSelectionRange(a,a)}}).open()};f._showPrivacyEducationOnComposerOpen=function(){this._showStickyGuardrailFlyout?b("Stratcom").invoke("show_sticky_guardrail_flyout",null,{textarea:this._textarea}):this._audienceAlignmentFlyout&&this._showAudienceAlignmentTux()};f._showAudienceAlignmentTux=function(){__p&&__p();if(this._inAudienceAlignmentPublicExp){if(!this._composerEligibleForInterstitial(b("PrivacyConst").PostParam.EVERYONE))return}else if(this._inAudienceAlignmentOnlyMeExp&&!this._composerEligibleForInterstitial(b("PrivacyConst").PostParam.ONLY_ME))return;b("Stratcom").invoke("MMentions:decorations:hide",null,{});b("MViewport").scrollTo(0,0);this._textarea.blur();this._audienceAlignmentFlyout.registerComposer(this._composer);this._audienceAlignmentFlyout.registerPrivacySelector(this._privacySelector);this._audienceAlignmentFlyout.show();this._addAudienceAlignmentNuxListeners()};f._addAudienceAlignmentNuxListeners=function(){this._listeners.push(b("Stratcom").listen("MPrivacyAudienceAlignment:friends",null,function(){var a=this._getSavedCustomHiddenInput();if(a){a=b("XInlineComposerAudienceEducationController").getURIBuilder().setString("new_post_param",b("PrivacyConst").PostParam.FRIENDS.toString()).setBool("update_icon",!0).getURI();new(b("MRequest"))(a).send()}else this._friendsPrivacyRow=this._getPrivacyRow("value",b("PrivacyConst").PostParam.FRIENDS),b("Stratcom").invoke("MPrivacyComposerMenu:updatePrivacy",null,{row:this._friendsPrivacyRow})}.bind(this)))};f.setDefaultHideConfig=function(a){this._defaultHideConfig=a};f._getSavedCustomHiddenInput=function(){return b("ge")(b("MPrivacyComposerSelector").getSavedCustomInputName(),this._root)};f._closePrivacy=function(){var a=this._getPrivacySelector();a&&a.hideMenu()};f._openPrivacy=function(){var a=this._getPrivacySelector();a&&a.showMenu()};f._removeAlbumAndPhoto=function(){var a=b("ge")("default-album");a&&b("MTouchClick").click(a);this._multiPhotoUploader||b("DOM").hide(b("$")("photo_display"));this._getIsAlbumDisabled()||b("DOM").hide(b("$")("album-button"))};f._fetchUnpublishedContentType=function(){var a;a=(a=this._postTypeInput)!=null?a.value:a;return a in Object.values(b("UnpublishedContentTypeJSConstants"))&&this._isInMSitePagesSharingHoldout?a:0};f._updateSubmitButtonState=function(){__p&&__p();var a=!0;if(this._composerType==="recommendation"){if(this._shortReviewsDisableDone){var c=b("MLegacyDataStore").get(this._longReviewTips).threshold,d=this._textarea.value.length,e=b("MLegacyDataStore").get(this._longReviewTips).force_length,f=b("MLegacyDataStore").get(this._longReviewTips).text_required;e&&(d!==0||f)&&d<c&&(a=!1)}if(this._starsRatableInput){e=b("DOM").find(this._starsRatableInput,"input","stars-ratable-input");(!e.value||e.value==="0")&&(a=!1)}}this._submitted&&(a=!1);if(this._photosUploading&&(!this._backgroundUploadProgress||b("MComposerDestinationPickerConfig").composer_sharesheet_visible)){f=b("DOM").scry(this._composer,"button","submit_composer");f.forEach(function(a){b("DOM").setContent(a,h._("Preparing..."))});a=!1}else this._updatePostType(this._fetchUnpublishedContentType(),!1);!this._postToFeedEnabled&&!this._postToStoryEnabled&&(a=!1);b("MCompositionFormatStore").get("format_id")==="slideshow"&&!b("MCompositionSlideshowStore").get("is_valid")&&(a=!1);this._toggleSubmitButtonState(a)};f._writeRecommendation=function(a){a=b("MLegacyDataStore").get(a);this.captureFriendsPrivacyRow.bind(this);this._changeConfig(a.COMPOSITION.CONFIG);this._composerType="recommendation";this._recommendationData=babelHelpers["extends"]({},a);b("MComposerEntry").invoke(new(b("MComposition"))(a.COMPOSITION))};f._changeSettingsAfterOpen=function(){this._composerType==="recommendation"&&this._setupRecommendationAfterOpen()};f._getRecommendationSurface=function(){var a=b("MCompositionConfigStore").get("logging_surface");return!a?"none":a};f._setupRecommendationAfterOpen=function(){__p&&__p();var a=this._recommendationData;b("BanzaiLogger").log("ReviewProductionLoggerConfig",{event:"composer_open",page_id:a.pageid,surface:this._getRecommendationSurface()});this._friendsInputController.setVisible(!1);b("DOM").show(this._starsRatableInput);this._pageInfo&&(a.pageinfo?(b("DOM").show(this._pageInfo),b("DOM").setContent(this._pageInfo,a.pageinfo)):b("DOM").hide(this._pageInfo));this._ratingTextContainer&&a.zeroratingtext&&(this._ratingTextContainer.textContent=a.zeroratingtext);this._reviewLength=-1;(this._longReviewTips&&this._longReviewTips.children.length||this._longReviewTips&&b("MLegacyDataStore").get(this._longReviewTips).text_required)&&(b("DOM").show(this._longReviewTips),this._updateLongReviewTipText());a.viewerrating=a.viewerrating||0;b("Stratcom").invoke("MPagesStarsRatableBase-setStars",null,{rating:a.viewerrating});this._starPicker&&!a.viewerrating&&(b("DOM").hide(this._starsRatableInput),this._starPicker.setTitle(a.starpickertitle));this._updateSubmitButtonState();this._hasStartedTyping=!1;this._listeners.push(b("Stratcom")._listen("keyup","composer-textarea",function(c){this._hasStartedTyping||b("BanzaiLogger").log("ReviewProductionLoggerConfig",{event:"review_composer_started_typing",page_id:a.pageid,surface:this._getRecommendationSurface()}),this._hasStartedTyping=!0}.bind(this)),b("Stratcom").listen("click","privacy-button",function(a){b("BanzaiLogger").log("ReviewProductionLoggerConfig",{event:"review_composer_privacy_selector_click",page_id:this._recommendationData.pageid,surface:this._getRecommendationSurface()})}.bind(this)),b("Stratcom").listen("click","submit_composer",function(a){b("BanzaiLogger").log("ReviewProductionLoggerConfig",{event:"composer_done_button_click",page_id:this._recommendationData.pageid,surface:this._getRecommendationSurface()})}.bind(this)));this.currentNavigationPolicy().addOnCloseByBrowser(function(c){b("BanzaiLogger").log("ReviewProductionLoggerConfig",{event:"composer_cancel",page_id:a.page_id,surface:c})}.bind(this,this._getRecommendationSurface()))};f._updateLongReviewTipText=function(){__p&&__p();if(this._longReviewTips&&this._longReviewTips.children.length){var a=this._textarea.value.length;if(this._reviewLength===a)return;this._reviewLength=a;var c=b("MLegacyDataStore").get(this._longReviewTips).threshold,d=b("MLegacyDataStore").get(this._longReviewTips).force_length;if(d){d=b("DOM").find(this._longReviewTips,"span","composer-review-length-count");var e=h._("{character_count}\/{minimum_length} \u00b7",[h._param("character_count",a),h._param("minimum_length",c)]);c!==1&&b("DOM").setContent(d,e+" ");this._updateSubmitButtonState()}d=b("DOM").find(this._longReviewTips,"span","composer-short-review");b("CSS").conditionShow(d,(a>0||b("MLegacyDataStore").get(this._longReviewTips).text_required)&&a<c);e=b("DOM").find(this._longReviewTips,"span","composer-long-review");b("CSS").conditionShow(e,a>=c)}};f._resetAlbumSelection=function(){this._getIsAlbumDisabled()||b("CSS").conditionClass(b("$")("album-button"),"active",!1),this._privacySelector&&b("DOM").show(this._privacySelector),b("$")("album_fbid").value="0",b("$")("album_privacy").value="",this._albumChosen=!1,this._albumPicker.resetAlbumSelection()};f._resetPosition=function(){var a=this;if(this._showLoadingIndicator||this._backgroundUploadRunning)return;this.getScrollToElem()&&this.getShouldScroll()&&b("setTimeoutAcrossTransitions")(function(){var c=b("ge")(a.getScrollToElem());c&&b("MViewport").scrollToNodeWithOffset(c,-5)},0)};f._shouldSubmit=function(){return!b("MCompositionConfigStore").get("disable_submit_request",!1)};f._shouldSyncSubmit=function(){if(this._forceAsync||this._backgroundUploadRunning)return!1;return this._syncSubmit?!0:this._isPageCheckin||this._hasPhotos()||this._isUnpublishedPost};f._shouldShowLinkPreview=function(){var a=b("MCompositionConfigStore").get("disable_link");return!a&&this._composerType!=="share"&&(this._composerType==="activity"||this._composerType==="photo"||this._composerType==="checkin"||this._composerType==="status"||this._composerType==="edit")&&!this._hasPhoto};f._shouldPostStatus=function(){__p&&__p();if(!b("MCompositionShareStore").isEmpty())return!0;var a=b("DOM").convertFormToDictionary(this._form),c=o(a.status)!=="",d=o(a.message)!=="",e=o(a.recommendation)!=="";c=c||d||e;d=a.rating!=="0";e=this._friendsInputController.hasTokens();a=this._ogInputController&&this._ogInputController.hasValue();a=this._hasPhotos()||a;var f=!b("MCompositionPlaceStore").isEmpty()||this._isPageCheckin||this._pinPlace;return c||a||f||e||d?!0:!1};f._scheduledInFuture=function(){var a=this._schedulePostAMPM.value=="PM"||this._schedulePostAMPM.value==1?12:0;a=new Date(this._schedulePostYear.value,this._schedulePostMonth.value-1,this._schedulePostDay.value,parseInt(this._schedulePostHour.value,10)+a,this._schedulePostMinute.value,0,0);a=b("DateTime").fromDate(a,b("Timezone").getEnvironmentTimezoneID());var c=b("DateTime").localNow(),d=c.addMinutes(10);c=c.addMonths(6);return a>=d&&a<=c};f._shouldEditStatus=function(){return this._hasEditChanges};f._cleanupForsaleIntercept=function(){var a=b("DOM").scry(this._form,"input","composer_attachment_sell_currency")[0];a&&this._form.removeChild(a);a=b("DOM").scry(this._form,"input","composer_attachment_sell_price")[0];a&&this._form.removeChild(a);a=b("DOM").scry(this._form,"input","composer_attachment_sell_title")[0];a&&this._form.removeChild(a)};f._validateNonEmpty=function(a){__p&&__p();if(this._composerType==="group_sell")return this._isValidForSalePost();if(this._hasPageRecommendations())return this._isValidPageRecommendationPost(a);if(!this._shouldPostStatus()){a===""&&this._setStatusText("");this._showError(h._("Please add content to your status before posting"));return!1}return!0};f._isValidPageRecommendationPost=function(a){var c=b("PageRecommendationsMinChar").min_char;if(a.length<c){this._showError(h._("Posts must be at least {min character} characters long",[h._param("min character",c)]));return!1}return!0};f._isValidForSalePost=function(){__p&&__p();if(this._composerType!=="group_sell")return!0;var a=b("DOM").convertFormToDictionary(this._form),c=a.composer_attachment_sell_price,d=a.composer_attachment_sell_title,e=a.has_categories_enabled==="true",f=a.composer_attachment_sell_category,g=a.location_type==="inline";a=a.composer_attachment_sell_pickup_note;if(o(d)===""){this._showError(h._("Please add a title to your product"));return!1}if(o(d).length>n){this._showError(h._("Your title must be shorter than 100 characters long"));return!1}if(o(c)===""){this._showError(h._("Please add a price to your product"));return!1}if(g&&a.length<5){this._showError(h._("Please enter a valid location to your product"));return!1}if(e&&o(f)===""){this._showError(h._("Please select a category for your product"));return!1}return!0};f._postForSale=function(){__p&&__p();var a=o(this._getStatusText()),c=b("DOM").scry(this._forsaleIntercept,"input","sell-composer-currency-symbol")[0];if(!this._validateNonEmpty(a)||!c)return;a=b("MGroupSellInterceptUtil").parseInterceptedPrices(a,c.value);if(a===null||a.length!==1)return;c=document.createElement("input");c.type="hidden";c.name="composer_attachment_sell_currency";c.setAttribute("data-sigil","composer_attachment_sell_currency");c.value=b("DOM").find(this._forsaleIntercept,"input","sell-composer-currency").value;this._form.appendChild(c);c=document.createElement("input");c.type="hidden";c.name="composer_attachment_sell_price";c.setAttribute("data-sigil","composer_attachment_sell_price");c.value=a[0];this._form.appendChild(c);a=document.createElement("input");a.type="hidden";a.name="composer_attachment_sell_title";a.setAttribute("data-sigil","composer_attachment_sell_title");a.value=o(this._getStatusText());this._form.appendChild(a);this._submitted=!0;this._updateSubmitButtonState();b("GroupSellLogger").logComposerInterceptAccepted(this._groupID,1);this._callSubmit()};f._callSubmit=function(){var a=this._multiPhotoUploader&&this._multiPhotoUploader.hasPhotos(this._backgroundUploadProgress);this._backgroundUploadProgress?(a&&this._multiPhotoUploader.logClientPost(),this._submitToBackground()):a?this._multiPhotoUploader.logClientPost(this._submit.bind(this)):this._submit()};f._showForsaleIntercept=function(a){__p&&__p();if(!this._forsaleIntercept)return!1;if(this._forsaleInterceptShown){this._forsaleInterceptDeclinedTimestamp=Date.now();this._cleanupForsaleIntercept();b("GroupSellLogger").logComposerInterceptDeclined(this._groupID,1);return!1}if(this._forsaleInterceptDeclinedTimestamp>0&&Date.now()-this._forsaleInterceptDeclinedTimestamp<m)return!1;else this._forsaleInterceptDeclinedTimestamp=0;var c=b("DOM").scry(this._forsaleIntercept,"input","sell-composer-currency-symbol")[0];if(!c)return!1;a=b("MGroupSellInterceptUtil").parseInterceptedPrices(a,c.value);if(a!==null&&a.length===1){b("DOM").show(this._forsaleIntercept);this._forsaleInterceptShown=!0;b("GroupSellLogger").logComposerInterceptCreated(this._groupID,1);return!0}else{this._cleanupForsaleIntercept();return!1}};f._pickDestination=function(){b("Stratcom").invoke("MStructuredComposer-confirmed",null),b("MComposerDestinationPickerConfig").composer_sharesheet_visible?(this._postToStoryEnabled&&this._postToStory(),this._postToFeedEnabled?this._confirmClicked():window.location.reload()):this._confirmClicked()};f._confirmClicked=function(){__p&&__p();var c=o(this._getStatusText());if(!this._validateNonEmpty(c))return;if(this._showForsaleIntercept(c))return;if(this._postTypeInput.value==1&&!this._scheduledInFuture()){this._showError(h._("Scheduled posts need to be shared between 10 minutes and 6 months from when you create them."));return}this._hasPageRecommendations()&&(this._addHiddenInput(this._form,"page_recommendation_type",this._getPageRecommendationType()),this._addHiddenInput(this._form,"page_recommendation_entrypoint",this._getPageRecommendationeEntryPoint()),this._addHiddenInput(this._form,"page_recommendation_surface",this._getPageRecommendationSurface()));this._tagSuggestionsController&&this._tagSuggestionsController.setBackgroundPolling(!0);this._mentionsEnabled||b("Stratcom").invoke("MComposerStatusTextarea:flush",null,{value:this._textarea.value,hasMentions:this._mentionsEnabled});if(!this._albumChosen){c=this._getPrivacySelector();if(c&&c.getSelectedValue()==b("PrivacyConst").PostParam.ONLY_ME){c=b("XPrivacyRemindersImpressionLoggingController").getURIBuilder().setString("type","only_me_impression").getURI();b("MAjaxify").ajaxify(null,null,new(b("MRequest"))(c));var d=this._friendsInputController.hasTokens()||this._hasMentions;if(!d&&!window.confirm(h._("Only you will be able to see this post. Click 'Cancel' to change your audience."))){this._onlyMeFlyoutShown=!0;return}}else this._onlyMeFlyoutShown&&(c=b("XPrivacyRemindersImpressionLoggingController").getURIBuilder().setString("type","only_me_conversion").getURI(),b("MAjaxify").ajaxify(null,null,new(b("MRequest"))(c)))}this._onlyMeFlyoutShown=!1;d=this._ogInputController&&this._ogInputController.getLoggingData();d&&b("MarauderLogger").log("og_composer_action_created",void 0,d);this._submitted=!0;this._updateSubmitButtonState();if(this._composerType==="recommendation"&&(this._longReviewTips&&this._longReviewTips.children.length)){c=b("MLegacyDataStore").get(this._longReviewTips).threshold;d=this._textarea.value.length;var e=b("MLegacyDataStore").get(this._longReviewTips).force_length,f=b("MLegacyDataStore").get(this._longReviewTips).text_required;if(e&&(d!==0||f)&&d<c){if(this._shortReviewsDisableDone)return;e=h._("Your review must be at least {min_length} characters. Do you want to submit your star rating without your review?",[h._param("min_length",c)]);if(!a.confirm(e)){this._submitted=!1;this._updateSubmitButtonState();return}b("Stratcom").invoke("MComposerStatusTextarea:flush",null,{value:"",hasMentions:this._mentionsEnabled})}}b("MComposerLogger").log("composer_post",{loaded_time:b("MCompositionConfigStore").get("opened_at"),targetId:this._form.target.value||b("CurrentUser").getID()});b("MCompositionFormatStore").get("format_id")==="slideshow"&&b("MComposerSlideshowLogger").log("post_slideshow");this._callSubmit()};f._postToStory=function(){__p&&__p();var a=o(this._getStatusText()),c=b("MCompositionShareStore").get("SHARE_URI")!==null;if(!this._hasPhotos()&&a===""&&!c){a="There must be photos uploaded to the composer or text in order to successfully post to stories.";throw a}c=b("WebGraphQLLegacyHelper").getURI({controller:b("XWebGraphQLMutationController"),docID:"1931212663571278"});a=this._formPostToStoryDataObject();var d=b("MComposerEligibility").isStoryPostEligible(this._isExternalLinkPreview);if(d){d=new(b("XAsyncRequest"))().setURI(c).setMethod("POST").setData({variables:JSON.stringify({client_mutation_id:b("uuid")(),actor_id:this._form.target.value,input:a})}).setPayloadHandler(function(){b("MStoriesProductionTrayAsync").uploadCB(!0)}).setErrorHandler(function(a){b("MStoriesToast").showDefaultToast(b("MStoriesUIConstants").UPLOAD_FAILED),b("MStoriesProductionTrayAsync").uploadCB(!1)});d.send()}};f._formPostToStoryDataObject=function(){__p&&__p();var a={actor_id:this._form.target.value,client_mutation_id:b("uuid")(),source:"MOBILE",logging:{composer_session_id:this._getSessionID(),ref:"mcomposer"},camera_post_context:{deduplication_id:this._getSessionID(),source:"composer"},audiences:[{stories:{self:{target_id:this._form.target.value}}}]},c=o(this._getStatusText());c!==""&&b("MComposerEligibility").isTextEligible(c)&&(a.message={text:c});c=b("MCompositionPhotoStore").get("photo_info_list",null);if(c!==null){var d=[],e=!1;c.forEach(function(a){a.type==="photo"?d.push({photo:{id:a.fbid}}):a.type==="video"&&(e=!0,d.push({video:{id:a.fbid,notify_when_processed:!0}}))});a.attachments=d;e&&(a.web_graphml_migration_params={is_also_posting_video_to_feed:this._postToFeedEnabled})}c=b("MCompositionWithStore").get("TOKENS");if(c!==null){var f=[];c.forEach(function(a){f.push(a.id)});a.with_tags_ids=f}c=b("MCompositionPlaceStore").get("id");c!==null&&(a.explicit_place_id=c);if(this._ogInputController&&this._ogInputController.hasValue()){c={};var g=b("MCompositionMinutiaeStore").get("action_type");g&&(c.taggable_activity_id=g);g=b("MCompositionMinutiaeStore").get("object");g&&(c.object_id=g);a.inline_activities=[c]}this._textFormatPresetId&&(a.text_format_preset_id=this._textFormatPresetId);g=this._getLinkPreviewInformation();g&&(a.attachments===void 0?a.attachments=[{link:{share_scrape_data:JSON.stringify(g)}}]:a.attachments.push({link:{share_scrape_data:JSON.stringify(g)}}));return a};f._getLinkPreviewInformation=function(){__p&&__p();var a=b("MCompositionShareStore").get("SHARE_URI")!==null;if(!b("gkx")("676786")||!a||!this._isExternalLinkPreview)return null;a={};var c=b("DOM").scry(this._form,"input","attachment[type]");a.share_type=c.length>0?c[0].value:null;c={};c.urlInfo={};var d=b("DOM").scry(this._form,"input","attachment[params][urlInfo][canonical]");c.urlInfo.canonical=d.length>0?d[0].value:null;d=b("DOM").scry(this._form,"input","attachment[params][urlInfo][final]");c.urlInfo["final"]=d.length>0?d[0].value:null;d=b("DOM").scry(this._form,"input","attachment[params][urlInfo][user]");c.urlInfo.user=d.length>0?d[0].value:null;d=b("DOM").scry(this._form,"input","attachment[params][locale]");c.locale=d.length>0?d[0].value:null;d=b("DOM").scry(this._form,"input","attachment[params][favicon]");c.favicon=d.length>0?d[0].value:null;d=b("DOM").scry(this._form,"input","attachment[params][lang]");c.lang=d.length>0?d[0].value:null;d=b("DOM").scry(this._form,"input","attachment[params][external_author_id]");c.external_author_id=d.length>0?d[0].value:null;d=b("DOM").scry(this._form,"input","attachment[params][title]");c.title=d.length>0?d[0].value:null;d=b("DOM").scry(this._form,"input","attachment[params][summary]");c.summary=d.length>0?d[0].value:null;d=b("DOM").scry(this._form,"input","attachment[params][medium]");c.medium=d.length>0?d[0].value:null;d=b("DOM").scry(this._form,"input","attachment[params][url]");c.url=d.length>0?d[0].value:null;d=b("DOM").scry(this._form,"input","attachment[params][global_share_id]");c.global_share_id=d.length>0?d[0].value:null;d=b("DOM").scry(this._form,"input","attachment[params][url_scrape_id]");c.url_scrape_id=d.length>0?d[0].value:null;d=b("DOM").scry(this._form,"input","attachment[params][hmac]");c.hmac=d.length>0?d[0].value:null;d=b("DOM").scry(this._form,"input","attachment[params][external_img]");c.external_img=d.length>0?d[0].value:null;a.share_params=c;a.shared_from_post_id=null;return a};f._toggleShareSelections=function(a){this._postToFeedEnabled=a.getData().postToFeed,this._postToStoryEnabled=a.getData().postToStory,this._updateSubmitButtonState()};f._setTextFormatPresetId=function(a){a&&a.presetID?this._textFormatPresetId=a.presetID:this._textFormatPresetId=null};f._showError=function(a){b("DOM").show(this._error_btn),b("DOM").setContent(this._error_btn,a)};f._getAsyncContainer=function(){return document.getElementById("structured_composer_async_container")||(this._clickedButton?this._clickedButton.parentNode:null)};f._getSessionID=function(){return b("MCompositionConfigStore").get("csid",null)};f._getStatusText=function(){return b("MCompositionStatusStore").get("TEXT","")};f._setStatusText=function(a){var c={};c.TEXT=a;b("MCompositionUserActions").statusUpdate(c)};f._addHiddenInput=function(a,b,c){var d=document.createElement("input");d.type="hidden";d.name=b;d.value=c;a.appendChild(d)};f._hasPageRecommendations=function(){return this._getPageID()!==""&&this._getPageRecommendationType()!==""};f._getPageID=function(){return b("MCompositionPageRecommendationsStore").get("page_id","")};f._getPageRecommendationType=function(){return b("MCompositionPageRecommendationsStore").get("recommendation_type","")};f._getPageRecommendationSurface=function(){return b("MCompositionPageRecommendationsStore").get("surface","")};f._getPageRecommendationeEntryPoint=function(){return b("MCompositionPageRecommendationsStore").get("entry_point","")};f._submitToBackground=function(){var a=this;this.cleanupSoftState();this._closeComposer();this._showLoadingIndicator=!1;this._setBackgroundUploadRunning(!0);this._multiPhotoUploader.hasPendingPhotos()?this._bgUploadWaitForMediaListener=b("Stratcom").listen("MMultiPhotoUploader:attachments:change",null,function(c){c=c.getData();c.sending===0&&(!a._waitForPollingTagSuggestions||c.polling===0)&&(b("Stratcom").removeCurrentListener(),setTimeout(function(){return a._submit()},0))}):this._submit()};f._submit=function(){__p&&__p();if(!this._shouldSubmit()){this._submitNoRequest();return}this._tagSuggestionsController&&this._tagSuggestionsController.generateHiddenInput(this._xyTagsInput);b("Stratcom").invoke("MComposer:submit");if(this._shouldSyncSubmit()){this._submitSyncRequest();this._cleanupForsaleIntercept();return}this._submitAsyncRequest();this._cleanupForsaleIntercept()};f._getWithTagCount=function(){var a=b("MCompositionWithStore").get("TOKENS");return a?a.length:0};f._getXYTagCount=function(){return!this._tagSuggestionsController?0:this._tagSuggestionsController.getNumXYTags()};f._getTagsUser=function(){return this._numMentions};f._scrollToTopOfFeedAfterNextTransition=function(){if(!b("MComposerNavigationConstants").USE_PUSH_STATE)return;b("Stratcom").listen("m:history:change",null,function(){setTimeout(function(){var a=b("ge")("tlFeed");a&&b("MViewport").scrollToNodeWithOffset(a,-50)},10),b("Stratcom").removeCurrentListener()})};f._submitAsyncRequest=function(){__p&&__p();var a=this,c=b("DOM").convertFormToDictionary(this._form),d={};d.hasPhoto=this._hasPhotos();d.hasVideo=this._hasVideos();d.xy_tag_count=this._getXYTagCount();d.with_tag_count=this._getWithTagCount();d.tags_user=this._getTagsUser();d=[new(b("MComposerLoggerPublishingListeners"))(this._getSessionID(),d)];this._backgroundUploadRunning||d.push({postprocess:function(){a.cleanupSoftState()}});this._showLoadingIndicator&&(d.push({response:function(){a._submittingScreen?b("DOM").hide(a._submittingScreen):b("LoadingIndicator").hide(),a._navigateAwayFromComposer(c),a._showLoadingIndicator||a._resetPosition()}}),this._submittingScreen?b("DOM").show(this._submittingScreen):b("LoadingIndicator").show(!0));this._backgroundUploadRunning||d.push({response:function(){return a._scrollToTopOfFeedAfterNextTransition()}});var e=b("DOM").scry(this._form,"input","background_upload")[0];e&&(e.value=this._backgroundUploadRunning?"1":"");this._backgroundUploadRunning&&d.push({error:function(){a._setBackgroundUploadRunning(!1,!0)},"finally":function(){b("setTimeoutAcrossTransitions")(function(){a._setBackgroundUploadRunning(!1)},1e3),a._navigateAwayFromComposer(c)}});e=this._hasPhotos()?"media":"text";b("MAjaxify").form(null,this._form,"async_composer",b("MAjaxifyFormTypes").CACHE,this._getAsyncContainer(),!1,d,"composer_async_post_"+e,!0);this._staticTemplates.style.height="";if(this._submittingScreen||this._backgroundUploadRunning)return;this._navigateAwayFromComposer(c);this._showLoadingIndicator||this._resetPosition()};f._submitNoRequest=function(){this._staticTemplates.style.height="",this._navigateAwayFromComposer(b("DOM").convertFormToDictionary(this._form))};f._submitSyncRequest=function(){this._form.submit(),this._resetPosition()};f._setBackgroundUploadRunning=function(a,b){b===void 0&&(b=!1);this._backgroundUploadRunning=a;this.hasNavigationPolicy()&&this.currentNavigationPolicy().setBackgroundUploadRunning(a);if(b)this._backgroundUploadProgress.showErrorMsg();else{b=this._multiPhotoUploader.getMediaCount()>0;this._backgroundUploadProgress.setBackgroundUploadRunning(a,b)}};f._getIsAlbumDisabled=function(){return!this._albumPicker||b("MCompositionConfigStore").get("disable_album",this._defaultHideConfig.disable_album)};f._getIsSlideshowDisabled=function(){return!this._slideshowToggle||b("MCompositionConfigStore").get("disable_slideshow",this._defaultHideConfig.disable_slideshow)};f._updateButtonVisibility=function(a,c,d){a=b("DOM").scry(this._form,"button",a)[0];if(a){c=!!b("MCompositionConfigStore").get(c,this._defaultHideConfig[c]);b("CSS").conditionShow(a,d?!c:c)}};f._handlePhotoUpdate=function(){var a=b("MCompositionPhotoStore").get("photo_info_list",null);this._multiPhotoUploader&&a&&a.length>0&&(this._multiPhotoUploader.getUploader().component.setAttachmentsSilent(a),this._showMultiPhotoUploader())};f._updateSlideshowUIState=function(){var a=b("MCompositionFormatStore").get("format_id",null),c=b("MCompositionSlideshowStore").get("is_valid",!1),d=b("MCompositionPhotoStore").get("photo_info_list",[]).length;this._slideshowInput&&(this._slideshowInput.value=!this._getIsSlideshowDisabled()&&c&&a==="slideshow"?"1":"0");this._slideshowNoticePhotoMax&&b("CSS").conditionShow(this._slideshowNoticePhotoMax,a==="slideshow"&&d>b("SlideshowConstants").max_photo_num);this._slideshowNoticePhotoMin&&b("CSS").conditionShow(this._slideshowNoticePhotoMin,a==="slideshow"&&d<b("SlideshowConstants").min_photo_num);this._getIsSlideshowDisabled()?this._slideshowToggle&&b("CSS").hide(this._slideshowToggle):d>=b("SlideshowConstants").min_photo_num&&(this._slideshowToggle&&b("CSS").show(this._slideshowToggle),this._slideshowNUX&&this._slideshowNUX.showIfNotShown())};f._handleFormatUpdate=function(){__p&&__p();var a=b("MCompositionFormatStore").get("format_id",null),c=b("MCompositionFormatStore").get("prev_format_id",null);this._updateSlideshowUIState();this._updateSubmitButtonState();this._slideshowPreviewButton&&b("CSS").conditionShow(this._slideshowPreviewButton,a==="slideshow");this._submitButtonNodes!==null&&this._submitButtonNodes.forEach(function(c){b("CSS").conditionShow(c,a!=="slideshow")});this._slideshowToggleOptions!==null&&(this._slideshowToggleOptions.find(function(b){return b.value===(a||"photo")}).checked=!0);if(!a||a===c)return;b("MCompositionPhotoStore").get("photo_info_list",[]).length;a==="slideshow"?b("MComposerSlideshowLogger").log("intent_slideshow"):c==="slideshow"&&b("MComposerSlideshowLogger").log("cancel_slideshow")};f._handleSlideshowUpdate=function(){this._updateSlideshowUIState()};f._handleSlideshowToggleUpdate=function(a){var c;if(this._getIsSlideshowDisabled())return;a=this._slideshowToggleOptions.find(function(a){return a.checked}).value;b("MCompositionUserActions").formatUpdate((c={},c.format_id=a,c))};f._handleConfigUpdate=function(){__p&&__p();this._form.action=b("MCompositionConfigStore").get("action");this._composerTitle.textContent=b("MCompositionConfigStore").get("composertitle");if(this._photoAction){var a=b("MCompositionConfigStore").get("actor_id");(this._canRemoveActorVC||a!==null&&a!==void 0)&&(this._photoAction=b("ActorURI").create(this._photoAction,a).toString())}this._updateButtonVisibility("photo-button","disable_photos",!0);this._updateButtonVisibility("with-button","disable_people_tags",!0);this._updateButtonVisibility("og-button","disable_og_tags",!(this._ogTagger===void 0));this._updateButtonVisibility("privacy-button","disable_privacy",!0);this._updateButtonVisibility("post-type-button","showposttypeselector",!1);b("MCompositionConfigStore").get("showposttypeselector")||(b("Stratcom").invoke("MStructuredComposerPostTypeInput::setPublishNow"),this._updatePostType(this._fetchUnpublishedContentType(),!1));this._updateHiddenForm("target","targetid");b("MCompositionConfigStore").get("disable_mentions",!1)?(b("Stratcom").invoke("MMentions:disable"),this._mentionsEnabled=!1):(b("Stratcom").invoke("MMentions:enable"),this._mentionsEnabled=!0);a=this._ogInputController&&this._ogInputController.hasValue();a&&this._ogInputController.setDisableOgTagPreview(b("MCompositionConfigStore").get("disable_og_tags_preview",!1));a=b("MCompositionConfigStore").get("placeholder");a&&this._setPlaceholder(a);a=document.getElementById("composer_album_info");if(a){var c=b("MCompositionConfigStore").get("disable_album_info",this._defaultHideConfig.disable_album_info);c?(b("CSS").hide(a),b("$")("album_fbid").value="0"):(b("CSS").show(a),b("$")("album_fbid").value=this._albumID)}this._updateSlideshowUIState()};f._updateHiddenForm=function(a,c){a=b("DOM").scry(this._form,"input",a)[0];a&&(a.value=b("MCompositionConfigStore").get(c))};f._handleStatusUpdate=function(){this._updateLongReviewTipText(),this._updateShareScraper(),this._handlePageRecommendationsMinChar()};f._handlePageRecommendationsMinChar=function(){if(!this._hasPageRecommendations())return;var a=b("MCompositionStatusStore").get("TEXT",""),c=a.length>=b("PageRecommendationsMinChar").min_char;!c?this._contextualMessage.textContent=h._("{current length}\/{required length} \u00b7 Posts must be at least {required length} characters",[h._param("current length",a.length),h._param("required length",b("PageRecommendationsMinChar").min_char)]):this._contextualMessage.textContent=this._placeholder.textContent;b("CSS").show(this._contextualMessage);this._toggleSubmitButtonState(c)};f._logWritten=function(){if(this._getStatusText().trim()<l)return;b("MComposerLogger").log("composer_written",{publish_target:this._form.target.value||b("CurrentUser").getID(),loaded_time:b("MCompositionConfigStore").get("opened_at"),written_time:Date.now()});this._cleanupLogWritten()};f._cleanupLogWritten=function(){if(!this._logWrittenListener)return;this._logWrittenListener.remove();this._logWrittenListener=null};f._getFormInput=function(){return b("DOM").scry(this._form,"input","mentionsHiddenInput")[0]||this._textarea};f._saveConfig=function(){var a=this._getFormInput();this._defaultConfig={action:this._form.action,targetid:this._form.target.value,inputname:a.name,placeholder:this._placeholder?this._placeholder.textContent:this._textarea.placeholder,composertitle:this._composerTitle.textContent,pinplace:this._pinPlace,forceasync:this._forceAsync};this._defaultConfig.button_text_submit=this._submitButtonNodes[0].textContent};f._changeConfig=function(a){var b=this._getFormInput();this._form.action=a.action;this._form.target&&(this._form.target.value=a.targetid);this._setPlaceholder(a.placeholder);this._composerTitle.textContent=a.composertitle;this._pinPlace=a.pinplace;this._forceAsync=a.forceasync;b.name=a.inputname;this._showPostTypeSelectionFlow=a.showposttypeselector};f._extendComposerHeight=function(){this._composer.style.display!=="none"&&(this._staticTemplates.style.height=a.innerHeight+"px")};f.setPrivacySelector=function(a){this._privacySelector=a};f._getPrivacySelector=function(){return this._privacySelector&&b("MPrivacyComposerSelector").getInstance(this._privacySelector)};f._updateShareScraper=function(){__p&&__p();if(!this._shouldShowLinkPreview())return;if(b("MCompositionShareStore").get("LINK_NO_CHANGE"))return;var a=b("URLMatcher").permissiveMatch(this._getStatusText()),c=b("MCompositionShareStore").get("DISABLED_LINKS"),d=b("MCompositionShareStore").get("SHARE_URI");if(a!==d&&(!c||!c[a])){if(this._multiPhotoUploader){c=this._multiPhotoUploader.getUploader().component.getAttachmentCount();if(c===0)this._multiPhotoUploader.resetState();else return}if(a&&d&&d.indexOf(a)!=-1||!a)return;setTimeout(function(){b("MCompositionUserActions").shareLinkUpdate(a),b("MCompositionUserActions").configDisablePhotosUpdate(!!a)},0)}};f._updatePostType=function(a,c){__p&&__p();var d=this;this._postTypeInput.value=a;var e=null;if(a===2)this._isUnpublishedPost=!0,e=h._("Save");else if(a===0){this._isUnpublishedPost=!1;var f=b("MComposerDestinationPickerConfig").composer_sharesheet_visible?h._("Share"):h._("Post");e=c?h._("Backdate"):f}else a===1&&(this._isUnpublishedPost=!0,e=h._("Schedule"));if(e){c=b("DOM").scry(this._composer,"button","submit_composer");c.forEach(function(a){b("DOM").setContent(a,e),d._slideshowPreviewController&&d._slideshowPreviewController.setSubmitButtonText(e)})}};f._updateSchedulePostTime=function(a){__p&&__p();var c;this._schedulePostYear=(c=b("DOM")).find(this._form,"input","scheduled_post_year");this._schedulePostMonth=c.find(this._form,"input","scheduled_post_month");this._schedulePostDay=c.find(this._form,"input","scheduled_post_day");this._schedulePostHour=c.find(this._form,"input","scheduled_post_hour");this._schedulePostMinute=c.find(this._form,"input","scheduled_post_minute");this._schedulePostAMPM=c.find(this._form,"input","scheduled_post_ampm");this._schedulePostYear.value=a.year;this._schedulePostMonth.value=a.month;this._schedulePostDay.value=a.day;this._schedulePostHour.value=a.hour;this._schedulePostMinute.value=a.minute;this._schedulePostAMPM.value=a.ampm};f._updateBackdatedPostTime=function(a){this._backdatedPostYear=b("DOM").find(this._form,"input","backdated_post_year"),this._backdatedPostMonth=b("DOM").find(this._form,"input","backdated_post_month"),this._backdatedPostDay=b("DOM").find(this._form,"input","backdated_post_day"),this._backdatedPostYear.value=a.year,this._backdatedPostMonth.value=a.month,this._backdatedPostDay.value=a.day};f.setPhotoAction=function(a){a&&(this._attachPhoto=b("$")("attach_photo"),this._photoButton=b("DOM").find(this._form,"button","photo-button"));this._photoAction=a;return this};f.setKeyboardStateDown=function(){};f.setLongReviewTips=function(a){this._longReviewTips=a};f.setShortReviewsDisableDone=function(a){this._shortReviewsDisableDone=a};f.setSlideshowPreview=function(a){this._slideshowPreview=a,this._slideshowPreviewButton=b("DOM").find(this._composer,"button","show_slideshow_preview"),this._slideshowPreviewController=new(b("MStructuredComposerSlideshowPreview"))(this._slideshowPreview,this._slideshowPreviewButton)};f.setSlideshowNUX=function(a){this._slideshowNUX=a};f._determineFormAction=function(){this._hasPhotos()&&this._photoAction!==""?this._form.action=this._photoAction:this._form.action=b("MCompositionConfigStore").get("action")||this._defaultAction};f._determineMultiPhotoComposerState=function(){if(!this._multiPhotoUploader)return;this._photoButton&&b("CSS").conditionClass(this._photoButton,"active",this._hasPhotos());if(!this._getIsAlbumDisabled()){var a=b("MCompositionFormatStore").get("format_id",null);b("CSS").conditionShow(b("$")("album-button"),this._hasPhotos()&&a!=="slideshow");!this._hasPhotos()&&this._albumChosen&&this._resetAlbumSelection()}};f._showMultiPhotoUploader=function(){if(!this._multiPhotoUploader)return;this._determineMultiPhotoComposerState();this._multiPhotoUploader.alterPreviewGrid(!0);this._getIsSlideshowDisabled()||this._multiPhotoUploader.getUploader().setProps({showDropShadow:!1})};f._hasVideos=function(){return!1};f._hasPhotos=function(){if(this._multiPhotoUploader)return this._multiPhotoUploader.hasPhotos(!!this._backgroundUploadProgress);else if(!this._getIsAlbumDisabled())return this._hasPhoto;else return this._photoOpen&&this._hasPhoto};f._pagePostClicked=function(a){if(!a)return;a=b("MLegacyDataStore").get(a);this._changeConfig(a);this._privacySelector&&b("DOM").hide(this._privacySelector)};f.start=function(){__p&&__p();var a=this;this._form.addEventListener("reset",function(){if(a._submittingScreen)return;a._resetComposer()});this._listeners.push(b("Stratcom").listen("MComposer:entry:js",null,function(b){var c=b.getData();a._onComposerCancel=c.ON_CANCEL;a._onComposerSubmit=c.ON_SUBMIT;c.ON_OPEN==="photo"?a._navigateToComposerAndShowFileDialog(c):c.ON_OPEN==="checkin"?a._navigateToComposerAndCheckin(c,b):c.ON_OPEN==="activity"?a._navigateToComposerAndShowActivitySelector(c,b):c.ON_OPEN==="tag_friend"?a._navigateToComposerAndOpenFriendTagger(c,b):a._navigateToComposerAndFocus("status",c);a._changeSettingsAfterOpen();a._showPrivacyEducationOnComposerOpen()}));this._starsRatableInput&&(this._listeners.push(b("Stratcom").listen("MPagesStarsRatableBase-starsSet",null,this._updateSubmitButtonState.bind(this))),this._listeners.push(b("Stratcom").listen("MPagesStarsRatableBase-starTapped",null,function(a){b("BanzaiLogger").log("ReviewProductionLoggerConfig",{event:"composer_star_click",page_id:this._recommendationData.pageid,star_clicked:a.getData().rating,surface:this._getRecommendationSurface()})}.bind(this))));this._listen("click","show_composer",function(c){if(k&&k.listenersRegistered())return;c=c.getNode("show_composer");var d=b("MLegacyDataStore").get(c);d&&d.og_activity&&!d.og_activity.fbt_phrase&&(d.og_activity.fbt_phrase=a._ogTagger._getTagPhrase(d.og_activity.action_type,d.og_activity.icon,d.og_activity.object_str,d.og_activity.object_id,d.og_activity.location_str));a._navigateToComposerAndFocus("status",d);a._showPrivacyEducationOnComposerOpen();a._clickedButton=c});if(b("UserAgent").isBrowser("Mobile Safari < 8")){var c=!0;this._listen("click","cancel_composer",function(d){c?(c=!1,setTimeout(function(){b("MTouchClick").click(d.getTarget(),d)},0)):(c=!0,a._navigateAwayFromComposerAndCancel())})}else this._listen("click","cancel_composer",this._navigateAwayFromComposerAndCancel.bind(this));this._listen("click","submit_composer",this._pickDestination.bind(this));this._listen("click","forsale_intercept_nonforsale",this._confirmClicked.bind(this));this._listen("click","forsale_intercept_forsale",this._postForSale.bind(this));this._listen("m:viewport:scroll-to-header",null,this._extendComposerHeight.bind(this));this._listen("click","checkin_link",function(a){if(k&&k.listenersRegistered())return;this._clickedButton=a.getNode("checkin_link");this._navigateToComposerAndCheckin();a.prevent()}.bind(this));this._listeners.push(b("Stratcom").listen("MComposer:close:activity",null,function(){a._stayHiddenUntilOGTaggerCloses=!1,b("DOM").show(a._composer)}),b("Stratcom").listen("cancel","MComposer:dialog:place",function(){return a._navigateAwayFromComposerAndCancel()}),b("Stratcom").listen("close","MComposer:dialog:place",function(){b("DOM").show(a._composer)}));this._listeners.push(b("Stratcom").listen("MComposer:post:backdate",null,function(c){a._isBackdated=b("DOM").find(a._form,"input","is_backdated"),a._isBackdated.value=c.getData().value}));this._listeners.push(b("Stratcom").listen("MComposer:post:draft",null,function(b){b=b.getData();a._updatePostType(b.type,b.isBackdated)}));this._listeners.push(b("Stratcom").listen("MComposer:post:scheduled:time",null,function(b){b=b.getData();a._updateSchedulePostTime(b)}));this._listeners.push(b("Stratcom").listen("MComposer:post:backdated:time",null,function(b){b=b.getData();a._updateBackdatedPostTime(b)}));this._ogTagger&&(this._listen("click","activity_link",this._navigateToComposerAndShowActivitySelector.bind(this)),this._listen("click","og_included_place_checkin",function(a){this._ogTagger.hide(),this._startCheckin()}.bind(this)),this._listeners.push(this._ogTagger.listen("cancelFromActivity",this._navigateAwayFromComposerAndCancel.bind(this))));this._listeners.push(b("MCompositionConfigStore").addListener("change",function(){return a._handleConfigUpdate()}));this._listeners.push(b("MCompositionPhotoStore").addListener("change",function(){return a._handlePhotoUpdate()}));this._listeners.push(b("MCompositionStatusStore").addChangeListener(function(){return a._handleStatusUpdate()}));this._listeners.push(b("MCompositionFormatStore").addChangeListener(function(){return a._handleFormatUpdate()}));this._listeners.push(b("MCompositionSlideshowStore").addChangeListener(function(){return a._handleSlideshowUpdate()}));this._slideshowPreviewController&&(this._listen("change","slideshow-option",this._handleSlideshowToggleUpdate.bind(this)),this._listen("MStructuredComposerSlideshowPreview-submit",null,this._confirmClicked.bind(this)));this._listen("click","write_post_posts_by_others",function(a){this._pagePostClicked(a.getNode("write_post_posts_by_others")),a.prevent()}.bind(this));this._listen("composerPhotoLinkPostsByOthers",null,function(a){this._pagePostClicked(a.getData()),a.prevent()}.bind(this));this._listen("click","write_post_admin",function(a){this._pagePostClicked(a.getNode("write_post_admin")),a.prevent()}.bind(this));this._listen("click","page_checkin",function(a){var c=b("MLegacyDataStore").get(a.getNode("page_checkin"));this._isPageCheckin=!0;c.COMPOSITION||(c.COMPOSITION=new(b("MComposition"))().setStoreData("CONFIG",b("whitelistObjectKeys")(c,b("getObjectValues")(b("MCompositionConfigFields")))).setStoreData("PLACE",{id:c.pageid,name:c.pagename,new_place:!1}).serialize());this._photoAction&&(this._photoAction=new(i||(i=b("URI")))(this._photoAction).addQueryData("target",c.targetid).toString());this._navigateToComposer("checkin",c);this._ogTagger&&this._ogTagger.setPlaceID(c.pageid);a.prevent()}.bind(this));this._listeners.push(b("Stratcom").listen("MComposer-write-recommendation",null,function(a){this._writeRecommendation(a.getData().element)}.bind(this)));this._listen("click","write-recommendation",function(a){this._writeRecommendation(a.getNode("write-recommendation")),a.prevent()}.bind(this));this._listen("MStructuredComposerFriendsInput-done",null,function(){return a._updateTagExpansion()});this._listen("MStructuredComposerFriendsInput-addedAutoTags",null,function(){return a._updateTagExpansion()});this._listen("MStructuredComposerFriendsInput-addedManualXYTags",null,function(){return a._updateTagExpansion()});this._listen("MStructuredComposerFriendsInput-removedManualTags",null,function(){return a._updateTagExpansion()});this._listen("MStructuredComposerOGInput:update",null,function(){return a._updateTagExpansion()});this._listen("MMentions:change",null,function(b){b=b.getData();if(b.input!==a._textarea)return;a._hasMentions=b.hasTags;a._numMentions=b.numTags?b.numTags:0;a._updateTagExpansion()});this._listeners.push(b("MCompositionPlaceStore").addChangeListener(function(){if(b("MCompositionPlaceStore").isEmpty())return;if(a._ogTagger){var c=b("MCompositionPlaceStore").get("og_action_type_id",null),d=b("MCompositionPlaceStore").get("id"),e=b("MCompositionPlaceStore").get("suggestion_mechanism");a._ogTagger.setPlaceID(d);c&&!a._ogInputController.hasValue()&&(a._ogTagger.setCancelButtonText(h._("Skip")),a._ogTagger.selectActionTypeImplicitly(c)&&(b("DOM").hide(a._composer),a._stayHiddenUntilOGTaggerCloses=!0,a._ogTagger.setSuggestionMechanism(e),b("MarauderLogger").log("og_composer_implicit_verb_selected",void 0,{place_id:d,suggestion_mechanism:e}),b("Stratcom").invoke("MComposer:open:activity")))}}));this._listen("MAlbumPicker:createalbum:open",null,function(b){a._isCreateAlbumDialogOpen=!0});this._listen("MAlbumPicker:createalbum:close",null,function(b){a._isCreateAlbumDialogOpen=!1});this._listen("keydown","tokenizer-input",function(a){if(a.getNode("structured-composer")&&this.getShouldScroll()){a=a.getNode("tokenizer-input");a=b("Vector").getPos(a).y;b("MViewport").scrollTo(0,a)}}.bind(this));this._listen("blur","tokenizer-input",function(a){a.getNode("structured-composer")&&this.getShouldScroll()&&b("MViewport").scrollToHeader()}.bind(this));this._listen("keyup","composer-textarea",this._updateLongReviewTipText.bind(this));this._listeners.push(b("MCompositionStatusStore").addChangeListener(function(){return a._handleStatusUpdate()}));this._listen("click","photo_link",function(a){if(k&&k.listenersRegistered())return;var c=a.getNode("photo_link"),d=b("MLegacyDataStore").get(c);this.getShouldScroll()&&b("MViewport").scrollToHeader();this._multiPhotoUploader?(this._getIsAlbumDisabled()||b("DOM").show(b("$")("album-button")),this._navigateToComposerAndShowFileDialog(d,a)):(!this._getIsAlbumDisabled()?(this._navigateToComposerAndShowFileDialog(d,a),a.prevent()):(this._navigateToComposer("photo",d),this._photoOpen=!0,b("DOM").show(this._attachPhoto),b("CSS").conditionClass(this._photoButton,"active",!0)),this._clickedButton=c,a.kill(),b("Stratcom").invoke("composerPhotoLink"),b("Stratcom").invoke("composerPhotoLinkPostsByOthers",null,a.getNode("write_post_posts_by_others")))}.bind(this));this._listen("click","add-photo-thumbnail",function(a){b("MComposerLogger").log("intent_media"),b("MTouchClick").click(b("$")("photo_input"),a),a.prevent()});this._listen("click","photo-button",function(c){b("MComposerLogger").log("intent_media"),a._multiPhotoUploader?(a._closePrivacy(),b("MTouchClick").click(b("$")("photo_input"),c),a._determineFormAction(),a._showMultiPhotoUploader()):!a._getIsAlbumDisabled()?(b("MTouchClick").click(b("$")("photo_input"),c),c.prevent()):(a._closePrivacy(),a._photoOpen?b("DOM").hide(a._attachPhoto):b("DOM").show(a._attachPhoto),a._photoOpen=!a._photoOpen,b("CSS").conditionClass(a._photoButton,"active",a._photoOpen))});this._listen("click","video-button",function(c){b("MComposerLogger").log("intent_media"),a._multiPhotoUploader&&(a._closePrivacy(),b("MTouchClick").click(b("$")("video_input"),c),a._determineFormAction(),a._showMultiPhotoUploader())});this._getIsAlbumDisabled()||(this._listeners.push(this._albumPicker.listen("cancel",function(a){b("MComposerLogger").log("cancel_album"),this._restoreComposer()}.bind(this))),this._listeners.push(this._albumPicker.listen("choose-album",function(a){a.is_mobile_uploads_album?this._resetAlbumSelection():(b("Stratcom").invoke("MStructuredComposer-selectAlbum"),b("MComposerLogger").log("add_album"),b("$")("album_fbid").value=a.album_id,b("$")("album_privacy").value=a.privacy_id,this._albumChosen=!0,this._closePrivacy(),this._privacySelector&&b("DOM").hide(this._privacySelector)),b("DOM").show(this._composer)}.bind(this))),this._listen("click","album-button",function(a){b("MComposerLogger").log("intent_album"),this._albumPicker.show(),b("DOM").hide(this._composer)}.bind(this)));this._listen("MMultiPhotoUploader:attachments:add",null,function(a){b("MCompositionConfigStore").isEmpty()||b("MComposerLogger").log("add_photo",a.getData())});this._listen("MMultiPhotoUploader:attachments:remove",null,function(a){b("MCompositionConfigStore").isEmpty()||b("MComposerLogger").log("remove_photo",a.getData())});this._listen("change","photo-input",function(a){var c;a=b("$")("photo_input");a.value!==""&&this._photoAction!==""?(this._multiPhotoUploader||(c={photo_count:1},b("Stratcom").invoke("MStructuredComposer-addedPhoto",null,c)),a.name="file1",this._hasPhoto=!0,this._determineFormAction(),this._photoButton&&b("CSS").conditionClass(this._photoButton,"active",!0),this._getIsAlbumDisabled()||(this._multiPhotoUploader||b("DOM").show(b("$")("photo_display")),b("DOM").show(b("$")("album-button")))):(this._hasPhoto=!1,this._determineFormAction(),b("CSS").conditionClass(this._photoButton,"active",!1),this._multiPhotoUploader||(c={photo_count:0},b("Stratcom").invoke("MStructuredComposer-addedPhoto",null,c)),!this._getIsAlbumDisabled()&&!this._multiPhotoUploader&&this._removeAlbumAndPhoto())}.bind(this));this._listen("multi-photos-attachment-change",null,function(a){__p&&__p();a=a.getData();if(this._multiPhotoUploader.getUploader().component!==a.multiPhotoUploader)return;a=a.attachments;var c=b("MCompositionPhotoStore").get("photo_info_list",[]);if(!(j||(j=b("areEqual")))(a,c)){c={};c.photo_info_list=a;b("MCompositionUserActions").photoUpdate(c)}}.bind(this));this._listen("multi-photos-change",null,function(a){if(a.getData().input_id!="photo_input")return;a=this._multiPhotoUploader.getUploadedMediaCount();var c={photo_count:a,is_multi_photo_upload:!0};b("Stratcom").invoke("MStructuredComposer-addedPhoto",null,c);this._photosPreviewNux&&(a>0?(this._multiPhotoUploader.getUploader().setProps({showDropShadow:!1}),b("DOM").show(this._photosPreviewNux)):(this._multiPhotoUploader.getUploader().setProps({showDropShadow:!0}),b("DOM").hide(this._photosPreviewNux)));this._determineFormAction();this._determineMultiPhotoComposerState()}.bind(this));this._listen("click","composer-buttons",function(a){this._textarea.blur()}.bind(this));this._listen("focus","composer-textarea",function(a){this.getShouldScroll()&&(this._getStatusText()===""&&b("MInputFocus").scrollTo(this._textarea,b("MViewport").getHeaderTop()))}.bind(this));this._listen("click","composer-textarea",function(a){this._closePrivacy(),this.getShouldScroll()&&(this._getStatusText()===""&&b("MInputFocus").scrollTo(this._textarea,b("MViewport").getHeaderTop()))}.bind(this));this._listen(["m:page:loading"],null,this.cleanup.bind(this));this._listen("audience-x-opened",null,function(a){b("DOM").hide(this._composer)}.bind(this));this._listen("MMultiPhotoUploader:attachments:change",null,function(b){b=b.getData();a._photosUploading=b.sending+b.polling!==0;a._updateSubmitButtonState()});this._listen("MWebActivityUploader:received:share",null,this._navigateToComposer.bind(this,"photo"));(this._photoPreview||this._photosPreviewConfig)&&this._listen("click","structured-composer-photo-preview-done",this._hidePhotoPreviews.bind(this));b("Stratcom").invoke("MStructuredComposer:start");if(b("MComposerDestinationPickerConfig").composer_sharesheet_visible){var d;(d=b("Stratcom")).listen("composer:destination-picker:toggle",null,function(b){return a._toggleShareSelections(b)});d.listen("click","display_destination_picker",this._composerHasContent);d.listen("MStructuredComposerSATP:changed",null,function(b){return a._setTextFormatPresetId(b.getData())});d.listen("composer:destination-picker:link-preview-changed",null,function(b){return a._isExternalLinkPreview=!b.getData().isPreviewValid})}b("MComposerPresence").register(this);return this};f._cancelComposer=function(){this._staticTemplates.style.height="",b("Stratcom").invoke("MStructuredComposer-canceled",null),b("MComposerLogger").log("composer_cancel",{maximum_character_count:b("MCompositionStatusStore").get("LONGEST_LENGTH"),loaded_time:b("MCompositionConfigStore").get("opened_at"),publish_target:this._form.target.value||b("CurrentUser").getID()||-1,remaining_character_count:this._getStatusText().length}),this._hasPhotos(),this._resetComposer()};f.cleanup=function(){b("Stratcom").invoke("MStructuredComposer:cleanup");b("Stratcom").invoke("MCustomPrivacy::removeListener");this._closeComposer();this._form.removeEventListener("reset",this._resetComposer,!1);for(var a=0;a<this._listeners.length;a++)this._listeners[a].remove();this._listeners=[];b("MComposerPresence").unregister(this)};f._listen=function(a,c,d){this._listeners.push(b("Stratcom").listen(a,c,d))};f._isAudience=function(a){__p&&__p();var c=b("DOM").scry(this._buttonbar,"table","privacy-table")[0];if(!c){var d=this._getSavedCustomHiddenInput();return d?d.value==a:!1}d=b("DOM").scry(c,"tr","privacy-option checked")[0];if(!d)return!1;c=b("MLegacyDataStore").get(d);return c.value==a};f.setInAudienceAlignmentExp=function(a){this._inAudienceAlignmentPublicExp=a};f.setInAudienceAlignmentOnlyMeExp=function(a){this._inAudienceAlignmentOnlyMeExp=a};f.setAudienceAlignmentFlyout=function(a){this._audienceAlignmentFlyout=a};f._composerEligibleForInterstitial=function(a){__p&&__p();var c=this._form.target.value;if(c&&c!=b("CurrentUser").getID())return!1;if(this._composerType!=="status")return!1;if(!this._isAudience(a))return!1;if(b("MViewport").getScreenHeight()<340&&b("MJSEnvironment").IS_ANDROID){this._audienceAlignmentFlyout.deviceTooShort();return!1}return!0};f.setIsInMSitePagesSharingHoldout=function(a){this._isInMSitePagesSharingHoldout=a};f.setStickyGuardrailFlyout=function(a){this._showStickyGuardrailFlyout=a};f.setSharePreview=function(a){this._sharePreview=a};f.setShowLoadingIndicator=function(a){this._showLoadingIndicator=a};f.setCanRemoveActorVc=function(a){this._canRemoveActorVC=a};f.setWasAsyncLoadedWithPlaceholderComposer=function(){this._composerAsyncLoaderRoot=b("ge")("composer-async-loader-root");if(!this._composerAsyncLoaderRoot)return;this._wasLoadedWithAsyncPlaceholderComposer=!0;this._submittingScreen=b("DOM").find(this._composerAsyncLoaderRoot,"div","composer-submitting")};f.copyPlaceholderComposerFormTextAndFocus=function(a){var c=b("DOM").scry(this._composerAsyncLoaderRoot,"form","composer-placeholder-form"),d=b("DOM").scry(this._composerAsyncLoaderRoot,"textarea","composer-placeholder-textarea"),e=!1;d.length>0&&(d[0].value.length>0&&this._setCompositionDataStatusText(a,d[0].value),e=d[0]===b("getActiveElement")());c.length>0&&b("DOM").remove(c[0]);b("DOM").show(this._composer);e&&this._textarea.focus()};f.captureFriendsPrivacyRow=function(){this._friendsPrivacyRow=this._getPrivacyRow("value",b("PrivacyConst").PostParam.FRIENDS),this._friendsPrivacyRow||this.closeInterstitial(this._postInterstitialTooltipText[0]),this._waitingForFriendsRow&&this._handleInterstitialFriends()};f.capturePublicPrivacyRow=function(){var a=this._getSavedCustomHiddenInput();if(a){a=b("XInlineComposerAudienceEducationController").getURIBuilder().setString("new_post_param",b("PrivacyConst").PostParam.EVERYONE.toString()).setBool("update_icon",!0).getURI();new(b("MRequest"))(a).send()}else this._publicPrivacyRow=this._getPrivacyRow("value",b("PrivacyConst").PostParam.EVERYONE),b("Stratcom").invoke("MPrivacyComposerMenu:updatePrivacy",null,{row:this._publicPrivacyRow})};f._getPrivacyRow=function(a,c){var d=b("DOM").scry(this._buttonbar,"table","privacy-table")[0];if(!d)return null;for(var e=0;e<d.rows.length;e++){var f=d.rows[e],g=b("MLegacyDataStore").get(f);if(g[a]==c)return f}return null};f._hideForInterstitial=function(){b("DOM").hide(this._composer),this._textarea.blur()};f._closeComposer=function(){this._textarea.blur(),b("DOM").hide(this._composer),b("DOM").show(this._mainPage)};f._toggleSubmitButtonState=function(a){this._submitButtonNodes.forEach(function(b){b.disabled=!a}),this._forsaleInterceptForsale&&(this._forsaleInterceptForsale.disabled=!a,this._forsaleInterceptNonForsale.disabled=!a),this._slideshowPreviewButton&&(this._slideshowPreviewButton.disabled=!a)};f._toggleCancelButtonHidden=function(a){var c=b("DOM").find(this._composer,"button","cancel_composer");c=c.parentElement;a?b("DOM").hide(c):b("DOM").show(c)};f._toggleSubmitButtonHidden=function(a){this._submitButtonNodes.forEach(function(c){b("CSS").conditionShow(c,!a)})};f._restoreComposerWithoutFocus=function(){var a;b("Stratcom").invoke("MMentions:decorations:show",null,{});(a=b("DOM")).hide(this._mainPage);a.show(this._composer);a.show(this._textarea);a.show(this._buttonbar)};f._skipFocus=function(){return b("MCompositionConfigStore").get("skip_focus")};f._restoreComposer=function(){this._restoreComposerWithoutFocus(),this._focusOnTextarea()};f._incrementPhotosPreviewNuxCounter=function(){new(b("MRequest"))(b("XPhotosIncrementThumbnailPreviewNUXImpressionsController").getURIBuilder().getURI()).send()};f._onUploadSuccess=function(a){var c=b("gkx")("814423");if(!c)return;c=this._multiPhotoUploader.getUploader().component.getAttachment(a);c&&c.id===this._previewedAttachmentId&&(this._hidePhotoPreviews(),this._showPhotosPreview(c))};f._showPhotosPreview=function(a){if(!this._photoPreview)return;if(a.state===b("MMultiPhotoUploaderAttachmentState").UPLOADED)this._photosPreviewNux&&this._incrementPhotosPreviewNuxCounter(),this._previewedAttachmentId=a.id,b("DOM").hide(this._composer),this._photoPreview.show(a.previewURI,this._tagSuggestionsController.getFaceboxesCopyForPhoto(a.fbid));else{var c=b("gkx")("814423");c&&(this._previewedAttachmentId=a.id,b("DOM").hide(this._composer),this._photoPreview.show(a.fileImageURI))}};f._hidePhotoPreviews=function(){if(!this._photoPreview)return;this._previewedAttachmentId=-1;b("DOM").show(this._composer);this._photoPreview.hide()};f._updateTagExpansion=function(){var a=this._friendsInputController.hasTokens()||this._hasMentions,b=this._getPrivacySelector();b&&b.setShowTagExpansion(a)};f._startCheckin=function(){b("Stratcom").invoke("open","MComposer:dialog:place")};f._registerPhotoPreviewEvents=function(){var a=this._multiPhotoUploader.getUploader();a.setProps({onThumbnailClicked:this._showPhotosPreview.bind(this)});this._photoPreview.setOnAddXYTag(this._tagSuggestionsController.addXYTag.bind(this._tagSuggestionsController));this._photoPreview.setOnDeleteXYTag(this._tagSuggestionsController.deleteXYTag.bind(this._tagSuggestionsController));this._photoPreview.setWaterfall(a.component.getWaterfallID(),a.component.getWaterfallAppName(),a.component.getWaterfallSource())};f._initPhotoPreview=function(){this._multiPhotoUploader&&this._tagSuggestionsController&&this._photosPreviewConfig&&!this._photoPreview&&(this._photoPreview=new(b("MStructuredComposerPhotoPreviewBootloader"))(this._photosPreviewConfig),this._registerPhotoPreviewEvents())};return e}(b("mixin")(b("MComposerNavigationMixin")));b("createDeprecatedProperties")(d,{scrollToElem:null,showPlace:!0,shouldScroll:!0,syncSubmit:!1,eventTaggingNuxHref:null});Object.assign(d.prototype,{_defaultAction:null,_defaultConfig:null,_photoAction:null,_photoOpen:!1,_hasPhoto:!1,_albumChosen:!1,_onlyMeFlyoutShown:!1,_prefill:null,_forceAsync:!1,_isCheckin:!1,_isUnpublishedPost:!1,_isPageCheckin:!1,_pinPlace:!1,_albumPicker:null,_EventTaggingNuxDisplayed:!1,_ogTagger:null,_textarea:null,_attachPhoto:null,_clickedButton:null,_composer:null,_composerTitle:null,_contextualMessage:null,_form:null,_mainPage:null,_photoButton:null,_staticTemplates:null,_ogTaggerLoaded:!1,_slideshowNUX:null,_listeners:null,_canRemoveActorVC:!0});function o(a){if(!a)return"";a=a.trim();a=a.replace(/\n{3,}/,"\n\n");a=a.replace(/\t+/," ");return a}e.exports=d}),null);
__d("InitMStructuredComposer",["DOM","MAlbumPicker","MLegacyDataStore","MOpenGraphTagger","MStructuredComposer","Stratcom","$"],(function(a,b,c,d,e,f){__p&&__p();function a(a){__p&&__p();c=a.friends_tagger;var d=b("$")(a.open_id),e=b("MLegacyDataStore").get(d),f=e._friendsTagger||c.fromID(a.friends_tagger_id),g=null;a.album_picker_id&&(g=e._albumPicker||new(b("MAlbumPicker"))(b("$")(a.album_picker_id)));var h;a.og_tagger_id&&(h=new(b("MOpenGraphTagger"))(b("$")(a.og_tagger_id)));e=new(b("MStructuredComposer"))(d,f,null,g,h,a.multi_photo_uploader,a.page_info,a.create_label,a.update_label,a.composer_target_type,a.composer_entry_point,a.friends_input,null,a.og_clearable_preview,a.should_show_tag_suggestions,a.should_auto_tag,a.photos_preview_config,a.photos_preview_nux);e.setIsInMSitePagesSharingHoldout(!!a.isInMSitePagesSharingHoldout);e.setDefaultHideConfig&&e.setDefaultHideConfig(a.hide_config||{});a.privacy_selector_rewrite_id&&e.setPrivacySelector(b("$")(a.privacy_selector_rewrite_id));b("MLegacyDataStore").set(d,{composer:e});a.scroll_to_elem_id&&e.setScrollToElem(a.scroll_to_elem_id);e.setSyncSubmit(a.syncsubmit);e.setShowPlace(a.showplace);e.setShouldScroll(a.shouldscroll);e.setLongReviewTips(a.long_review_tips);e.setShortReviewsDisableDone(a.short_reviews_disable_done);e.setCanRemoveActorVc(a.can_remove_actor_vc);e.setSlideshowNUX(a.slideshow_nux);a.slideshow_preview_id&&e.setSlideshowPreview(b("$")(a.slideshow_preview_id));a.was_loaded_with_placeholder_composer&&e.setWasAsyncLoadedWithPlaceholderComposer(a.was_loaded_with_placeholder_composer);e.start();a.photouploaduri&&e.setPhotoAction(a.photouploaduri);e.setInAudienceAlignmentExp(a.in_aaa_exp);e.setInAudienceAlignmentOnlyMeExp(a.in_aaa_onlyme_exp);e.setAudienceAlignmentFlyout(a.aaa_flyout);a.show_sticky_guardrail_flyout&&e.setStickyGuardrailFlyout(a.show_sticky_guardrail_flyout);e.setSharePreview(a.share_preview);e.setShowLoadingIndicator(a.show_loading_indicator);b("Stratcom").listen("MPrivacyComposerMenu::custom",null,function(c){c.getData().selector.parentNode.id==a.privacy_selector_rewrite_id&&(c.getData().visible?b("DOM").hide(b("$")("structured_composer")):(b("DOM").hide(b("$")("viewport")),b("DOM").show(b("$")("structured_composer"))))});b("Stratcom").invoke("InitMStructuredComposer:composer-initialized")}f.main=a}),null);
__d("MStructuredComposerFriendsInputReact",["BanzaiODS","CSS","DOM","MComposerLogger","MComposerNavigationMixin","MCompositionUserActions","MCompositionWithStore","MSubscriptionsHandlerMixin","MTokenCollection.react","MTokenRenderer.react","MUnifiedTaggerConstants","React","ReactDOM","Stratcom","TokenCollection","mixin","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f){__p&&__p();var g="mtouch_composer_facerec_suggestions",h=b("MUnifiedTaggerConstants").SHOW_UNIFIED_TAGGER;a=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(c,d,e){__p&&__p();var f;f=a.call(this)||this;f.$MStructuredComposerFriendsInputReact1=c;f.$MStructuredComposerFriendsInputReact2=d;f.$MStructuredComposerFriendsInputReact3=new(b("TokenCollection"))();f.$MStructuredComposerFriendsInputReact4=b("ReactDOM").render(b("React").createElement(b("MTokenCollection.react"),{onClick:f.$MStructuredComposerFriendsInputReact5.bind(babelHelpers.assertThisInitialized(f)),onRemove:f.$MStructuredComposerFriendsInputReact6.bind(babelHelpers.assertThisInitialized(f)),renderer:b("MTokenRenderer.react"),collection:f.$MStructuredComposerFriendsInputReact3,collectionKey:"users_with"}),b("DOM").find(d,"ul","friend-tokens"));f.$MStructuredComposerFriendsInputReact7=e;f.$MStructuredComposerFriendsInputReact8=e.style.display;f.$MStructuredComposerFriendsInputReact9={};h&&f.addSubscriptions(b("Stratcom").listen("MComposer:tagger:click",b("MUnifiedTaggerConstants").TOKEN_TYPES.PEOPLE,function(){return f.$MStructuredComposerFriendsInputReact5()}));f.addSubscriptions(b("Stratcom").listen("click","inline-with-button",function(){b("setTimeoutAcrossTransitions")(function(){f.$MStructuredComposerFriendsInputReact5()},10)}),b("Stratcom").listen("MComposer:tagger:open",null,function(){return f.$MStructuredComposerFriendsInputReact5()}));f.addSubscriptions(b("DOM").listen(f.$MStructuredComposerFriendsInputReact7,"click",null,function(){return f.$MStructuredComposerFriendsInputReact5()}),f.$MStructuredComposerFriendsInputReact1.listen("cancel",function(){f.currentNavigationPolicy().addOnClose(function(){return f.$MStructuredComposerFriendsInputReact10()}).close()}),f.$MStructuredComposerFriendsInputReact1.listen("submit",function(a){f.currentNavigationPolicy().addOnClose(function(){var c={};c.TOKENS=a.tokens;b("MCompositionUserActions").withUpdate(c);b("MComposerLogger").log("add_friend_tag",{num_tags:a.tokens.length});f.$MStructuredComposerFriendsInputReact11(a.tokens.length)}).close()}),b("MCompositionWithStore").addChangeListener(function(){return f.$MStructuredComposerFriendsInputReact12()}));return f}var d=c.prototype;d.$MStructuredComposerFriendsInputReact12=function(){var a=b("MCompositionWithStore").get("TOKENS",[]);a!==this.$MStructuredComposerFriendsInputReact3.entries&&(this.$MStructuredComposerFriendsInputReact3.entries=a,this.$MStructuredComposerFriendsInputReact13(),this.$MStructuredComposerFriendsInputReact4.forceUpdate(),this.$MStructuredComposerFriendsInputReact14(),this.$MStructuredComposerFriendsInputReact11(),this.$MStructuredComposerFriendsInputReact15())};d.$MStructuredComposerFriendsInputReact15=function(){this.$MStructuredComposerFriendsInputReact16&&this.$MStructuredComposerFriendsInputReact16(this.$MStructuredComposerFriendsInputReact3.entries.slice())};d.$MStructuredComposerFriendsInputReact13=function(){h&&b("Stratcom").invoke("MComposer:tagger:update",null,{people:this.$MStructuredComposerFriendsInputReact3.entries})};d.$MStructuredComposerFriendsInputReact17=function(a){var b=!this.$MStructuredComposerFriendsInputReact3.hasEntry(a);b&&(this.$MStructuredComposerFriendsInputReact3.addEntry(a),this.$MStructuredComposerFriendsInputReact13(),this.$MStructuredComposerFriendsInputReact14(),this.$MStructuredComposerFriendsInputReact4.forceUpdate());return b};d.addManualXYTag=function(a){this.$MStructuredComposerFriendsInputReact17(a)&&this.$MStructuredComposerFriendsInputReact18(),this.$MStructuredComposerFriendsInputReact15()};d.addAutoToken=function(a){this.$MStructuredComposerFriendsInputReact9[a.id]||this.$MStructuredComposerFriendsInputReact17(a)&&(this.$MStructuredComposerFriendsInputReact19(),b("BanzaiODS").bumpEntityKey(2966,g,"add_auto_tag"))};d.onRemove=function(a){this.$MStructuredComposerFriendsInputReact3.removeEntry(a),this.$MStructuredComposerFriendsInputReact14(),this.$MStructuredComposerFriendsInputReact13(),this.$MStructuredComposerFriendsInputReact4.forceUpdate(),this.$MStructuredComposerFriendsInputReact15()};d.$MStructuredComposerFriendsInputReact6=function(a){this.$MStructuredComposerFriendsInputReact9[a.id]=!0,this.onRemove(a),a.autoTag&&b("BanzaiODS").bumpEntityKey(2966,g,"remove_auto_tag"),this.$MStructuredComposerFriendsInputReact20()};d.$MStructuredComposerFriendsInputReact14=function(){var a=this.$MStructuredComposerFriendsInputReact3.entries.length>0;h||b("CSS").conditionShow(this.$MStructuredComposerFriendsInputReact2,a);b("CSS").conditionClass(this.$MStructuredComposerFriendsInputReact7,"active",a)};d.$MStructuredComposerFriendsInputReact5=function(){var a=this;this.newNavigationPolicy().addOnOpen(function(){b("MComposerLogger").log("intent_friend_tag"),a.$MStructuredComposerFriendsInputReact1.setEntries(a.$MStructuredComposerFriendsInputReact3.entries.slice()),setTimeout(a.$MStructuredComposerFriendsInputReact1.show.bind(a.$MStructuredComposerFriendsInputReact1))}).addOnCloseByBrowser(function(){a.$MStructuredComposerFriendsInputReact1.hide(),a.$MStructuredComposerFriendsInputReact10()}).open()};d.$MStructuredComposerFriendsInputReact11=function(a){b("Stratcom").invoke("MStructuredComposerFriendsInput-done",null,{num_tags:a})};d.$MStructuredComposerFriendsInputReact19=function(){b("Stratcom").invoke("MStructuredComposerFriendsInput-addedAutoTags",null,{})};d.$MStructuredComposerFriendsInputReact18=function(){b("Stratcom").invoke("MStructuredComposerFriendsInput-addedManualXYTags",null,{})};d.$MStructuredComposerFriendsInputReact20=function(){b("Stratcom").invoke("MStructuredComposerFriendsInput-removedManualTags",null,{})};d.$MStructuredComposerFriendsInputReact10=function(){var a=this.getTokenCount();b("Stratcom").invoke("MStructuredComposerFriendsInput-done",null,{cancel:!0,num_tags:a});b("MComposerLogger").log("cancel_friend_tag",{num_tags:a})};d.reset=function(){this.$MStructuredComposerFriendsInputReact4.entries=[],h||b("DOM").hide(this.$MStructuredComposerFriendsInputReact2),this.$MStructuredComposerFriendsInputReact3.entries=[],this.$MStructuredComposerFriendsInputReact9={},this.$MStructuredComposerFriendsInputReact1.clear(),this.$MStructuredComposerFriendsInputReact4.forceUpdate(),b("CSS").conditionClass(this.$MStructuredComposerFriendsInputReact7,"active",!1),this.$MStructuredComposerFriendsInputReact1.hide()};d.getTokenCount=function(){return this.$MStructuredComposerFriendsInputReact3.entries.length};d.hasTokens=function(){return this.getTokenCount()>0};d.setVisible=function(a){b("CSS").conditionShow(this.$MStructuredComposerFriendsInputReact7,a)};d.setOnEntriesChangedHandler=function(a){this.$MStructuredComposerFriendsInputReact16=a};d.getEntries=function(){return this.$MStructuredComposerFriendsInputReact3.entries};return c}(b("mixin")(b("MComposerNavigationMixin"),b("MSubscriptionsHandlerMixin")));e.exports=a}),null);
__d("MStructuredComposerSATP",["CSS","DOM","EventListener","Keys","MCompositionShareStore","Stratcom","Style"],(function(a,b,c,d,e,f){__p&&__p();e.exports={init:function(a){__p&&__p();var c=this;this.clearStylePropertyNames={};this.textAreaContainer=a.textArea;this.satpChooser=a.satpChooser;this.hiddenInput=a.hiddenInput;this.satpHidden=!1;var d=b("DOM").find(this.textAreaContainer,"textarea","composer-textarea");this.textArea=d;this.textAreaPlaceholder=b("DOM").scry(this.textAreaContainer,"div","js_placeholder")[0];this.newlinesLimit=a.newlinesLimit;this.textLengthLimit=a.textLengthLimit;this.presetApplied=!1;this.checkinActive=!1;this.linkShareActive=!1;b("EventListener").listen(d,"input",function(){c._recalcSATPVisibility()});(a=b("Stratcom")).listen("MMultiPhotoUploader:attachments:change",null,function(a){c.photoCount=(a.getData().sending||0)+(a.getData().uploaded||0)+(a.getData().polling||0),c._recalcSATPVisibility()});a.listen("m:quicksearch:places:click",null,function(a){c.checkinActive=!0,c._recalcSATPVisibility()});a.listen("m:quicksearch:places:clear",null,function(a){c.checkinActive=!1,c._recalcSATPVisibility()});b("MCompositionShareStore").addListener("change",function(){c.linkShareActive=b("MCompositionShareStore").get("SHARE_URI")!==null,c._recalcSATPVisibility()});a.listen("MStructuredComposer:reset",null,function(){c.activePreset=null,c.checkinActive=!1,c.linkShareActive=!1,c.photoCount=0,c._clearPreset()})},initPreset:function(a){var c=this;b("EventListener").listen(a.element,"click",function(){c._applyPreset(a.preset)});b("EventListener").listen(a.element,"keyup",function(d){(d.keyCode===b("Keys").SPACE||d.keyCode===b("Keys").RETURN)&&c._applyPreset(a.preset)})},initClearPreset:function(a){var c=this;this.clearStylePropertyNames=a.clearStylePropertyNames;b("EventListener").listen(a.element,"click",function(){c.activePreset=null,c._clearPreset()});b("EventListener").listen(a.element,"keyup",function(a){(a.keyCode===b("Keys").SPACE||a.keyCode===b("Keys").RETURN)&&(c.activePreset=null,c._clearPreset())})},_clearPreset:function(){if(!this.presetApplied)return;this.hiddenInput.value="";this.presetApplied=!1;b("Style").apply(this.textAreaContainer,this.clearStylePropertyNames);b("CSS").removeClass(this.textAreaContainer,"active-satp-preset");b("Style").apply(this.textArea,this.clearStylePropertyNames);this.textAreaPlaceholder!==void 0&&b("Style").apply(this.textAreaPlaceholder,this.clearStylePropertyNames);b("Stratcom").invoke("MStructuredComposerSATP:changed",null,null)},_recalcSATPVisibility:function(){__p&&__p();var a=this.photoCount||0;if(a>0||this.checkinActive||this.linkShareActive){this._hideSATP();return}a=this.textArea.value;var b=a.split("\n",this.newlinesLimit+2);if(b.length-1>this.newlinesLimit||Array.from(a).length>this.textLengthLimit){this._hideSATP();return}this._showSATP()},_showSATP:function(){this.satpHidden&&(this.satpHidden=!1,this.satpChooser.style.display="block",this.activePreset&&this._applyPreset(this.activePreset))},_hideSATP:function(){this.satpHidden||(this.satpHidden=!0,this.satpChooser.style.display="none",this._clearPreset())},_applyPreset:function(a){this._clearPreset(),this.presetApplied=!0,this.hiddenInput.value=a.presetID,this.activePreset=a,this._applyStyle(this.textAreaContainer,this.activePreset.bodyStyle),this._applyStyle(this.textArea,this.activePreset.textInputStyle+";height: 208px;"),b("CSS").addClass(this.textAreaContainer,"active-satp-preset"),this.textAreaPlaceholder!==void 0&&this._applyStyle(this.textAreaPlaceholder,this.activePreset.textInputStyle),b("Stratcom").invoke("MStructuredComposerSATP:changed",null,this.activePreset)},_applyStyle:function(a,b){a.style.cssText+=";"+b}}}),null);
__d("MTokenizerParagraphRoot.react",["cx","React"],(function(a,b,c,d,e,f,g){__p&&__p();a=b("React").PropTypes;c=function(a){"use strict";babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.render=function(){return b("React").createElement("div",{className:"_5hd3"},"\u2014",this.props.showSpace?" ":"",this.props.children)};return c}(b("React").Component);c.propTypes={showSpace:a.bool};c.defaultProps={showSpace:!0};e.exports=c}),null);
__d("MTokenizerParagraphToken.react",["cx","MTouchableArea.react","React","joinClasses"],(function(a,b,c,d,e,f,g){__p&&__p();a=b("React").PropTypes;var h={use:{token:"mToken _4tk2",noborder:"mToken _4tk2 _3a7k"}};c=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){var b,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return(b=c=a.call.apply(a,[this].concat(e))||this,c.getClassListForAttribute=function(a){return h[a][c.props[a]]},b)||babelHelpers.assertThisInitialized(c)}var d=c.prototype;d.render=function(){return b("React").createElement(b("MTouchableArea.react"),null,b("React").createElement("span",babelHelpers["extends"]({},this.props,{className:b("joinClasses")(this.props.className,this.getClassListForAttribute("use"))}),b("React").createElement("span",{className:"_4tk0"},this.props.children)))};return c}(b("React").Component);c.propTypes={use:a.oneOf(["token","noborder"])};c.defaultProps={use:"token"};e.exports=c}),null);
__d("MTokenizerParagraphAtPlace.react",["fbt","MTokenizerParagraphRoot.react","MTokenizerParagraphToken.react","MUnifiedTaggerConstants","React"],(function(a,b,c,d,e,f,g){__p&&__p();var h=b("MUnifiedTaggerConstants").TOKEN_TYPES;a=b("React").PropTypes;c=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){var c,d;for(var e=arguments.length,f=new Array(e),i=0;i<e;i++)f[i]=arguments[i];return(c=d=a.call.apply(a,[this].concat(f))||this,d.renderNonSpecificPlace=function(){return b("React").createElement(b("MTokenizerParagraphRoot.react"),null,g._("in {city-name}.",[g._param("city-name",d.renderPlaceToken())]))},d.renderPlaceToken=function(){return b("React").createElement(b("MTokenizerParagraphToken.react"),{onClick:d.props.onTokenClick.bind(null,h.PLACE)},d.props.place.name)},d.renderSpecificPlace=function(){return b("React").createElement(b("MTokenizerParagraphRoot.react"),null,g._("at {place-name}",[g._param("place-name",d.renderPlaceToken())]))},c)||babelHelpers.assertThisInitialized(d)}var d=c.prototype;d.render=function(){return this.props.place.isNonSpecific?this.renderNonSpecificPlace():this.renderSpecificPlace()};return c}(b("React").Component);c.propTypes={onTokenClick:a.func.isRequired,place:a.object.isRequired};e.exports=c}),null);
__d("MTokenizerParagraphTokenList.react",["fbt","invariant","MTokenizerParagraphToken.react","React","intlList"],(function(a,b,c,d,e,f,g,h){__p&&__p();a=b("React").PropTypes;c=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.render=function(){var a=this.props.names.length;a=a===2?this.props.names[1]:g._("{count} others",[g._param("count",a-1)]);a=[b("React").createElement(b("MTokenizerParagraphToken.react"),null,this.props.names[0]),b("React").createElement(b("MTokenizerParagraphToken.react"),null,a)];return b("React").createElement("span",{onClick:this.props.onClick,role:"presentation"},b("intlList")(a,b("intlList").CONJUNCTIONS.AND))};return c}(b("React").Component);c.propTypes={onClick:a.func,names:function(a,b,c){var d=Array.isArray(a[b]);d&&a[b].length>1||h(0,5066,b,d?"array":typeof a[b],a[b]?a[b].length:a[b],c)}};e.exports=c}),null);
__d("MTokenizerParagraphWithMultiplePeople.react",["fbt","MTokenizerParagraphRoot.react","MTokenizerParagraphTokenList.react","MUnifiedTaggerConstants","React"],(function(a,b,c,d,e,f,g){__p&&__p();var h=b("MUnifiedTaggerConstants").TOKEN_TYPES;a=b("React").PropTypes;c=function(a){"use strict";babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.render=function(){return b("React").createElement(b("MTokenizerParagraphRoot.react"),null,g._("with {list-of-people}.",[g._param("list-of-people",b("React").createElement(b("MTokenizerParagraphTokenList.react"),{onClick:this.props.onTokenClick.bind(null,h.PEOPLE),names:this.props.people.map(function(a){return a.name})}))]))};return c}(b("React").Component);c.propTypes={onTokenClick:a.func.isRequired,people:a.array.isRequired};e.exports=c}),null);
__d("MTokenizerParagraphWithMultiplePeopleAtPlace.react",["fbt","MTokenizerParagraphRoot.react","MTokenizerParagraphToken.react","MTokenizerParagraphTokenList.react","MUnifiedTaggerConstants","React"],(function(a,b,c,d,e,f,g){__p&&__p();var h=b("MUnifiedTaggerConstants").TOKEN_TYPES;a=b("React").PropTypes;c=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){__p&&__p();var c,d;for(var e=arguments.length,f=new Array(e),i=0;i<e;i++)f[i]=arguments[i];return(c=d=a.call.apply(a,[this].concat(f))||this,d.getPeopleNames=function(){return d.props.people.map(function(a){return a.name})},d.renderNonSpecificPlace=function(){return b("React").createElement(b("MTokenizerParagraphRoot.react"),null,g._("with {list-of-people} in {non-specific-place-name}.",[g._param("list-of-people",d.renderPeopleToken()),g._param("non-specific-place-name",d.renderPlaceToken())]))},d.renderPeopleToken=function(){return b("React").createElement(b("MTokenizerParagraphTokenList.react"),{onClick:d.props.onTokenClick.bind(null,h.PEOPLE),names:d.getPeopleNames()})},d.renderPlaceToken=function(){return b("React").createElement(b("MTokenizerParagraphToken.react"),{onClick:d.props.onTokenClick.bind(null,h.PLACE)},d.props.place.name)},d.renderSpecificPlace=function(){return b("React").createElement(b("MTokenizerParagraphRoot.react"),null,g._("with {list-of-people} at {place-name}.",[g._param("list-of-people",d.renderPeopleToken()),g._param("place-name",d.renderPlaceToken())]))},c)||babelHelpers.assertThisInitialized(d)}var d=c.prototype;d.render=function(){return this.props.place.isNonSpecific?this.renderNonSpecificPlace():this.renderSpecificPlace()};return c}(b("React").Component);c.propTypes={onTokenClick:a.func.isRequired,place:a.object.isRequired,people:a.array.isRequired};e.exports=c}),null);
__d("MTokenizerParagraphIcon.react",["cx","Image.react","MTokenizerParagraphToken.react","React"],(function(a,b,c,d,e,f,g){__p&&__p();a=b("React").PropTypes;c=function(a){"use strict";babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.render=function(){return b("React").createElement(b("MTokenizerParagraphToken.react"),this.props,b("React").createElement(b("Image.react"),{className:"_2r5v",src:this.props.src}))};return c}(b("React").Component);c.propTypes={use:a.oneOf(["token","noborder"])};c.defaultProps={use:"noborder"};e.exports=c}),null);
__d("MTokenizerParagraphWithOGActivity.react",["cx","ix","MTaggableActivityPreviewTemplateQuery","MTokenizerParagraphIcon.react","MTokenizerParagraphRoot.react","MTokenizerParagraphToken.react","MTokenizerParagraphTokenList.react","MUnifiedTaggerConstants","React"],(function(a,b,c,d,e,f,g,h){__p&&__p();var i=b("MUnifiedTaggerConstants").TOKEN_TYPES;a=b("React").PropTypes;c=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){__p&&__p();var c,d;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(c=d=a.call.apply(a,[this].concat(f))||this,d.state={template:null},d.getTemplateQuery=function(a){var c=new(b("MTaggableActivityPreviewTemplateQuery"))(a.ogactivity.id);a.people.length===1?c.setHasPerson():a.people.length>1&&c.setHasPeople();a.place&&c.setHasPlace();return c},d.shouldRenderLoader=function(){return!(d.state.template&&d.props.ogactivity.icon)},d.renderLoading=function(){return b("React").createElement(b("MTokenizerParagraphIcon.react"),{className:"_12zh",src:h("85428")})},d.renderTemplate=function(a){return d.state.template.renderArray(d.state.template.getTokens().map(d.renderToken))},d.renderToken=function(a){a=a.token;var c=d.props.onTokenClick.bind(null,a===i.PERSON?i.PEOPLE:a);switch(a){case i.ICON:return[b("React").createElement(b("MTokenizerParagraphIcon.react"),{onClick:c,src:d.props.ogactivity.icon,use:"token"})," "];case i.OBJECT:return b("React").createElement(b("MTokenizerParagraphToken.react"),{onClick:c,key:a},d.props.ogactivity.object);case i.PEOPLE:return b("React").createElement(b("MTokenizerParagraphTokenList.react"),{onClick:c,names:d.props.people.map(function(a){return a.name}),key:a});case i.PERSON:return b("React").createElement(b("MTokenizerParagraphToken.react"),{onClick:c,key:a},d.props.people[0].name);case i.PLACE:return b("React").createElement(b("MTokenizerParagraphToken.react"),{onClick:c,key:a},d.props.place.name)}},c)||babelHelpers.assertThisInitialized(d)}var d=c.prototype;d.componentDidMount=function(){this.$1=!0,this.startTemplateQuery(this.props)};d.componentWillUnnount=function(){this.$1=!1};d.UNSAFE_componentWillReceiveProps=function(a){this.setState({template:null}),this.startTemplateQuery(a)};d.startTemplateQuery=function(a){var b=this;this.getTemplateQuery(a).fetch().done(function(a){b.$1&&b.setState({template:a})})};d.render=function(){var a=this.shouldRenderLoader()?this.renderLoading():this.renderTemplate();return b("React").createElement(b("MTokenizerParagraphRoot.react"),null,a)};return c}(b("React").Component);c.propTypes={ogactivity:a.object.isRequired,onTokenClick:a.func.isRequired,people:a.array,place:a.object};e.exports=c}),null);
__d("MTokenizerParagraphWithPerson.react",["fbt","MTokenizerParagraphRoot.react","MTokenizerParagraphToken.react","MUnifiedTaggerConstants","React"],(function(a,b,c,d,e,f,g){__p&&__p();var h=b("MUnifiedTaggerConstants").TOKEN_TYPES;a=b("React").PropTypes;c=function(a){"use strict";babelHelpers.inheritsLoose(c,a);function c(){return a.apply(this,arguments)||this}var d=c.prototype;d.render=function(){return b("React").createElement(b("MTokenizerParagraphRoot.react"),null,g._("with {name1}.",[g._param("name1",b("React").createElement(b("MTokenizerParagraphToken.react"),{onClick:this.props.onTokenClick.bind(null,h.PEOPLE)},this.props.person.name))]))};return c}(b("React").Component);c.propTypes={onTokenClick:a.func.isRequired,person:a.object.isRequired};e.exports=c}),null);
__d("MTokenizerParagraphWithPersonAtPlace.react",["fbt","MTokenizerParagraphRoot.react","MTokenizerParagraphToken.react","MUnifiedTaggerConstants","React"],(function(a,b,c,d,e,f,g){__p&&__p();var h=b("MUnifiedTaggerConstants").TOKEN_TYPES;a=b("React").PropTypes;c=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){var c,d;for(var e=arguments.length,f=new Array(e),i=0;i<e;i++)f[i]=arguments[i];return(c=d=a.call.apply(a,[this].concat(f))||this,d.renderNonSpecificPlace=function(){return b("React").createElement(b("MTokenizerParagraphRoot.react"),null,g._("with {name1} in {city-name}.",[g._param("name1",d.renderPersonToken()),g._param("city-name",d.renderPlaceToken())]))},d.renderPersonToken=function(){return b("React").createElement(b("MTokenizerParagraphToken.react"),{onClick:d.props.onTokenClick.bind(null,h.PEOPLE)},d.props.person.name)},d.renderPlaceToken=function(){return b("React").createElement(b("MTokenizerParagraphToken.react"),{onClick:d.props.onTokenClick.bind(null,h.PLACE)},d.props.place.name)},d.renderSpecificPlace=function(){return b("React").createElement(b("MTokenizerParagraphRoot.react"),null,g._("with {name1} at {place-name}.",[g._param("name1",d.renderPersonToken()),g._param("place-name",d.renderPlaceToken())]))},c)||babelHelpers.assertThisInitialized(d)}var d=c.prototype;d.render=function(){return this.props.place.isNonSpecific?this.renderNonSpecificPlace():this.renderSpecificPlace()};return c}(b("React").Component);c.propTypes={onTokenClick:a.func.isRequired,place:a.object.isRequired,person:a.object.isRequired};e.exports=c}),null);
__d("MTokenizerParagraph.react",["MTokenizerParagraphAtPlace.react","MTokenizerParagraphWithMultiplePeople.react","MTokenizerParagraphWithMultiplePeopleAtPlace.react","MTokenizerParagraphWithOGActivity.react","MTokenizerParagraphWithPerson.react","MTokenizerParagraphWithPersonAtPlace.react","React"],(function(a,b,c,d,e,f){__p&&__p();a=b("React").PropTypes;c=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(){__p&&__p();var c,d;for(var e=arguments.length,f=new Array(e),g=0;g<e;g++)f[g]=arguments[g];return(c=d=a.call.apply(a,[this].concat(f))||this,d.renderTokens=function(){__p&&__p();var a=d.props.ogactivity,c=d.props.people||[],e=d.props.place;if(a)return b("React").createElement(b("MTokenizerParagraphWithOGActivity.react"),babelHelpers["extends"]({},d.props,{ogactivity:a,people:c,place:e}));if(c.length>1&&e)return b("React").createElement(b("MTokenizerParagraphWithMultiplePeopleAtPlace.react"),babelHelpers["extends"]({},d.props,{place:e,people:c}));if(c.length===1&&e)return b("React").createElement(b("MTokenizerParagraphWithPersonAtPlace.react"),babelHelpers["extends"]({},d.props,{place:e,person:c[0]}));if(e)return b("React").createElement(b("MTokenizerParagraphAtPlace.react"),babelHelpers["extends"]({},d.props,{place:e}));if(c.length>1)return b("React").createElement(b("MTokenizerParagraphWithMultiplePeople.react"),babelHelpers["extends"]({},d.props,{people:c}));return c.length===1?b("React").createElement(b("MTokenizerParagraphWithPerson.react"),babelHelpers["extends"]({},d.props,{person:c[0]})):b("React").createElement("div",d.props)},c)||babelHelpers.assertThisInitialized(d)}var d=c.prototype;d.render=function(){return this.renderTokens()};return c}(b("React").Component);c.propTypes={ogactivity:a.object,onTokenClick:a.func,people:a.array,place:a.object};c.defaultProps={ogactivity:null,people:[],place:null};e.exports=c}),null);
__d("MStructuredComposerUnifiedTagger",["MCompositionPlaceFields","MCompositionPlaceStore","MSubscriptionsHandlerMixin","MTokenizerParagraph.react","React","ReactDOM","Stratcom","mixin"],(function(a,b,c,d,e,f){__p&&__p();a=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(c){__p&&__p();var d;d=a.call(this)||this;d.$MStructuredComposerUnifiedTagger1={ogActivity:null,people:null,place:null};d.$MStructuredComposerUnifiedTagger2=c;d.addSubscriptions(b("MCompositionPlaceStore").addListener("change",function(){b("MCompositionPlaceStore").isEmpty()?d.setAttachments({place:null}):d.setAttachments({place:{name:b("MCompositionPlaceStore").get(b("MCompositionPlaceFields").NAME),isNonSpecific:b("MCompositionPlaceStore").get(b("MCompositionPlaceFields").IS_NON_SPECIFIC,!1)}})}),b("Stratcom").listen("MComposer:tagger:update",null,function(a){return d.setAttachments(a.getData())}),b("Stratcom").listen("MComposer:tagger:update:og-icon",null,function(a){return d.setOGIcon(a.getData().icon)}),b("Stratcom").listen("MComposer:tagger:clear",null,function(){return d.clear()}));d.$MStructuredComposerUnifiedTagger3();return d}var d=c.prototype;d.clear=function(){this.$MStructuredComposerUnifiedTagger1.ogActivity=null;this.$MStructuredComposerUnifiedTagger1.people=null;this.$MStructuredComposerUnifiedTagger1.place=null;return this.$MStructuredComposerUnifiedTagger3()};d.$MStructuredComposerUnifiedTagger4=function(a){b("Stratcom").invoke("MComposer:tagger:click",a)};d.$MStructuredComposerUnifiedTagger5=function(){return!!(this.$MStructuredComposerUnifiedTagger1.ogActivity||this.$MStructuredComposerUnifiedTagger1.people&&this.$MStructuredComposerUnifiedTagger1.people.length||this.$MStructuredComposerUnifiedTagger1.place)};d.$MStructuredComposerUnifiedTagger3=function(){var a=this;this.$MStructuredComposerUnifiedTagger5()?b("ReactDOM").render(b("React").createElement(b("MTokenizerParagraph.react"),{ogactivity:this.$MStructuredComposerUnifiedTagger1.ogActivity,onTokenClick:function(b){return a.$MStructuredComposerUnifiedTagger4(b)},people:this.$MStructuredComposerUnifiedTagger1.people,place:this.$MStructuredComposerUnifiedTagger1.place}),this.$MStructuredComposerUnifiedTagger2):b("ReactDOM").unmountComponentAtNode(this.$MStructuredComposerUnifiedTagger2);return this};d.setAttachments=function(a){Object.assign(this.$MStructuredComposerUnifiedTagger1,a);return this.$MStructuredComposerUnifiedTagger3()};d.setOGIcon=function(a){this.$MStructuredComposerUnifiedTagger1.ogActivity&&(this.$MStructuredComposerUnifiedTagger1.ogActivity.icon=a);return this.$MStructuredComposerUnifiedTagger3()};return c}(b("mixin")(b("MSubscriptionsHandlerMixin")));e.exports=a}),null);
__d("MComposerLegacyPlaceAttachment",["CSS","DOM","MComposerLogger","MCompositionConfigStore","MCompositionPlaceStore","MCompositionUserActions","MSubscriptionsHandlerMixin","MUnifiedTaggerConstants","Stratcom","memoize","mixin"],(function(a,b,c,d,e,f){__p&&__p();var g=b("MUnifiedTaggerConstants").SHOW_UNIFIED_TAGGER;a=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(c){__p&&__p();var d;d=a.call(this)||this;d.$MComposerLegacyPlaceAttachment1=c;d.$MComposerLegacyPlaceAttachment2=b("memoize")(function(){return b("DOM").find(d.$MComposerLegacyPlaceAttachment1,"li","token")});d.$MComposerLegacyPlaceAttachment3=b("memoize")(function(){return b("DOM").find(d.$MComposerLegacyPlaceAttachment2(),"a","remove-token")});d.addSubscriptions(b("MCompositionPlaceStore").addListener("change",function(){return d.$MComposerLegacyPlaceAttachment4()}),b("DOM").listen(d.$MComposerLegacyPlaceAttachment1,"click","remove-token",function(a){return d.$MComposerLegacyPlaceAttachment5(a)}),b("DOM").listen(d.$MComposerLegacyPlaceAttachment1,"click","at-button",function(){return d.$MComposerLegacyPlaceAttachment6()}));return d}var d=c.prototype;d.$MComposerLegacyPlaceAttachment7=function(){return!b("MCompositionConfigStore").get("pinplace",!1)};d.$MComposerLegacyPlaceAttachment8=function(){return!b("MCompositionPlaceStore").isEmpty()&&!b("MCompositionConfigStore").get("disable_place_tag",!1)};d.$MComposerLegacyPlaceAttachment6=function(){b("Stratcom").invoke("MStructuredComposer-addLocationClicked")};d.$MComposerLegacyPlaceAttachment4=function(){if(g)return;b("CSS").conditionShow(this.$MComposerLegacyPlaceAttachment1,this.$MComposerLegacyPlaceAttachment8());b("CSS").conditionShow(this.$MComposerLegacyPlaceAttachment3(),this.$MComposerLegacyPlaceAttachment7());this.$MComposerLegacyPlaceAttachment8()&&b("DOM").replace(this.$MComposerLegacyPlaceAttachment2().firstChild,b("DOM").create("span",{className:"innerToken"},b("MCompositionPlaceStore").get("name")))};d.$MComposerLegacyPlaceAttachment5=function(a){a.kill(),b("Stratcom").invoke("MStructuredComposer-removedLocation"),b("MComposerLogger").log("remove_location"),b("MCompositionUserActions").placeRemove()};return c}(b("mixin")(b("MSubscriptionsHandlerMixin")));e.exports=a}),null);
__d("MComposerStatusTextarea",["DOM","MCompositionConfigStore","MCompositionPageRecommendationsStore","MCompositionStatusStore","MCompositionUserActions","MJSEnvironment","MSubscriptionsHandlerMixin","MViewport","Scroll","Stratcom","Style","debounceCore","mixin"],(function(a,b,c,d,e,f){__p&&__p();var g=480,h=b("MJSEnvironment").IS_ANDROID||b("MJSEnvironment").IS_APPLE_WEBKIT_IOS||b("MJSEnvironment").IS_CHROME||b("MJSEnvironment").IS_FIREFOX&&b("MJSEnvironment").OS_VERSION>14;function i(a){var c=b("debounceCore")(a,300);return function(){c.reset();for(var a=arguments.length,b=new Array(a),d=0;d<a;d++)b[d]=arguments[d];c.apply(null,b)}}a=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(c){__p&&__p();var d;c=c.textareaNode;d=a.call(this)||this;d.$MComposerStatusTextarea1=c;c.tagName!=="TEXTAREA"?d.$MComposerStatusTextarea2=b("DOM").find(c,"textarea"):d.$MComposerStatusTextarea2=c;b("MJSEnvironment").IS_APPLE_WEBKIT_IOS&&!b("MJSEnvironment").IS_CHROME&&b("MJSEnvironment").OS_VERSION>=7&&b("MViewport").getScreenHeight()<=g&&b("Style").set(d.$MComposerStatusTextarea2,"height","75px");d.addSubscriptions(b("MCompositionStatusStore").addChangeListener(function(){return d.$MComposerStatusTextarea3()}),b("MCompositionConfigStore").addChangeListener(function(){return d.$MComposerStatusTextarea4()}),b("DOM").listen(d.$MComposerStatusTextarea2,h?"input":"keyup",null,i(function(a){return d.$MComposerStatusTextarea5(a)})),b("Stratcom").listen("MMentions:change",null,function(a){return d.$MComposerStatusTextarea6(a)}),b("Stratcom").listen("MComposerStatusTextarea:flush",null,function(a){return d.$MComposerStatusTextarea7(a)}));return d}var d=c.prototype;d.$MComposerStatusTextarea6=function(a){a=a.getData().input;if(a!==this.$MComposerStatusTextarea2)return;this.$MComposerStatusTextarea8(a.value)};d.$MComposerStatusTextarea3=function(){var a=b("MCompositionStatusStore").get("TEXT","");this.$MComposerStatusTextarea2.value=a;b("Stratcom").invoke("MJSPlaceholder")};d.$MComposerStatusTextarea4=function(){var a=b("MCompositionConfigStore").get("inputname"),c=this.$MComposerStatusTextarea9();c.getAttribute("name")!==a&&c.setAttribute("name",a)};d.$MComposerStatusTextarea9=function(){var a=b("DOM").scry(this.$MComposerStatusTextarea1,"input","mentionsHiddenInput")[0];return a||this.$MComposerStatusTextarea2};d.$MComposerStatusTextarea5=function(a){this.$MComposerStatusTextarea8(a.getTarget().value)};d.$MComposerStatusTextarea7=function(a){a=a.getData();this.$MComposerStatusTextarea8(a.value);if(a.hasMentions===!1){var b=this.$MComposerStatusTextarea9();b!==this.$MComposerStatusTextarea2&&(b.value=a.value)}};d.$MComposerStatusTextarea8=function(a){var c=this.$MComposerStatusTextarea2.selectionStart,d=this.$MComposerStatusTextarea2.selectionEnd,e=b("Scroll").getTop(this.$MComposerStatusTextarea2),f={};f.TEXT=a;b("MCompositionUserActions").statusUpdate(f);b("Scroll").setTop(this.$MComposerStatusTextarea2,e);this.$MComposerStatusTextarea2.setSelectionRange(c,d)};return c}(b("mixin")(b("MSubscriptionsHandlerMixin")));e.exports=a}),null);
__d("MComposerPlaceButton",["CSS","MCompositionConfigStore","MCompositionPlaceStore","MSubscriptionsHandlerMixin","mixin"],(function(a,b,c,d,e,f){__p&&__p();a=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(c){var d;d=a.call(this)||this;d.$MComposerPlaceButton1=c;d.addSubscriptions(b("MCompositionConfigStore").addListener("change",function(){return d.$MComposerPlaceButton2()}),b("MCompositionPlaceStore").addListener("change",function(){return d.$MComposerPlaceButton3()}));return d}var d=c.prototype;d.$MComposerPlaceButton4=function(){return!b("MCompositionPlaceStore").isEmpty()};d.$MComposerPlaceButton5=function(){return!b("MCompositionConfigStore").get("pinplace")&&!b("MCompositionConfigStore").get("disable_place_tag")};d.$MComposerPlaceButton2=function(){b("CSS").conditionShow(this.$MComposerPlaceButton1,this.$MComposerPlaceButton5())};d.$MComposerPlaceButton3=function(){b("CSS").conditionClass(this.$MComposerPlaceButton1,"active",this.$MComposerPlaceButton4())};return c}(b("mixin")(b("MSubscriptionsHandlerMixin")));e.exports=a}),null);
__d("MComposerPlaceDialog",["fbt","DOM","MComposerLogger","MComposerNavigationMixin","MCompositionConfigStore","MCompositionPlaceFields","MCompositionPlaceStore","MCompositionUserActions","MPlacesTagger","MRequest","MSubscriptionsHandlerMixin","MUnifiedTaggerConstants","Stratcom","getObjectValues","mixin","whitelistObjectKeys"],(function(a,b,c,d,e,f,g){__p&&__p();a=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(c,d){__p&&__p();var e,f=d.preview;d=d.tagger;e=a.call(this)||this;e.$MComposerPlaceDialog1=f;e.$MComposerPlaceDialog2=c;e.$MComposerPlaceDialog3=d||new(b("MPlacesTagger"))(e.$MComposerPlaceDialog2);e.$MComposerPlaceDialog4=!0;e.addSubscriptions(e.$MComposerPlaceDialog1.addListener("clear",function(){return e.$MComposerPlaceDialog5()}),e.$MComposerPlaceDialog3.listen("cancel",function(){return e.$MComposerPlaceDialog6()}),e.$MComposerPlaceDialog3.listen("submit",function(a){return e.$MComposerPlaceDialog7(a)}),b("MCompositionPlaceStore").addListener("change",function(){return e.$MComposerPlaceDialog8()}),b("Stratcom").listen("click","at-button",function(){return e.$MComposerPlaceDialog9()}),b("Stratcom").listen("open","MComposer:dialog:place",function(){e.$MComposerPlaceDialog4=!1,e.$MComposerPlaceDialog9()}),b("Stratcom").listen("back","MComposer:dialog:place",function(){return e.$MComposerPlaceDialog10()}),b("Stratcom").listen("MComposer:tagger:click",b("MUnifiedTaggerConstants").TOKEN_TYPES.PLACE,function(){return e.$MComposerPlaceDialog9()}));return e}var d=c.prototype;d.$MComposerPlaceDialog11=function(){b("MCompositionUserActions").placeRemove(),this.$MComposerPlaceDialog10()};d.$MComposerPlaceDialog10=function(){this.$MComposerPlaceDialog3.hide(),this.$MComposerPlaceDialog4||(this.$MComposerPlaceDialog4=!0,b("Stratcom").invoke("close","MComposer:dialog:place"))};d.$MComposerPlaceDialog12=function(){return!b("MCompositionConfigStore").get("pinplace")&&!b("MCompositionConfigStore").get("disable_place_tag")};d.$MComposerPlaceDialog13=function(){return b("MCompositionPlaceStore").get("isNonSpecific")};d.$MComposerPlaceDialog8=function(){b("MCompositionPlaceStore").isEmpty()?this.$MComposerPlaceDialog1.clear():this.$MComposerPlaceDialog1.setValue(this.$MComposerPlaceDialog14())};d.$MComposerPlaceDialog9=function(){__p&&__p();var a=this;if(this.hasNavigationPolicy())return;if(!this.$MComposerPlaceDialog12()){this.$MComposerPlaceDialog4=!0;return}setTimeout(function(){b("MComposerLogger").log("intent_location"),a.$MComposerPlaceDialog4?a.newNavigationPolicy().addOnOpen(function(){return a.$MComposerPlaceDialog15()}).addOnClose(function(){return a.$MComposerPlaceDialog10()}).open():a.$MComposerPlaceDialog15()},10)};d.$MComposerPlaceDialog6=function(){if(this.$MComposerPlaceDialog4&&!this.hasNavigationPolicy())return;b("MComposerLogger").log("cancel_location");this.$MComposerPlaceDialog4?this.currentNavigationPolicy().close():(this.$MComposerPlaceDialog4=!0,b("Stratcom").invoke("cancel","MComposer:dialog:place"),this.$MComposerPlaceDialog3.hide())};d.$MComposerPlaceDialog5=function(){var a=this;if(this.$MComposerPlaceDialog4&&!this.hasNavigationPolicy())return;b("MComposerLogger").log("cancel_location");this.$MComposerPlaceDialog4?this.currentNavigationPolicy().addOnClose(function(){return a.$MComposerPlaceDialog11()}).close():this.$MComposerPlaceDialog10()};d.$MComposerPlaceDialog7=function(a){var c=this;if(this.$MComposerPlaceDialog4&&!this.hasNavigationPolicy())return;b("MComposerLogger").log("add_location");this.$MComposerPlaceDialog4?this.currentNavigationPolicy().addOnClose(function(){return c.$MComposerPlaceDialog16(a)}).close():(this.$MComposerPlaceDialog10(),this.$MComposerPlaceDialog16(a))};d.$MComposerPlaceDialog15=function(){this.$MComposerPlaceDialog3.show();var a=b("DOM").scry(this.$MComposerPlaceDialog2,"*","places-category-selector-container")[0];a&&a.id&&a.children.length===0&&new(b("MRequest"))("/places/addform/category.php").addData({target_id:a.id,parent_id:0}).setMethod("GET").send()};d.$MComposerPlaceDialog14=function(){if(b("MCompositionPlaceStore").get("isNonSpecific"))return g._("in {non-specific-place-name}.",[g._param("non-specific-place-name",b("MCompositionPlaceStore").get("name"))]);else return g._("at {place-name}",[g._param("place-name",b("MCompositionPlaceStore").get("name"))])};d.$MComposerPlaceDialog16=function(a){b("MCompositionUserActions").placeSet(b("whitelistObjectKeys")(a,b("getObjectValues")(b("MCompositionPlaceFields"))))};return c}(b("mixin")(b("MComposerNavigationMixin"),b("MSubscriptionsHandlerMixin")));e.exports=a}),null);
__d("MComposerInputsWrapper",["DOM","MComposerStoreToInputMap","MCompositionDispatcher","MCompositionStore","destroyOnUnload"],(function(a,b,c,d,e,f){__p&&__p();function g(a){return Object.prototype.hasOwnProperty.call(b("MComposerStoreToInputMap"),a.getID())}function h(a,b){return a+"-"+b}a=function(){"use strict";__p&&__p();function a(a){var c=this;this.$1={};this.$2=a;this.$3=b("MCompositionDispatcher").register(function(){return c.$4()});b("destroyOnUnload")(function(){return b("MCompositionDispatcher").unregister(c.$3)})}var c=a.prototype;c.$5=function(){return b("MCompositionStore").getRegisteredStores().filter(g)};c.$4=function(){var a=this,c=this.$5();b("MCompositionDispatcher").waitFor(c.map(function(a){return a.toUpdate()}));c.forEach(function(b){return a.$6(b)})};c.$6=function(a){var c=this,d=a.getID(),e=b("MComposerStoreToInputMap")[d];Object.keys(e).forEach(function(b){c.$7(d,e[b],a.get(b,""))})};c.$7=function(a,c,d){a=h(a,c);Object.prototype.hasOwnProperty.call(this.$1,a)||(this.$1[a]=b("DOM").create("input",{name:c,type:"hidden"}),b("DOM").appendContent(this.$2,this.$1[a]));this.$1[a].value=d};return a}();e.exports=a}),null);
__d("MComposerLegacyPlaceInput",["DOM","MCompositionPlaceStore","MSubscriptionsHandlerMixin","mixin"],(function(a,b,c,d,e,f){__p&&__p();a=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(c){__p&&__p();var d;d=a.call(this)||this;d.$MComposerLegacyPlaceInput1=c;d.$MComposerLegacyPlaceInput2=b("DOM").find(d.$MComposerLegacyPlaceInput1,"input","at-input");d.$MComposerLegacyPlaceInput3=b("DOM").find(d.$MComposerLegacyPlaceInput1,"input","new-place-cat-input");d.$MComposerLegacyPlaceInput4=b("DOM").find(d.$MComposerLegacyPlaceInput1,"input","new-place-is-current");d.$MComposerLegacyPlaceInput5=b("DOM").find(d.$MComposerLegacyPlaceInput1,"input","new-place-name-input");d.$MComposerLegacyPlaceInput6=b("DOM").find(d.$MComposerLegacyPlaceInput1,"input","new-place-phone-input");d.$MComposerLegacyPlaceInput7=b("DOM").find(d.$MComposerLegacyPlaceInput1,"input","new-place-website-input");d.$MComposerLegacyPlaceInput8=b("DOM").find(d.$MComposerLegacyPlaceInput1,"input","new-place-address-input");d.$MComposerLegacyPlaceInput9=b("DOM").find(d.$MComposerLegacyPlaceInput1,"input","new-place-zip-input");d.$MComposerLegacyPlaceInput10=b("DOM").find(d.$MComposerLegacyPlaceInput1,"input","new-place-freeform");d.$MComposerLegacyPlaceInput11=b("DOM").find(d.$MComposerLegacyPlaceInput1,"input","json-location");d.$MComposerLegacyPlaceInput12=b("DOM").find(d.$MComposerLegacyPlaceInput1,"input","is-checkin");d.addSubscriptions(b("MCompositionPlaceStore").addListener("change",d.$MComposerLegacyPlaceInput13.bind(babelHelpers.assertThisInitialized(d))));return d}var d=c.prototype;d.$MComposerLegacyPlaceInput14=function(){this.$MComposerLegacyPlaceInput2.value="",this.$MComposerLegacyPlaceInput5.value="",this.$MComposerLegacyPlaceInput6.value="",this.$MComposerLegacyPlaceInput7.value="",this.$MComposerLegacyPlaceInput8.value="",this.$MComposerLegacyPlaceInput9.value="",b("DOM").setContent(this.$MComposerLegacyPlaceInput3,null),this.$MComposerLegacyPlaceInput10.value="",this.$MComposerLegacyPlaceInput4.value="",this.$MComposerLegacyPlaceInput11.value="{}",this.$MComposerLegacyPlaceInput12.value=""};d.$MComposerLegacyPlaceInput13=function(){b("MCompositionPlaceStore").isEmpty()?this.$MComposerLegacyPlaceInput14():this.$MComposerLegacyPlaceInput15()};d.$MComposerLegacyPlaceInput15=function(){__p&&__p();this.$MComposerLegacyPlaceInput14();this.$MComposerLegacyPlaceInput12.value=!0;b("MCompositionPlaceStore").get("id",!1)?this.$MComposerLegacyPlaceInput2.value=b("MCompositionPlaceStore").get("id"):this.$MComposerLegacyPlaceInput10.value=b("MCompositionPlaceStore").get("name","");this.$MComposerLegacyPlaceInput11.value=b("MCompositionPlaceStore").get("JSON_LOCATION","{}");if(b("MCompositionPlaceStore").get("new_place")){var a;this.$MComposerLegacyPlaceInput5.value=(a=b("MCompositionPlaceStore")).get("name","");this.$MComposerLegacyPlaceInput6.value=a.get("phone","");this.$MComposerLegacyPlaceInput7.value=a.get("website","");this.$MComposerLegacyPlaceInput8.value=a.get("address","");this.$MComposerLegacyPlaceInput9.value=a.get("zip","");this.$MComposerLegacyPlaceInput10.value="";this.$MComposerLegacyPlaceInput4.value=a.get("is_current","");a=a.get("topic_tokens");a.value?this.$MComposerLegacyPlaceInput3.value=a.value:b("DOM").setContent(this.$MComposerLegacyPlaceInput3,a.map(function(a){return a.cloneNode(!0)}))}};return c}(b("mixin")(b("MSubscriptionsHandlerMixin")));e.exports=a}),null);
__d("MPagesStarsRatableBase",["CSS","DOM","MLegacyDataStore","Stratcom"],(function(a,b,c,d,e,f){__p&&__p();a=function(){"use strict";__p&&__p();function a(a,c,d){__p&&__p();this.root=a;this.stars=b("DOM").scry(a,"span","stars-ratable-star");this.hiddenInput=b("DOM").find(a,"input","stars-ratable-input");this.ratingTextContainer=d;this.listeners=[b("DOM").listen(this.root,"click","star-link",this._onClick.bind(this)),b("Stratcom").listen("MPagesStarsRatableBase-setStars",null,function(a){this.setRating(a.getData().rating)}.bind(this))];this.setRating(c);var e=this.listeners;b("Stratcom").listen("m:page:unload",null,function(){b("Stratcom").removeCurrentListener(),e.forEach(function(a){a.remove()})})}var c=a.prototype;c._onClick=function(a){var c=this._getStarIndexFromEvent(a);c&&(this.setRating(c),b("Stratcom").invoke("MPagesStarsRatableBase-starTapped",null,{rating:c}));a.prevent()};c._getStarIndexFromEvent=function(a){a=a.getTarget();a.nodeName==="A"&&(a=b("DOM").find(a,"span","stars-ratable-star"));return this.stars.indexOf(a)+1};c.setRating=function(a){for(var c=0;c<this.stars.length;++c){var d=c>=a;b("CSS").conditionClass(this.stars[c],"fullStar",!d);b("CSS").conditionClass(this.stars[c],"emptyStar",d)}this.hiddenInput.value=a;a&&(this.ratingTextContainer&&(this.ratingTextContainer.textContent=b("MLegacyDataStore").get(this.stars[a-1]).tooltip));b("Stratcom").invoke("MPagesStarsRatableBase-starsSet",null,{rating:a})};a.init=function(b,c,d){new a(b,c,d)};return a}();e.exports=a}),null);
__d("XSharePreviewAsyncController",["XController"],(function(a,b,c,d,e,f){e.exports=b("XController").create("/share_preview/",{sid:{type:"String"},surl:{type:"String"},existing_post_id:{type:"Int"}})}),null);
__d("MSharePreview",["CSS","DOM","MCompositionConfigStore","MCompositionShareStore","MCompositionUserActions","MRequest","MSubscriptionsHandlerMixin","XSharePreviewAsyncController","$","mixin"],(function(a,b,c,d,e,f){__p&&__p();a=function(a){"use strict";__p&&__p();babelHelpers.inheritsLoose(c,a);function c(c){var d;d=a.call(this)||this;d.$MSharePreview1=b("DOM").scry(c,"div")[0];d.addSubscriptions(b("MCompositionShareStore").addListener("change",function(){return d.$MSharePreview2()}),b("DOM").listen(c,"click","close-link-preview-button",function(a){b("MCompositionUserActions").shareRemoveLinkPreview(b("MCompositionShareStore").get("SHARE_URI")),b("MCompositionUserActions").configDisablePhotosUpdate(!1)}));return d}var d=c.prototype;d.init=function(){var a=this,c=b("MCompositionConfigStore").get("postid",null);if(!c)return;b("MCompositionUserActions").configDisablePhotosUpdate(!0);c=b("XSharePreviewAsyncController").getURIBuilder().setInt("existing_post_id",c).getURI();this.$MSharePreview3=new(b("MRequest"))(c);this.$MSharePreview3.listen("finally",function(){b("CSS").hide(a.$MSharePreview1),a.$MSharePreview3=null});this.$MSharePreview3.send()};d.$MSharePreview2=function(){__p&&__p();var a=this;this.$MSharePreview3&&(this.$MSharePreview3.abort(),this.$MSharePreview3=null);if(b("MCompositionShareStore").isEmpty())b("DOM").setContent(b("$")("mshare_preview_placeholder"),null);else{var c=b("MCompositionShareStore").get("ID"),d=b("MCompositionShareStore").get("SHARE_URI");if(!c&&!d){b("DOM").setContent(b("$")("mshare_preview_placeholder"),null);b("CSS").hide(this.$MSharePreview1);return}b("CSS").show(this.$MSharePreview1);c=b("XSharePreviewAsyncController").getURIBuilder().setString("sid",c&&c.toString()).setString("surl",d).getURI();this.$MSharePreview3=new(b("MRequest"))(c);this.$MSharePreview3.listen("finally",function(){b("CSS").hide(a.$MSharePreview1),a.$MSharePreview3=null});this.$MSharePreview3.send()}};return c}(b("mixin")(b("MSubscriptionsHandlerMixin")));e.exports=a}),null);